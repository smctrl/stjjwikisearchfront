(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["vendor.aurelia-templating-resources~2fe83516"],{

/***/ "aurelia-templating-resources":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/aurelia-templating-resources/dist/native-modules/aurelia-templating-resources.js ***!
  \*******************************************************************************************************/
/*! exports provided: AbstractRepeater, ArrayRepeatStrategy, AttrBindingBehavior, BindingSignaler, Compose, DebounceBindingBehavior, Else, Focus, FromViewBindingBehavior, HTMLSanitizer, Hide, If, MapRepeatStrategy, NullRepeatStrategy, NumberRepeatStrategy, OneTimeBindingBehavior, OneWayBindingBehavior, Repeat, RepeatStrategyLocator, Replaceable, SanitizeHTMLValueConverter, SelfBindingBehavior, SetRepeatStrategy, Show, SignalBindingBehavior, ThrottleBindingBehavior, ToViewBindingBehavior, TwoWayBindingBehavior, UpdateTriggerBindingBehavior, With, configure, createFullOverrideContext, getItemsSourceExpression, isOneTime, unwrapExpression, updateOneTimeBinding, updateOverrideContext, viewsRequireLifecycle */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AbstractRepeater\", function() { return AbstractRepeater; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ArrayRepeatStrategy\", function() { return ArrayRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AttrBindingBehavior\", function() { return AttrBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BindingSignaler\", function() { return BindingSignaler; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Compose\", function() { return Compose; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DebounceBindingBehavior\", function() { return DebounceBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Else\", function() { return Else; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Focus\", function() { return Focus; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FromViewBindingBehavior\", function() { return FromViewBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"HTMLSanitizer\", function() { return HTMLSanitizer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Hide\", function() { return Hide; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"If\", function() { return If; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MapRepeatStrategy\", function() { return MapRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NullRepeatStrategy\", function() { return NullRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NumberRepeatStrategy\", function() { return NumberRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"OneTimeBindingBehavior\", function() { return OneTimeBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"OneWayBindingBehavior\", function() { return OneWayBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Repeat\", function() { return Repeat; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RepeatStrategyLocator\", function() { return RepeatStrategyLocator; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Replaceable\", function() { return Replaceable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SanitizeHTMLValueConverter\", function() { return SanitizeHTMLValueConverter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SelfBindingBehavior\", function() { return SelfBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SetRepeatStrategy\", function() { return SetRepeatStrategy; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Show\", function() { return Show; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SignalBindingBehavior\", function() { return SignalBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ThrottleBindingBehavior\", function() { return ThrottleBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ToViewBindingBehavior\", function() { return ToViewBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TwoWayBindingBehavior\", function() { return TwoWayBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"UpdateTriggerBindingBehavior\", function() { return UpdateTriggerBindingBehavior; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"With\", function() { return With; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"configure\", function() { return configure$1; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"createFullOverrideContext\", function() { return createFullOverrideContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"getItemsSourceExpression\", function() { return getItemsSourceExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isOneTime\", function() { return isOneTime; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"unwrapExpression\", function() { return unwrapExpression; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateOneTimeBinding\", function() { return updateOneTimeBinding; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"updateOverrideContext\", function() { return updateOverrideContext; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"viewsRequireLifecycle\", function() { return viewsRequireLifecycle; });\n/* harmony import */ var aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! aurelia-dependency-injection */ \"3U8n\");\n/* harmony import */ var aurelia_pal__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aurelia-pal */ \"70NS\");\n/* harmony import */ var aurelia_task_queue__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! aurelia-task-queue */ \"K/SW\");\n/* harmony import */ var aurelia_templating__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! aurelia-templating */ \"hij8\");\n/* harmony import */ var aurelia_binding__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! aurelia-binding */ \"X5gX\");\n/* harmony import */ var aurelia_logging__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! aurelia-logging */ \"MP1E\");\n/* harmony import */ var aurelia_loader__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! aurelia-loader */ \"ZdUM\");\n/* harmony import */ var aurelia_path__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! aurelia-path */ \"iD3O\");\n/* harmony import */ var aurelia_metadata__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! aurelia-metadata */ \"qrcG\");\n\n\n\n\n\n\n\n\n\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nfunction __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\n\nvar ActivationStrategy;\r\n(function (ActivationStrategy) {\r\n    ActivationStrategy[\"InvokeLifecycle\"] = \"invoke-lifecycle\";\r\n    ActivationStrategy[\"Replace\"] = \"replace\";\r\n})(ActivationStrategy || (ActivationStrategy = {}));\r\nvar Compose = (function () {\r\n    function Compose(element, container, compositionEngine, viewSlot, viewResources, taskQueue) {\r\n        this.activationStrategy = ActivationStrategy.InvokeLifecycle;\r\n        this.element = element;\r\n        this.container = container;\r\n        this.compositionEngine = compositionEngine;\r\n        this.viewSlot = viewSlot;\r\n        this.viewResources = viewResources;\r\n        this.taskQueue = taskQueue;\r\n        this.currentController = null;\r\n        this.currentViewModel = null;\r\n        this.changes = Object.create(null);\r\n    }\r\n    Compose.inject = function () {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].Element, aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"Container\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"CompositionEngine\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewResources\"], aurelia_task_queue__WEBPACK_IMPORTED_MODULE_2__[\"TaskQueue\"]];\r\n    };\r\n    Compose.prototype.created = function (owningView) {\r\n        this.owningView = owningView;\r\n    };\r\n    Compose.prototype.bind = function (bindingContext, overrideContext) {\r\n        this.bindingContext = bindingContext;\r\n        this.overrideContext = overrideContext;\r\n        var changes = this.changes;\r\n        changes.view = this.view;\r\n        changes.viewModel = this.viewModel;\r\n        changes.model = this.model;\r\n        if (!this.pendingTask) {\r\n            processChanges(this);\r\n        }\r\n    };\r\n    Compose.prototype.unbind = function () {\r\n        this.changes = Object.create(null);\r\n        this.bindingContext = null;\r\n        this.overrideContext = null;\r\n        var returnToCache = true;\r\n        var skipAnimation = true;\r\n        this.viewSlot.removeAll(returnToCache, skipAnimation);\r\n    };\r\n    Compose.prototype.modelChanged = function (newValue, oldValue) {\r\n        this.changes.model = newValue;\r\n        requestUpdate(this);\r\n    };\r\n    Compose.prototype.viewChanged = function (newValue, oldValue) {\r\n        this.changes.view = newValue;\r\n        requestUpdate(this);\r\n    };\r\n    Compose.prototype.viewModelChanged = function (newValue, oldValue) {\r\n        this.changes.viewModel = newValue;\r\n        requestUpdate(this);\r\n    };\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], Compose.prototype, \"model\", void 0);\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], Compose.prototype, \"view\", void 0);\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], Compose.prototype, \"viewModel\", void 0);\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], Compose.prototype, \"activationStrategy\", void 0);\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], Compose.prototype, \"swapOrder\", void 0);\r\n    Compose = __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"noView\"],\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customElement\"])('compose')\r\n    ], Compose);\r\n    return Compose;\r\n}());\r\nfunction isEmpty(obj) {\r\n    for (var _ in obj) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\nfunction tryActivateViewModel(vm, model) {\r\n    if (vm && typeof vm.activate === 'function') {\r\n        return Promise.resolve(vm.activate(model));\r\n    }\r\n}\r\nfunction createInstruction(composer, instruction) {\r\n    return Object.assign(instruction, {\r\n        bindingContext: composer.bindingContext,\r\n        overrideContext: composer.overrideContext,\r\n        owningView: composer.owningView,\r\n        container: composer.container,\r\n        viewSlot: composer.viewSlot,\r\n        viewResources: composer.viewResources,\r\n        currentController: composer.currentController,\r\n        host: composer.element,\r\n        swapOrder: composer.swapOrder\r\n    });\r\n}\r\nfunction processChanges(composer) {\r\n    var changes = composer.changes;\r\n    composer.changes = Object.create(null);\r\n    if (needsReInitialization(composer, changes)) {\r\n        var instruction = {\r\n            view: composer.view,\r\n            viewModel: composer.currentViewModel || composer.viewModel,\r\n            model: composer.model\r\n        };\r\n        instruction = Object.assign(instruction, changes);\r\n        instruction = createInstruction(composer, instruction);\r\n        composer.pendingTask = composer.compositionEngine.compose(instruction).then(function (controller) {\r\n            composer.currentController = controller;\r\n            composer.currentViewModel = controller ? controller.viewModel : null;\r\n        });\r\n    }\r\n    else {\r\n        composer.pendingTask = tryActivateViewModel(composer.currentViewModel, changes.model);\r\n        if (!composer.pendingTask) {\r\n            return;\r\n        }\r\n    }\r\n    composer.pendingTask = composer.pendingTask\r\n        .then(function () {\r\n        completeCompositionTask(composer);\r\n    }, function (reason) {\r\n        completeCompositionTask(composer);\r\n        throw reason;\r\n    });\r\n}\r\nfunction completeCompositionTask(composer) {\r\n    composer.pendingTask = null;\r\n    if (!isEmpty(composer.changes)) {\r\n        processChanges(composer);\r\n    }\r\n}\r\nfunction requestUpdate(composer) {\r\n    if (composer.pendingTask || composer.updateRequested) {\r\n        return;\r\n    }\r\n    composer.updateRequested = true;\r\n    composer.taskQueue.queueMicroTask(function () {\r\n        composer.updateRequested = false;\r\n        processChanges(composer);\r\n    });\r\n}\r\nfunction needsReInitialization(composer, changes) {\r\n    var activationStrategy = composer.activationStrategy;\r\n    var vm = composer.currentViewModel;\r\n    if (vm && typeof vm.determineActivationStrategy === 'function') {\r\n        activationStrategy = vm.determineActivationStrategy();\r\n    }\r\n    return 'view' in changes\r\n        || 'viewModel' in changes\r\n        || activationStrategy === ActivationStrategy.Replace;\r\n}\n\nvar IfCore = (function () {\r\n    function IfCore(viewFactory, viewSlot) {\r\n        this.viewFactory = viewFactory;\r\n        this.viewSlot = viewSlot;\r\n        this.view = null;\r\n        this.bindingContext = null;\r\n        this.overrideContext = null;\r\n        this.showing = false;\r\n        this.cache = true;\r\n    }\r\n    IfCore.prototype.bind = function (bindingContext, overrideContext) {\r\n        this.bindingContext = bindingContext;\r\n        this.overrideContext = overrideContext;\r\n    };\r\n    IfCore.prototype.unbind = function () {\r\n        if (this.view === null) {\r\n            return;\r\n        }\r\n        this.view.unbind();\r\n        if (!this.viewFactory.isCaching) {\r\n            return;\r\n        }\r\n        if (this.showing) {\r\n            this.showing = false;\r\n            this.viewSlot.remove(this.view, true, true);\r\n        }\r\n        else {\r\n            this.view.returnToCache();\r\n        }\r\n        this.view = null;\r\n    };\r\n    IfCore.prototype._show = function () {\r\n        if (this.showing) {\r\n            if (!this.view.isBound) {\r\n                this.view.bind(this.bindingContext, this.overrideContext);\r\n            }\r\n            return;\r\n        }\r\n        if (this.view === null) {\r\n            this.view = this.viewFactory.create();\r\n        }\r\n        if (!this.view.isBound) {\r\n            this.view.bind(this.bindingContext, this.overrideContext);\r\n        }\r\n        this.showing = true;\r\n        return this.viewSlot.add(this.view);\r\n    };\r\n    IfCore.prototype._hide = function () {\r\n        var _this = this;\r\n        if (!this.showing) {\r\n            return;\r\n        }\r\n        this.showing = false;\r\n        var removed = this.viewSlot.remove(this.view);\r\n        if (removed instanceof Promise) {\r\n            return removed.then(function () {\r\n                _this._unbindView();\r\n            });\r\n        }\r\n        this._unbindView();\r\n    };\r\n    IfCore.prototype._unbindView = function () {\r\n        var cache = this.cache === 'false' ? false : !!this.cache;\r\n        this.view.unbind();\r\n        if (!cache) {\r\n            this.view = null;\r\n        }\r\n    };\r\n    return IfCore;\r\n}());\n\nvar If = (function (_super) {\r\n    __extends(If, _super);\r\n    function If() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.cache = true;\r\n        return _this;\r\n    }\r\n    If.prototype.bind = function (bindingContext, overrideContext) {\r\n        _super.prototype.bind.call(this, bindingContext, overrideContext);\r\n        if (this.condition) {\r\n            this._show();\r\n        }\r\n        else {\r\n            this._hide();\r\n        }\r\n    };\r\n    If.prototype.conditionChanged = function (newValue) {\r\n        this._update(newValue);\r\n    };\r\n    If.prototype._update = function (show) {\r\n        var _this = this;\r\n        if (this.animating) {\r\n            return;\r\n        }\r\n        var promise;\r\n        if (this.elseVm) {\r\n            promise = show ? this._swap(this.elseVm, this) : this._swap(this, this.elseVm);\r\n        }\r\n        else {\r\n            promise = show ? this._show() : this._hide();\r\n        }\r\n        if (promise) {\r\n            this.animating = true;\r\n            promise.then(function () {\r\n                _this.animating = false;\r\n                if (_this.condition !== _this.showing) {\r\n                    _this._update(_this.condition);\r\n                }\r\n            });\r\n        }\r\n    };\r\n    If.prototype._swap = function (remove, add) {\r\n        switch (this.swapOrder) {\r\n            case 'before':\r\n                return Promise.resolve(add._show()).then(function () { return remove._hide(); });\r\n            case 'with':\r\n                return Promise.all([remove._hide(), add._show()]);\r\n            default:\r\n                var promise = remove._hide();\r\n                return promise ? promise.then(function () { return add._show(); }) : add._show();\r\n        }\r\n    };\r\n    __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"])({ primaryProperty: true })\r\n    ], If.prototype, \"condition\", void 0);\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], If.prototype, \"swapOrder\", void 0);\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], If.prototype, \"cache\", void 0);\r\n    If = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('if'),\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n        Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"])\r\n    ], If);\r\n    return If;\r\n}(IfCore));\n\nvar Else = (function (_super) {\r\n    __extends(Else, _super);\r\n    function Else(viewFactory, viewSlot) {\r\n        var _this = _super.call(this, viewFactory, viewSlot) || this;\r\n        _this._registerInIf();\r\n        return _this;\r\n    }\r\n    Else.prototype.bind = function (bindingContext, overrideContext) {\r\n        _super.prototype.bind.call(this, bindingContext, overrideContext);\r\n        if (this.ifVm.condition) {\r\n            this._hide();\r\n        }\r\n        else {\r\n            this._show();\r\n        }\r\n    };\r\n    Else.prototype._registerInIf = function () {\r\n        var previous = this.viewSlot.anchor.previousSibling;\r\n        while (previous && !previous.au) {\r\n            previous = previous.previousSibling;\r\n        }\r\n        if (!previous || !previous.au.if) {\r\n            throw new Error(\"Can't find matching If for Else custom attribute.\");\r\n        }\r\n        this.ifVm = previous.au.if.viewModel;\r\n        this.ifVm.elseVm = this;\r\n    };\r\n    Else = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('else'),\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n        Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"])\r\n    ], Else);\r\n    return Else;\r\n}(IfCore));\n\nvar With = (function () {\r\n    function With(viewFactory, viewSlot) {\r\n        this.viewFactory = viewFactory;\r\n        this.viewSlot = viewSlot;\r\n        this.parentOverrideContext = null;\r\n        this.view = null;\r\n    }\r\n    With.prototype.bind = function (bindingContext, overrideContext) {\r\n        this.parentOverrideContext = overrideContext;\r\n        this.valueChanged(this.value);\r\n    };\r\n    With.prototype.valueChanged = function (newValue) {\r\n        var overrideContext = Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"createOverrideContext\"])(newValue, this.parentOverrideContext);\r\n        var view = this.view;\r\n        if (!view) {\r\n            view = this.view = this.viewFactory.create();\r\n            view.bind(newValue, overrideContext);\r\n            this.viewSlot.add(view);\r\n        }\r\n        else {\r\n            view.bind(newValue, overrideContext);\r\n        }\r\n    };\r\n    With.prototype.unbind = function () {\r\n        var view = this.view;\r\n        this.parentOverrideContext = null;\r\n        if (view) {\r\n            view.unbind();\r\n        }\r\n    };\r\n    With = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('with'),\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n        Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"])\r\n    ], With);\r\n    return With;\r\n}());\n\nvar oneTime = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].oneTime;\r\nfunction updateOverrideContexts(views, startIndex) {\r\n    var length = views.length;\r\n    if (startIndex > 0) {\r\n        startIndex = startIndex - 1;\r\n    }\r\n    for (; startIndex < length; ++startIndex) {\r\n        updateOverrideContext(views[startIndex].overrideContext, startIndex, length);\r\n    }\r\n}\r\nfunction createFullOverrideContext(repeat, data, index, length, key) {\r\n    var bindingContext = {};\r\n    var overrideContext = Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"createOverrideContext\"])(bindingContext, repeat.scope.overrideContext);\r\n    if (typeof key !== 'undefined') {\r\n        bindingContext[repeat.key] = key;\r\n        bindingContext[repeat.value] = data;\r\n    }\r\n    else {\r\n        bindingContext[repeat.local] = data;\r\n    }\r\n    updateOverrideContext(overrideContext, index, length);\r\n    return overrideContext;\r\n}\r\nfunction updateOverrideContext(overrideContext, index, length) {\r\n    var first = (index === 0);\r\n    var last = (index === length - 1);\r\n    var even = index % 2 === 0;\r\n    overrideContext.$index = index;\r\n    overrideContext.$first = first;\r\n    overrideContext.$last = last;\r\n    overrideContext.$middle = !(first || last);\r\n    overrideContext.$odd = !even;\r\n    overrideContext.$even = even;\r\n}\r\nfunction getItemsSourceExpression(instruction, attrName) {\r\n    return instruction.behaviorInstructions\r\n        .filter(function (bi) { return bi.originalAttrName === attrName; })[0]\r\n        .attributes\r\n        .items\r\n        .sourceExpression;\r\n}\r\nfunction unwrapExpression(expression) {\r\n    var unwrapped = false;\r\n    while (expression instanceof aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"BindingBehavior\"]) {\r\n        expression = expression.expression;\r\n    }\r\n    while (expression instanceof aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"ValueConverter\"]) {\r\n        expression = expression.expression;\r\n        unwrapped = true;\r\n    }\r\n    return unwrapped ? expression : null;\r\n}\r\nfunction isOneTime(expression) {\r\n    while (expression instanceof aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"BindingBehavior\"]) {\r\n        if (expression.name === 'oneTime') {\r\n            return true;\r\n        }\r\n        expression = expression.expression;\r\n    }\r\n    return false;\r\n}\r\nfunction updateOneTimeBinding(binding) {\r\n    if (binding.call && binding.mode === oneTime) {\r\n        binding.call(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"sourceContext\"]);\r\n    }\r\n    else if (binding.updateOneTimeBindings) {\r\n        binding.updateOneTimeBindings();\r\n    }\r\n}\r\nfunction indexOf(array, item, matcher, startIndex) {\r\n    if (!matcher) {\r\n        return array.indexOf(item);\r\n    }\r\n    var length = array.length;\r\n    for (var index = startIndex || 0; index < length; index++) {\r\n        if (matcher(array[index], item)) {\r\n            return index;\r\n        }\r\n    }\r\n    return -1;\r\n}\n\nvar ArrayRepeatStrategy = (function () {\r\n    function ArrayRepeatStrategy() {\r\n    }\r\n    ArrayRepeatStrategy.prototype.getCollectionObserver = function (observerLocator, items) {\r\n        return observerLocator.getArrayObserver(items);\r\n    };\r\n    ArrayRepeatStrategy.prototype.instanceChanged = function (repeat, items) {\r\n        var _this = this;\r\n        var $repeat = repeat;\r\n        var itemsLength = items.length;\r\n        if (!items || itemsLength === 0) {\r\n            $repeat.removeAllViews(true, !$repeat.viewsRequireLifecycle);\r\n            return;\r\n        }\r\n        var children = $repeat.views();\r\n        var viewsLength = children.length;\r\n        if (viewsLength === 0) {\r\n            this._standardProcessInstanceChanged($repeat, items);\r\n            return;\r\n        }\r\n        if ($repeat.viewsRequireLifecycle) {\r\n            var childrenSnapshot = children.slice(0);\r\n            var itemNameInBindingContext = $repeat.local;\r\n            var matcher_1 = $repeat.matcher();\r\n            var itemsPreviouslyInViews_1 = [];\r\n            var viewsToRemove = [];\r\n            for (var index = 0; index < viewsLength; index++) {\r\n                var view = childrenSnapshot[index];\r\n                var oldItem = view.bindingContext[itemNameInBindingContext];\r\n                if (indexOf(items, oldItem, matcher_1) === -1) {\r\n                    viewsToRemove.push(view);\r\n                }\r\n                else {\r\n                    itemsPreviouslyInViews_1.push(oldItem);\r\n                }\r\n            }\r\n            var updateViews = void 0;\r\n            var removePromise = void 0;\r\n            if (itemsPreviouslyInViews_1.length > 0) {\r\n                removePromise = $repeat.removeViews(viewsToRemove, true, !$repeat.viewsRequireLifecycle);\r\n                updateViews = function () {\r\n                    for (var index = 0; index < itemsLength; index++) {\r\n                        var item = items[index];\r\n                        var indexOfView = indexOf(itemsPreviouslyInViews_1, item, matcher_1, index);\r\n                        var view = void 0;\r\n                        if (indexOfView === -1) {\r\n                            var overrideContext = createFullOverrideContext($repeat, items[index], index, itemsLength);\r\n                            $repeat.insertView(index, overrideContext.bindingContext, overrideContext);\r\n                            itemsPreviouslyInViews_1.splice(index, 0, undefined);\r\n                        }\r\n                        else if (indexOfView === index) {\r\n                            view = children[indexOfView];\r\n                            itemsPreviouslyInViews_1[indexOfView] = undefined;\r\n                        }\r\n                        else {\r\n                            view = children[indexOfView];\r\n                            $repeat.moveView(indexOfView, index);\r\n                            itemsPreviouslyInViews_1.splice(indexOfView, 1);\r\n                            itemsPreviouslyInViews_1.splice(index, 0, undefined);\r\n                        }\r\n                        if (view) {\r\n                            updateOverrideContext(view.overrideContext, index, itemsLength);\r\n                        }\r\n                    }\r\n                    _this._inPlaceProcessItems($repeat, items);\r\n                };\r\n            }\r\n            else {\r\n                removePromise = $repeat.removeAllViews(true, !$repeat.viewsRequireLifecycle);\r\n                updateViews = function () { return _this._standardProcessInstanceChanged($repeat, items); };\r\n            }\r\n            if (removePromise instanceof Promise) {\r\n                removePromise.then(updateViews);\r\n            }\r\n            else {\r\n                updateViews();\r\n            }\r\n        }\r\n        else {\r\n            this._inPlaceProcessItems($repeat, items);\r\n        }\r\n    };\r\n    ArrayRepeatStrategy.prototype._standardProcessInstanceChanged = function (repeat, items) {\r\n        for (var i = 0, ii = items.length; i < ii; i++) {\r\n            var overrideContext = createFullOverrideContext(repeat, items[i], i, ii);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n        }\r\n    };\r\n    ArrayRepeatStrategy.prototype._inPlaceProcessItems = function (repeat, items) {\r\n        var itemsLength = items.length;\r\n        var viewsLength = repeat.viewCount();\r\n        while (viewsLength > itemsLength) {\r\n            viewsLength--;\r\n            repeat.removeView(viewsLength, true, !repeat.viewsRequireLifecycle);\r\n        }\r\n        var local = repeat.local;\r\n        for (var i = 0; i < viewsLength; i++) {\r\n            var view = repeat.view(i);\r\n            var last = i === itemsLength - 1;\r\n            var middle = i !== 0 && !last;\r\n            var bindingContext = view.bindingContext;\r\n            var overrideContext = view.overrideContext;\r\n            if (bindingContext[local] === items[i]\r\n                && overrideContext.$middle === middle\r\n                && overrideContext.$last === last) {\r\n                continue;\r\n            }\r\n            bindingContext[local] = items[i];\r\n            overrideContext.$middle = middle;\r\n            overrideContext.$last = last;\r\n            repeat.updateBindings(view);\r\n        }\r\n        for (var i = viewsLength; i < itemsLength; i++) {\r\n            var overrideContext = createFullOverrideContext(repeat, items[i], i, itemsLength);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n        }\r\n    };\r\n    ArrayRepeatStrategy.prototype.instanceMutated = function (repeat, array, splices) {\r\n        var _this = this;\r\n        if (repeat.__queuedSplices) {\r\n            for (var i = 0, ii = splices.length; i < ii; ++i) {\r\n                var _a = splices[i], index = _a.index, removed = _a.removed, addedCount = _a.addedCount;\r\n                Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"mergeSplice\"])(repeat.__queuedSplices, index, removed, addedCount);\r\n            }\r\n            repeat.__array = array.slice(0);\r\n            return;\r\n        }\r\n        var maybePromise = this._runSplices(repeat, array.slice(0), splices);\r\n        if (maybePromise instanceof Promise) {\r\n            var queuedSplices_1 = repeat.__queuedSplices = [];\r\n            var runQueuedSplices_1 = function () {\r\n                if (!queuedSplices_1.length) {\r\n                    repeat.__queuedSplices = undefined;\r\n                    repeat.__array = undefined;\r\n                    return;\r\n                }\r\n                var nextPromise = _this._runSplices(repeat, repeat.__array, queuedSplices_1) || Promise.resolve();\r\n                queuedSplices_1 = repeat.__queuedSplices = [];\r\n                nextPromise.then(runQueuedSplices_1);\r\n            };\r\n            maybePromise.then(runQueuedSplices_1);\r\n        }\r\n    };\r\n    ArrayRepeatStrategy.prototype._runSplices = function (repeat, array, splices) {\r\n        var _this = this;\r\n        var removeDelta = 0;\r\n        var rmPromises = [];\r\n        for (var i = 0, ii = splices.length; i < ii; ++i) {\r\n            var splice = splices[i];\r\n            var removed = splice.removed;\r\n            for (var j = 0, jj = removed.length; j < jj; ++j) {\r\n                var viewOrPromise = repeat.removeView(splice.index + removeDelta + rmPromises.length, true);\r\n                if (viewOrPromise instanceof Promise) {\r\n                    rmPromises.push(viewOrPromise);\r\n                }\r\n            }\r\n            removeDelta -= splice.addedCount;\r\n        }\r\n        if (rmPromises.length > 0) {\r\n            return Promise.all(rmPromises).then(function () {\r\n                var spliceIndexLow = _this._handleAddedSplices(repeat, array, splices);\r\n                updateOverrideContexts(repeat.views(), spliceIndexLow);\r\n            });\r\n        }\r\n        var spliceIndexLow = this._handleAddedSplices(repeat, array, splices);\r\n        updateOverrideContexts(repeat.views(), spliceIndexLow);\r\n        return undefined;\r\n    };\r\n    ArrayRepeatStrategy.prototype._handleAddedSplices = function (repeat, array, splices) {\r\n        var spliceIndex;\r\n        var spliceIndexLow;\r\n        var arrayLength = array.length;\r\n        for (var i = 0, ii = splices.length; i < ii; ++i) {\r\n            var splice = splices[i];\r\n            var addIndex = spliceIndex = splice.index;\r\n            var end = splice.index + splice.addedCount;\r\n            if (typeof spliceIndexLow === 'undefined' || spliceIndexLow === null || spliceIndexLow > splice.index) {\r\n                spliceIndexLow = spliceIndex;\r\n            }\r\n            for (; addIndex < end; ++addIndex) {\r\n                var overrideContext = createFullOverrideContext(repeat, array[addIndex], addIndex, arrayLength);\r\n                repeat.insertView(addIndex, overrideContext.bindingContext, overrideContext);\r\n            }\r\n        }\r\n        return spliceIndexLow;\r\n    };\r\n    return ArrayRepeatStrategy;\r\n}());\n\nvar MapRepeatStrategy = (function () {\r\n    function MapRepeatStrategy() {\r\n    }\r\n    MapRepeatStrategy.prototype.getCollectionObserver = function (observerLocator, items) {\r\n        return observerLocator.getMapObserver(items);\r\n    };\r\n    MapRepeatStrategy.prototype.instanceChanged = function (repeat, items) {\r\n        var _this = this;\r\n        var removePromise = repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n        if (removePromise instanceof Promise) {\r\n            removePromise.then(function () { return _this._standardProcessItems(repeat, items); });\r\n            return;\r\n        }\r\n        this._standardProcessItems(repeat, items);\r\n    };\r\n    MapRepeatStrategy.prototype._standardProcessItems = function (repeat, items) {\r\n        var index = 0;\r\n        var overrideContext;\r\n        items.forEach(function (value, key) {\r\n            overrideContext = createFullOverrideContext(repeat, value, index, items.size, key);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n            ++index;\r\n        });\r\n    };\r\n    MapRepeatStrategy.prototype.instanceMutated = function (repeat, map, records) {\r\n        var key;\r\n        var i;\r\n        var ii;\r\n        var overrideContext;\r\n        var removeIndex;\r\n        var addIndex;\r\n        var record;\r\n        var rmPromises = [];\r\n        var viewOrPromise;\r\n        for (i = 0, ii = records.length; i < ii; ++i) {\r\n            record = records[i];\r\n            key = record.key;\r\n            switch (record.type) {\r\n                case 'update':\r\n                    removeIndex = this._getViewIndexByKey(repeat, key);\r\n                    viewOrPromise = repeat.removeView(removeIndex, true, !repeat.viewsRequireLifecycle);\r\n                    if (viewOrPromise instanceof Promise) {\r\n                        rmPromises.push(viewOrPromise);\r\n                    }\r\n                    overrideContext = createFullOverrideContext(repeat, map.get(key), removeIndex, map.size, key);\r\n                    repeat.insertView(removeIndex, overrideContext.bindingContext, overrideContext);\r\n                    break;\r\n                case 'add':\r\n                    addIndex = repeat.viewCount() <= map.size - 1 ? repeat.viewCount() : map.size - 1;\r\n                    overrideContext = createFullOverrideContext(repeat, map.get(key), addIndex, map.size, key);\r\n                    repeat.insertView(map.size - 1, overrideContext.bindingContext, overrideContext);\r\n                    break;\r\n                case 'delete':\r\n                    if (record.oldValue === undefined) {\r\n                        return;\r\n                    }\r\n                    removeIndex = this._getViewIndexByKey(repeat, key);\r\n                    viewOrPromise = repeat.removeView(removeIndex, true, !repeat.viewsRequireLifecycle);\r\n                    if (viewOrPromise instanceof Promise) {\r\n                        rmPromises.push(viewOrPromise);\r\n                    }\r\n                    break;\r\n                case 'clear':\r\n                    repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n                    break;\r\n                default:\r\n                    continue;\r\n            }\r\n        }\r\n        if (rmPromises.length > 0) {\r\n            Promise.all(rmPromises).then(function () {\r\n                updateOverrideContexts(repeat.views(), 0);\r\n            });\r\n        }\r\n        else {\r\n            updateOverrideContexts(repeat.views(), 0);\r\n        }\r\n    };\r\n    MapRepeatStrategy.prototype._getViewIndexByKey = function (repeat, key) {\r\n        var i;\r\n        var ii;\r\n        var child;\r\n        for (i = 0, ii = repeat.viewCount(); i < ii; ++i) {\r\n            child = repeat.view(i);\r\n            if (child.bindingContext[repeat.key] === key) {\r\n                return i;\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n    return MapRepeatStrategy;\r\n}());\n\nvar NullRepeatStrategy = (function () {\r\n    function NullRepeatStrategy() {\r\n    }\r\n    NullRepeatStrategy.prototype.instanceChanged = function (repeat, items) {\r\n        repeat.removeAllViews(true);\r\n    };\r\n    NullRepeatStrategy.prototype.getCollectionObserver = function (observerLocator, items) {\r\n    };\r\n    return NullRepeatStrategy;\r\n}());\n\nvar NumberRepeatStrategy = (function () {\r\n    function NumberRepeatStrategy() {\r\n    }\r\n    NumberRepeatStrategy.prototype.getCollectionObserver = function () {\r\n        return null;\r\n    };\r\n    NumberRepeatStrategy.prototype.instanceChanged = function (repeat, value) {\r\n        var _this = this;\r\n        var removePromise = repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n        if (removePromise instanceof Promise) {\r\n            removePromise.then(function () { return _this._standardProcessItems(repeat, value); });\r\n            return;\r\n        }\r\n        this._standardProcessItems(repeat, value);\r\n    };\r\n    NumberRepeatStrategy.prototype._standardProcessItems = function (repeat, value) {\r\n        var childrenLength = repeat.viewCount();\r\n        var i;\r\n        var ii;\r\n        var overrideContext;\r\n        var viewsToRemove;\r\n        value = Math.floor(value);\r\n        viewsToRemove = childrenLength - value;\r\n        if (viewsToRemove > 0) {\r\n            if (viewsToRemove > childrenLength) {\r\n                viewsToRemove = childrenLength;\r\n            }\r\n            for (i = 0, ii = viewsToRemove; i < ii; ++i) {\r\n                repeat.removeView(childrenLength - (i + 1), true, !repeat.viewsRequireLifecycle);\r\n            }\r\n            return;\r\n        }\r\n        for (i = childrenLength, ii = value; i < ii; ++i) {\r\n            overrideContext = createFullOverrideContext(repeat, i, i, ii);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n        }\r\n        updateOverrideContexts(repeat.views(), 0);\r\n    };\r\n    return NumberRepeatStrategy;\r\n}());\n\nvar SetRepeatStrategy = (function () {\r\n    function SetRepeatStrategy() {\r\n    }\r\n    SetRepeatStrategy.prototype.getCollectionObserver = function (observerLocator, items) {\r\n        return observerLocator.getSetObserver(items);\r\n    };\r\n    SetRepeatStrategy.prototype.instanceChanged = function (repeat, items) {\r\n        var _this = this;\r\n        var removePromise = repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n        if (removePromise instanceof Promise) {\r\n            removePromise.then(function () { return _this._standardProcessItems(repeat, items); });\r\n            return;\r\n        }\r\n        this._standardProcessItems(repeat, items);\r\n    };\r\n    SetRepeatStrategy.prototype._standardProcessItems = function (repeat, items) {\r\n        var index = 0;\r\n        var overrideContext;\r\n        items.forEach(function (value) {\r\n            overrideContext = createFullOverrideContext(repeat, value, index, items.size);\r\n            repeat.addView(overrideContext.bindingContext, overrideContext);\r\n            ++index;\r\n        });\r\n    };\r\n    SetRepeatStrategy.prototype.instanceMutated = function (repeat, set, records) {\r\n        var value;\r\n        var i;\r\n        var ii;\r\n        var overrideContext;\r\n        var removeIndex;\r\n        var record;\r\n        var rmPromises = [];\r\n        var viewOrPromise;\r\n        for (i = 0, ii = records.length; i < ii; ++i) {\r\n            record = records[i];\r\n            value = record.value;\r\n            switch (record.type) {\r\n                case 'add':\r\n                    var size = Math.max(set.size - 1, 0);\r\n                    overrideContext = createFullOverrideContext(repeat, value, size, set.size);\r\n                    repeat.insertView(size, overrideContext.bindingContext, overrideContext);\r\n                    break;\r\n                case 'delete':\r\n                    removeIndex = this._getViewIndexByValue(repeat, value);\r\n                    viewOrPromise = repeat.removeView(removeIndex, true, !repeat.viewsRequireLifecycle);\r\n                    if (viewOrPromise instanceof Promise) {\r\n                        rmPromises.push(viewOrPromise);\r\n                    }\r\n                    break;\r\n                case 'clear':\r\n                    repeat.removeAllViews(true, !repeat.viewsRequireLifecycle);\r\n                    break;\r\n                default:\r\n                    continue;\r\n            }\r\n        }\r\n        if (rmPromises.length > 0) {\r\n            Promise.all(rmPromises).then(function () {\r\n                updateOverrideContexts(repeat.views(), 0);\r\n            });\r\n        }\r\n        else {\r\n            updateOverrideContexts(repeat.views(), 0);\r\n        }\r\n    };\r\n    SetRepeatStrategy.prototype._getViewIndexByValue = function (repeat, value) {\r\n        var i;\r\n        var ii;\r\n        var child;\r\n        for (i = 0, ii = repeat.viewCount(); i < ii; ++i) {\r\n            child = repeat.view(i);\r\n            if (child.bindingContext[repeat.local] === value) {\r\n                return i;\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n    return SetRepeatStrategy;\r\n}());\n\nvar RepeatStrategyLocator = (function () {\r\n    function RepeatStrategyLocator() {\r\n        this.matchers = [];\r\n        this.strategies = [];\r\n        this.addStrategy(function (items) { return items === null || items === undefined; }, new NullRepeatStrategy());\r\n        this.addStrategy(function (items) { return items instanceof Array; }, new ArrayRepeatStrategy());\r\n        this.addStrategy(function (items) { return items instanceof Map; }, new MapRepeatStrategy());\r\n        this.addStrategy(function (items) { return items instanceof Set; }, new SetRepeatStrategy());\r\n        this.addStrategy(function (items) { return typeof items === 'number'; }, new NumberRepeatStrategy());\r\n    }\r\n    RepeatStrategyLocator.prototype.addStrategy = function (matcher, strategy) {\r\n        this.matchers.push(matcher);\r\n        this.strategies.push(strategy);\r\n    };\r\n    RepeatStrategyLocator.prototype.getStrategy = function (items) {\r\n        var matchers = this.matchers;\r\n        for (var i = 0, ii = matchers.length; i < ii; ++i) {\r\n            if (matchers[i](items)) {\r\n                return this.strategies[i];\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    return RepeatStrategyLocator;\r\n}());\n\nvar lifecycleOptionalBehaviors = ['focus', 'if', 'else', 'repeat', 'show', 'hide', 'with'];\r\nfunction behaviorRequiresLifecycle(instruction) {\r\n    var t = instruction.type;\r\n    var name = t.elementName !== null ? t.elementName : t.attributeName;\r\n    return lifecycleOptionalBehaviors.indexOf(name) === -1 && (t.handlesAttached || t.handlesBind || t.handlesCreated || t.handlesDetached || t.handlesUnbind)\r\n        || t.viewFactory && viewsRequireLifecycle(t.viewFactory)\r\n        || instruction.viewFactory && viewsRequireLifecycle(instruction.viewFactory);\r\n}\r\nfunction targetRequiresLifecycle(instruction) {\r\n    var behaviors = instruction.behaviorInstructions;\r\n    if (behaviors) {\r\n        var i = behaviors.length;\r\n        while (i--) {\r\n            if (behaviorRequiresLifecycle(behaviors[i])) {\r\n                return true;\r\n            }\r\n        }\r\n    }\r\n    return instruction.viewFactory && viewsRequireLifecycle(instruction.viewFactory);\r\n}\r\nfunction viewsRequireLifecycle(viewFactory) {\r\n    if ('_viewsRequireLifecycle' in viewFactory) {\r\n        return viewFactory._viewsRequireLifecycle;\r\n    }\r\n    viewFactory._viewsRequireLifecycle = false;\r\n    if (viewFactory.viewFactory) {\r\n        viewFactory._viewsRequireLifecycle = viewsRequireLifecycle(viewFactory.viewFactory);\r\n        return viewFactory._viewsRequireLifecycle;\r\n    }\r\n    if (viewFactory.template.querySelector('.au-animate')) {\r\n        viewFactory._viewsRequireLifecycle = true;\r\n        return true;\r\n    }\r\n    for (var id in viewFactory.instructions) {\r\n        if (targetRequiresLifecycle(viewFactory.instructions[id])) {\r\n            viewFactory._viewsRequireLifecycle = true;\r\n            return true;\r\n        }\r\n    }\r\n    viewFactory._viewsRequireLifecycle = false;\r\n    return false;\r\n}\n\nvar AbstractRepeater = (function () {\r\n    function AbstractRepeater(options) {\r\n        Object.assign(this, {\r\n            local: 'items',\r\n            viewsRequireLifecycle: true\r\n        }, options);\r\n    }\r\n    AbstractRepeater.prototype.viewCount = function () {\r\n        throw new Error('subclass must implement `viewCount`');\r\n    };\r\n    AbstractRepeater.prototype.views = function () {\r\n        throw new Error('subclass must implement `views`');\r\n    };\r\n    AbstractRepeater.prototype.view = function (index) {\r\n        throw new Error('subclass must implement `view`');\r\n    };\r\n    AbstractRepeater.prototype.matcher = function () {\r\n        throw new Error('subclass must implement `matcher`');\r\n    };\r\n    AbstractRepeater.prototype.addView = function (bindingContext, overrideContext) {\r\n        throw new Error('subclass must implement `addView`');\r\n    };\r\n    AbstractRepeater.prototype.insertView = function (index, bindingContext, overrideContext) {\r\n        throw new Error('subclass must implement `insertView`');\r\n    };\r\n    AbstractRepeater.prototype.moveView = function (sourceIndex, targetIndex) {\r\n        throw new Error('subclass must implement `moveView`');\r\n    };\r\n    AbstractRepeater.prototype.removeAllViews = function (returnToCache, skipAnimation) {\r\n        throw new Error('subclass must implement `removeAllViews`');\r\n    };\r\n    AbstractRepeater.prototype.removeViews = function (viewsToRemove, returnToCache, skipAnimation) {\r\n        throw new Error('subclass must implement `removeView`');\r\n    };\r\n    AbstractRepeater.prototype.removeView = function (index, returnToCache, skipAnimation) {\r\n        throw new Error('subclass must implement `removeView`');\r\n    };\r\n    AbstractRepeater.prototype.updateBindings = function (view) {\r\n        throw new Error('subclass must implement `updateBindings`');\r\n    };\r\n    return AbstractRepeater;\r\n}());\n\nvar matcherExtractionMarker = '__marker_extracted__';\r\nvar Repeat = (function (_super) {\r\n    __extends(Repeat, _super);\r\n    function Repeat(viewFactory, instruction, viewSlot, viewResources, observerLocator, strategyLocator) {\r\n        var _this = _super.call(this, {\r\n            local: 'item',\r\n            viewsRequireLifecycle: viewsRequireLifecycle(viewFactory)\r\n        }) || this;\r\n        _this.viewFactory = viewFactory;\r\n        _this.instruction = instruction;\r\n        _this.viewSlot = viewSlot;\r\n        _this.lookupFunctions = viewResources.lookupFunctions;\r\n        _this.observerLocator = observerLocator;\r\n        _this.key = 'key';\r\n        _this.value = 'value';\r\n        _this.strategyLocator = strategyLocator;\r\n        _this.ignoreMutation = false;\r\n        _this.sourceExpression = getItemsSourceExpression(_this.instruction, 'repeat.for');\r\n        _this.isOneTime = isOneTime(_this.sourceExpression);\r\n        _this.viewsRequireLifecycle = viewsRequireLifecycle(viewFactory);\r\n        return _this;\r\n    }\r\n    Repeat_1 = Repeat;\r\n    Repeat.prototype.call = function (context, changes) {\r\n        this[context](this.items, changes);\r\n    };\r\n    Repeat.prototype.bind = function (bindingContext, overrideContext) {\r\n        this.scope = { bindingContext: bindingContext, overrideContext: overrideContext };\r\n        var instruction = this.instruction;\r\n        if (!(matcherExtractionMarker in instruction)) {\r\n            instruction[matcherExtractionMarker] = this._captureAndRemoveMatcherBinding();\r\n        }\r\n        this.matcherBinding = instruction[matcherExtractionMarker];\r\n        this.itemsChanged();\r\n    };\r\n    Repeat.prototype.unbind = function () {\r\n        this.scope = null;\r\n        this.items = null;\r\n        this.matcherBinding = null;\r\n        this.viewSlot.removeAll(true, true);\r\n        this._unsubscribeCollection();\r\n    };\r\n    Repeat.prototype._unsubscribeCollection = function () {\r\n        if (this.collectionObserver) {\r\n            this.collectionObserver.unsubscribe(this.callContext, this);\r\n            this.collectionObserver = null;\r\n            this.callContext = null;\r\n        }\r\n    };\r\n    Repeat.prototype.itemsChanged = function () {\r\n        var _this = this;\r\n        this._unsubscribeCollection();\r\n        if (!this.scope) {\r\n            return;\r\n        }\r\n        var items = this.items;\r\n        this.strategy = this.strategyLocator.getStrategy(items);\r\n        if (!this.strategy) {\r\n            throw new Error(\"Value for '\" + this.sourceExpression + \"' is non-repeatable\");\r\n        }\r\n        if (!this.isOneTime && !this._observeInnerCollection()) {\r\n            this._observeCollection();\r\n        }\r\n        this.ignoreMutation = true;\r\n        this.strategy.instanceChanged(this, items);\r\n        this.observerLocator.taskQueue.queueMicroTask(function () {\r\n            _this.ignoreMutation = false;\r\n        });\r\n    };\r\n    Repeat.prototype._getInnerCollection = function () {\r\n        var expression = unwrapExpression(this.sourceExpression);\r\n        if (!expression) {\r\n            return null;\r\n        }\r\n        return expression.evaluate(this.scope, null);\r\n    };\r\n    Repeat.prototype.handleCollectionMutated = function (collection, changes) {\r\n        if (!this.collectionObserver) {\r\n            return;\r\n        }\r\n        if (this.ignoreMutation) {\r\n            return;\r\n        }\r\n        this.strategy.instanceMutated(this, collection, changes);\r\n    };\r\n    Repeat.prototype.handleInnerCollectionMutated = function (collection, changes) {\r\n        var _this = this;\r\n        if (!this.collectionObserver) {\r\n            return;\r\n        }\r\n        if (this.ignoreMutation) {\r\n            return;\r\n        }\r\n        this.ignoreMutation = true;\r\n        var newItems = this.sourceExpression.evaluate(this.scope, this.lookupFunctions);\r\n        this.observerLocator.taskQueue.queueMicroTask(function () { return _this.ignoreMutation = false; });\r\n        if (newItems === this.items) {\r\n            this.itemsChanged();\r\n        }\r\n        else {\r\n            this.items = newItems;\r\n        }\r\n    };\r\n    Repeat.prototype._observeInnerCollection = function () {\r\n        var items = this._getInnerCollection();\r\n        var strategy = this.strategyLocator.getStrategy(items);\r\n        if (!strategy) {\r\n            return false;\r\n        }\r\n        this.collectionObserver = strategy.getCollectionObserver(this.observerLocator, items);\r\n        if (!this.collectionObserver) {\r\n            return false;\r\n        }\r\n        this.callContext = 'handleInnerCollectionMutated';\r\n        this.collectionObserver.subscribe(this.callContext, this);\r\n        return true;\r\n    };\r\n    Repeat.prototype._observeCollection = function () {\r\n        var items = this.items;\r\n        this.collectionObserver = this.strategy.getCollectionObserver(this.observerLocator, items);\r\n        if (this.collectionObserver) {\r\n            this.callContext = 'handleCollectionMutated';\r\n            this.collectionObserver.subscribe(this.callContext, this);\r\n        }\r\n    };\r\n    Repeat.prototype._captureAndRemoveMatcherBinding = function () {\r\n        var viewFactory = this.viewFactory.viewFactory;\r\n        if (viewFactory) {\r\n            var template = viewFactory.template;\r\n            var instructions = viewFactory.instructions;\r\n            if (Repeat_1.useInnerMatcher) {\r\n                return extractMatcherBindingExpression(instructions);\r\n            }\r\n            if (getChildrenCount(template) > 1) {\r\n                return undefined;\r\n            }\r\n            var repeatedElement = getFirstElementChild(template);\r\n            if (!repeatedElement.hasAttribute('au-target-id')) {\r\n                return undefined;\r\n            }\r\n            var repeatedElementTargetId = repeatedElement.getAttribute('au-target-id');\r\n            return extractMatcherBindingExpression(instructions, repeatedElementTargetId);\r\n        }\r\n        return undefined;\r\n    };\r\n    Repeat.prototype.viewCount = function () { return this.viewSlot.children.length; };\r\n    Repeat.prototype.views = function () { return this.viewSlot.children; };\r\n    Repeat.prototype.view = function (index) { return this.viewSlot.children[index]; };\r\n    Repeat.prototype.matcher = function () {\r\n        var matcherBinding = this.matcherBinding;\r\n        return matcherBinding\r\n            ? matcherBinding.sourceExpression.evaluate(this.scope, matcherBinding.lookupFunctions)\r\n            : null;\r\n    };\r\n    Repeat.prototype.addView = function (bindingContext, overrideContext) {\r\n        var view = this.viewFactory.create();\r\n        view.bind(bindingContext, overrideContext);\r\n        this.viewSlot.add(view);\r\n    };\r\n    Repeat.prototype.insertView = function (index, bindingContext, overrideContext) {\r\n        var view = this.viewFactory.create();\r\n        view.bind(bindingContext, overrideContext);\r\n        this.viewSlot.insert(index, view);\r\n    };\r\n    Repeat.prototype.moveView = function (sourceIndex, targetIndex) {\r\n        this.viewSlot.move(sourceIndex, targetIndex);\r\n    };\r\n    Repeat.prototype.removeAllViews = function (returnToCache, skipAnimation) {\r\n        return this.viewSlot.removeAll(returnToCache, skipAnimation);\r\n    };\r\n    Repeat.prototype.removeViews = function (viewsToRemove, returnToCache, skipAnimation) {\r\n        return this.viewSlot.removeMany(viewsToRemove, returnToCache, skipAnimation);\r\n    };\r\n    Repeat.prototype.removeView = function (index, returnToCache, skipAnimation) {\r\n        return this.viewSlot.removeAt(index, returnToCache, skipAnimation);\r\n    };\r\n    Repeat.prototype.updateBindings = function (view) {\r\n        var $view = view;\r\n        var j = $view.bindings.length;\r\n        while (j--) {\r\n            updateOneTimeBinding($view.bindings[j]);\r\n        }\r\n        j = $view.controllers.length;\r\n        while (j--) {\r\n            var k = $view.controllers[j].boundProperties.length;\r\n            while (k--) {\r\n                var binding = $view.controllers[j].boundProperties[k].binding;\r\n                updateOneTimeBinding(binding);\r\n            }\r\n        }\r\n    };\r\n    var Repeat_1;\r\n    Repeat.useInnerMatcher = true;\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], Repeat.prototype, \"items\", void 0);\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], Repeat.prototype, \"local\", void 0);\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], Repeat.prototype, \"key\", void 0);\r\n    __decorate([\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"]\r\n    ], Repeat.prototype, \"value\", void 0);\r\n    Repeat = Repeat_1 = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('repeat'),\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n        Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"TargetInstruction\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewResources\"], aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"ObserverLocator\"], RepeatStrategyLocator)\r\n    ], Repeat);\r\n    return Repeat;\r\n}(AbstractRepeater));\r\nvar extractMatcherBindingExpression = function (instructions, targetedElementId) {\r\n    var instructionIds = Object.keys(instructions);\r\n    for (var i = 0; i < instructionIds.length; i++) {\r\n        var instructionId = instructionIds[i];\r\n        if (targetedElementId !== undefined && instructionId !== targetedElementId) {\r\n            continue;\r\n        }\r\n        var expressions = instructions[instructionId].expressions;\r\n        if (expressions) {\r\n            for (var ii = 0; ii < expressions.length; ii++) {\r\n                if (expressions[ii].targetProperty === 'matcher') {\r\n                    var matcherBindingExpression = expressions[ii];\r\n                    expressions.splice(ii, 1);\r\n                    return matcherBindingExpression;\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\nvar getChildrenCount = function (el) {\r\n    var childNodes = el.childNodes;\r\n    var count = 0;\r\n    for (var i = 0, ii = childNodes.length; ii > i; ++i) {\r\n        if (childNodes[i].nodeType === 1) {\r\n            ++count;\r\n        }\r\n    }\r\n    return count;\r\n};\r\nvar getFirstElementChild = function (el) {\r\n    var firstChild = el.firstChild;\r\n    while (firstChild !== null) {\r\n        if (firstChild.nodeType === 1) {\r\n            return firstChild;\r\n        }\r\n        firstChild = firstChild.nextSibling;\r\n    }\r\n    return null;\r\n};\n\nvar aureliaHideClassName = 'aurelia-hide';\r\nvar aureliaHideClass = \".\" + aureliaHideClassName + \" { display:none !important; }\";\r\nfunction injectAureliaHideStyleAtHead() {\r\n    aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(aureliaHideClass);\r\n}\r\nfunction injectAureliaHideStyleAtBoundary(domBoundary) {\r\n    if (aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"FEATURE\"].shadowDOM && domBoundary && !domBoundary.hasAureliaHideStyle) {\r\n        domBoundary.hasAureliaHideStyle = true;\r\n        aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(aureliaHideClass, domBoundary);\r\n    }\r\n}\n\nvar Show = (function () {\r\n    function Show(element, animator, domBoundary) {\r\n        this.element = element;\r\n        this.animator = animator;\r\n        this.domBoundary = domBoundary;\r\n    }\r\n    Show.inject = function () {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].Element, aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"Animator\"], aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"Optional\"].of(aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].boundary, true)];\r\n    };\r\n    Show.prototype.created = function () {\r\n        injectAureliaHideStyleAtBoundary(this.domBoundary);\r\n    };\r\n    Show.prototype.valueChanged = function (newValue) {\r\n        var element = this.element;\r\n        var animator = this.animator;\r\n        if (newValue) {\r\n            animator.removeClass(element, aureliaHideClassName);\r\n        }\r\n        else {\r\n            animator.addClass(element, aureliaHideClassName);\r\n        }\r\n    };\r\n    Show.prototype.bind = function (bindingContext) {\r\n        this.valueChanged(this.value);\r\n    };\r\n    Show = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('show')\r\n    ], Show);\r\n    return Show;\r\n}());\n\nvar Hide = (function () {\r\n    function Hide(element, animator, domBoundary) {\r\n        this.element = element;\r\n        this.animator = animator;\r\n        this.domBoundary = domBoundary;\r\n    }\r\n    Hide.inject = function () {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].Element, aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"Animator\"], aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"Optional\"].of(aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].boundary, true)];\r\n    };\r\n    Hide.prototype.created = function () {\r\n        injectAureliaHideStyleAtBoundary(this.domBoundary);\r\n    };\r\n    Hide.prototype.valueChanged = function (newValue) {\r\n        if (newValue) {\r\n            this.animator.addClass(this.element, aureliaHideClassName);\r\n        }\r\n        else {\r\n            this.animator.removeClass(this.element, aureliaHideClassName);\r\n        }\r\n    };\r\n    Hide.prototype.bind = function (bindingContext) {\r\n        this.valueChanged(this.value);\r\n    };\r\n    Hide.prototype.value = function (value) {\r\n        throw new Error('Method not implemented.');\r\n    };\r\n    Hide = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('hide')\r\n    ], Hide);\r\n    return Hide;\r\n}());\n\nvar SCRIPT_REGEX = /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi;\r\nvar needsToWarn = true;\r\nvar HTMLSanitizer = (function () {\r\n    function HTMLSanitizer() {\r\n    }\r\n    HTMLSanitizer.prototype.sanitize = function (input) {\r\n        if (needsToWarn) {\r\n            needsToWarn = false;\r\n            Object(aurelia_logging__WEBPACK_IMPORTED_MODULE_5__[\"getLogger\"])('html-sanitizer')\r\n                .warn(\"CAUTION: The default HTMLSanitizer does NOT provide security against a wide variety of sophisticated XSS attacks,\\nand should not be relied on for sanitizing input from unknown sources.\\nPlease see https://aurelia.io/docs/binding/basics#element-content for instructions on how to use a secure solution like DOMPurify or sanitize-html.\");\r\n        }\r\n        return input.replace(SCRIPT_REGEX, '');\r\n    };\r\n    return HTMLSanitizer;\r\n}());\n\nvar SanitizeHTMLValueConverter = (function () {\r\n    function SanitizeHTMLValueConverter(sanitizer) {\r\n        this.sanitizer = sanitizer;\r\n    }\r\n    SanitizeHTMLValueConverter.prototype.toView = function (untrustedMarkup) {\r\n        if (untrustedMarkup === null || untrustedMarkup === undefined) {\r\n            return null;\r\n        }\r\n        return this.sanitizer.sanitize(untrustedMarkup);\r\n    };\r\n    SanitizeHTMLValueConverter = __decorate([\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"valueConverter\"])('sanitizeHTML'),\r\n        Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(HTMLSanitizer)\r\n    ], SanitizeHTMLValueConverter);\r\n    return SanitizeHTMLValueConverter;\r\n}());\n\nvar Replaceable = (function () {\r\n    function Replaceable(viewFactory, viewSlot) {\r\n        this.viewFactory = viewFactory;\r\n        this.viewSlot = viewSlot;\r\n        this.view = null;\r\n    }\r\n    Replaceable.prototype.bind = function (bindingContext, overrideContext) {\r\n        if (this.view === null) {\r\n            this.view = this.viewFactory.create();\r\n            this.viewSlot.add(this.view);\r\n        }\r\n        this.view.bind(bindingContext, overrideContext);\r\n    };\r\n    Replaceable.prototype.unbind = function () {\r\n        this.view.unbind();\r\n    };\r\n    Replaceable = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('replaceable'),\r\n        aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"templateController\"],\r\n        Object(aurelia_dependency_injection__WEBPACK_IMPORTED_MODULE_0__[\"inject\"])(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"BoundViewFactory\"], aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewSlot\"])\r\n    ], Replaceable);\r\n    return Replaceable;\r\n}());\n\nvar Focus = (function () {\r\n    function Focus(element, taskQueue) {\r\n        this.element = element;\r\n        this.taskQueue = taskQueue;\r\n        this.isAttached = false;\r\n        this.needsApply = false;\r\n    }\r\n    Focus.inject = function () {\r\n        return [aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].Element, aurelia_task_queue__WEBPACK_IMPORTED_MODULE_2__[\"TaskQueue\"]];\r\n    };\r\n    Focus.prototype.valueChanged = function (newValue) {\r\n        if (this.isAttached) {\r\n            this._apply();\r\n        }\r\n        else {\r\n            this.needsApply = true;\r\n        }\r\n    };\r\n    Focus.prototype._apply = function () {\r\n        var _this = this;\r\n        if (this.value) {\r\n            this.taskQueue.queueMicroTask(function () {\r\n                if (_this.value) {\r\n                    _this.element.focus();\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            this.element.blur();\r\n        }\r\n    };\r\n    Focus.prototype.attached = function () {\r\n        this.isAttached = true;\r\n        if (this.needsApply) {\r\n            this.needsApply = false;\r\n            this._apply();\r\n        }\r\n        this.element.addEventListener('focus', this);\r\n        this.element.addEventListener('blur', this);\r\n    };\r\n    Focus.prototype.detached = function () {\r\n        this.isAttached = false;\r\n        this.element.removeEventListener('focus', this);\r\n        this.element.removeEventListener('blur', this);\r\n    };\r\n    Focus.prototype.handleEvent = function (e) {\r\n        if (e.type === 'focus') {\r\n            this.value = true;\r\n        }\r\n        else if (aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].activeElement !== this.element) {\r\n            this.value = false;\r\n        }\r\n    };\r\n    Focus = __decorate([\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customAttribute\"])('focus', aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay)\r\n    ], Focus);\r\n    return Focus;\r\n}());\n\nvar cssUrlMatcher = /url\\((?!['\"]data)([^)]+)\\)/gi;\r\nfunction fixupCSSUrls(address, css) {\r\n    if (typeof css !== 'string') {\r\n        throw new Error(\"Failed loading required CSS file: \" + address);\r\n    }\r\n    return css.replace(cssUrlMatcher, function (match, p1) {\r\n        var quote = p1.charAt(0);\r\n        if (quote === '\\'' || quote === '\"') {\r\n            p1 = p1.substr(1, p1.length - 2);\r\n        }\r\n        return 'url(\\'' + Object(aurelia_path__WEBPACK_IMPORTED_MODULE_7__[\"relativeToFile\"])(p1, address) + '\\')';\r\n    });\r\n}\r\nvar CSSResource = (function () {\r\n    function CSSResource(address) {\r\n        this.address = address;\r\n        this._scoped = null;\r\n        this._global = false;\r\n        this._alreadyGloballyInjected = false;\r\n    }\r\n    CSSResource.prototype.initialize = function (container, Target) {\r\n        this._scoped = new Target(this);\r\n    };\r\n    CSSResource.prototype.register = function (registry, name) {\r\n        if (name === 'scoped') {\r\n            registry.registerViewEngineHooks(this._scoped);\r\n        }\r\n        else {\r\n            this._global = true;\r\n        }\r\n    };\r\n    CSSResource.prototype.load = function (container) {\r\n        var _this = this;\r\n        return container.get(aurelia_loader__WEBPACK_IMPORTED_MODULE_6__[\"Loader\"])\r\n            .loadText(this.address)\r\n            .catch(function (err) { return null; })\r\n            .then(function (text) {\r\n            text = fixupCSSUrls(_this.address, text);\r\n            _this._scoped.css = text;\r\n            if (_this._global) {\r\n                _this._alreadyGloballyInjected = true;\r\n                aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(text);\r\n            }\r\n        });\r\n    };\r\n    return CSSResource;\r\n}());\r\nvar CSSViewEngineHooks = (function () {\r\n    function CSSViewEngineHooks(owner) {\r\n        this.owner = owner;\r\n        this.css = null;\r\n    }\r\n    CSSViewEngineHooks.prototype.beforeCompile = function (content, resources, instruction) {\r\n        if (instruction.targetShadowDOM) {\r\n            aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(this.css, content, true);\r\n        }\r\n        else if (aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"FEATURE\"].scopedCSS) {\r\n            var styleNode = aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(this.css, content, true);\r\n            styleNode.setAttribute('scoped', 'scoped');\r\n        }\r\n        else if (this._global && !this.owner._alreadyGloballyInjected) {\r\n            aurelia_pal__WEBPACK_IMPORTED_MODULE_1__[\"DOM\"].injectStyles(this.css);\r\n            this.owner._alreadyGloballyInjected = true;\r\n        }\r\n    };\r\n    return CSSViewEngineHooks;\r\n}());\r\nfunction _createCSSResource(address) {\r\n    var ViewCSS = (function (_super) {\r\n        __extends(ViewCSS, _super);\r\n        function ViewCSS() {\r\n            return _super !== null && _super.apply(this, arguments) || this;\r\n        }\r\n        ViewCSS = __decorate([\r\n            Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"resource\"])(new CSSResource(address))\r\n        ], ViewCSS);\r\n        return ViewCSS;\r\n    }(CSSViewEngineHooks));\r\n    return ViewCSS;\r\n}\n\nvar AttrBindingBehavior = (function () {\r\n    function AttrBindingBehavior() {\r\n    }\r\n    AttrBindingBehavior.prototype.bind = function (binding, source) {\r\n        binding.targetObserver = new aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"DataAttributeObserver\"](binding.target, binding.targetProperty);\r\n    };\r\n    AttrBindingBehavior.prototype.unbind = function (binding, source) {\r\n    };\r\n    AttrBindingBehavior = __decorate([\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('attr')\r\n    ], AttrBindingBehavior);\r\n    return AttrBindingBehavior;\r\n}());\n\nvar modeBindingBehavior = {\r\n    bind: function (binding, source, lookupFunctions) {\r\n        binding.originalMode = binding.mode;\r\n        binding.mode = this.mode;\r\n    },\r\n    unbind: function (binding, source) {\r\n        binding.mode = binding.originalMode;\r\n        binding.originalMode = null;\r\n    }\r\n};\r\nvar OneTimeBindingBehavior = (function () {\r\n    function OneTimeBindingBehavior() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].oneTime;\r\n    }\r\n    OneTimeBindingBehavior = __decorate([\r\n        Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_8__[\"mixin\"])(modeBindingBehavior),\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('oneTime')\r\n    ], OneTimeBindingBehavior);\r\n    return OneTimeBindingBehavior;\r\n}());\r\nvar OneWayBindingBehavior = (function () {\r\n    function OneWayBindingBehavior() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].toView;\r\n    }\r\n    OneWayBindingBehavior = __decorate([\r\n        Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_8__[\"mixin\"])(modeBindingBehavior),\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('oneWay')\r\n    ], OneWayBindingBehavior);\r\n    return OneWayBindingBehavior;\r\n}());\r\nvar ToViewBindingBehavior = (function () {\r\n    function ToViewBindingBehavior() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].toView;\r\n    }\r\n    ToViewBindingBehavior = __decorate([\r\n        Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_8__[\"mixin\"])(modeBindingBehavior),\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('toView')\r\n    ], ToViewBindingBehavior);\r\n    return ToViewBindingBehavior;\r\n}());\r\nvar FromViewBindingBehavior = (function () {\r\n    function FromViewBindingBehavior() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].fromView;\r\n    }\r\n    FromViewBindingBehavior = __decorate([\r\n        Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_8__[\"mixin\"])(modeBindingBehavior),\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('fromView')\r\n    ], FromViewBindingBehavior);\r\n    return FromViewBindingBehavior;\r\n}());\r\nvar TwoWayBindingBehavior = (function () {\r\n    function TwoWayBindingBehavior() {\r\n        this.mode = aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay;\r\n    }\r\n    TwoWayBindingBehavior = __decorate([\r\n        Object(aurelia_metadata__WEBPACK_IMPORTED_MODULE_8__[\"mixin\"])(modeBindingBehavior),\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('twoWay')\r\n    ], TwoWayBindingBehavior);\r\n    return TwoWayBindingBehavior;\r\n}());\n\nfunction throttle(newValue) {\r\n    var _this = this;\r\n    var state = this.throttleState;\r\n    var elapsed = +new Date() - state.last;\r\n    if (elapsed >= state.delay) {\r\n        clearTimeout(state.timeoutId);\r\n        state.timeoutId = null;\r\n        state.last = +new Date();\r\n        this.throttledMethod(newValue);\r\n        return;\r\n    }\r\n    state.newValue = newValue;\r\n    if (state.timeoutId === null) {\r\n        state.timeoutId = setTimeout(function () {\r\n            state.timeoutId = null;\r\n            state.last = +new Date();\r\n            _this.throttledMethod(state.newValue);\r\n        }, state.delay - elapsed);\r\n    }\r\n}\r\nvar ThrottleBindingBehavior = (function () {\r\n    function ThrottleBindingBehavior() {\r\n    }\r\n    ThrottleBindingBehavior.prototype.bind = function (binding, source, delay) {\r\n        if (delay === void 0) { delay = 200; }\r\n        var methodToThrottle = 'updateTarget';\r\n        if (binding.callSource) {\r\n            methodToThrottle = 'callSource';\r\n        }\r\n        else if (binding.updateSource && binding.mode === aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay) {\r\n            methodToThrottle = 'updateSource';\r\n        }\r\n        binding.throttledMethod = binding[methodToThrottle];\r\n        binding.throttledMethod.originalName = methodToThrottle;\r\n        binding[methodToThrottle] = throttle;\r\n        binding.throttleState = {\r\n            delay: delay,\r\n            last: 0,\r\n            timeoutId: null\r\n        };\r\n    };\r\n    ThrottleBindingBehavior.prototype.unbind = function (binding, source) {\r\n        var methodToRestore = binding.throttledMethod.originalName;\r\n        binding[methodToRestore] = binding.throttledMethod;\r\n        binding.throttledMethod = null;\r\n        clearTimeout(binding.throttleState.timeoutId);\r\n        binding.throttleState = null;\r\n    };\r\n    ThrottleBindingBehavior = __decorate([\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('throttle')\r\n    ], ThrottleBindingBehavior);\r\n    return ThrottleBindingBehavior;\r\n}());\n\nvar unset = {};\r\nfunction debounceCallSource(event) {\r\n    var _this = this;\r\n    var state = this.debounceState;\r\n    clearTimeout(state.timeoutId);\r\n    state.timeoutId = setTimeout(function () { return _this.debouncedMethod(event); }, state.delay);\r\n}\r\nfunction debounceCall(context, newValue, oldValue) {\r\n    var _this = this;\r\n    var state = this.debounceState;\r\n    clearTimeout(state.timeoutId);\r\n    if (context !== state.callContextToDebounce) {\r\n        state.oldValue = unset;\r\n        this.debouncedMethod(context, newValue, oldValue);\r\n        return;\r\n    }\r\n    if (state.oldValue === unset) {\r\n        state.oldValue = oldValue;\r\n    }\r\n    state.timeoutId = setTimeout(function () {\r\n        var _oldValue = state.oldValue;\r\n        state.oldValue = unset;\r\n        _this.debouncedMethod(context, newValue, _oldValue);\r\n    }, state.delay);\r\n}\r\nvar DebounceBindingBehavior = (function () {\r\n    function DebounceBindingBehavior() {\r\n    }\r\n    DebounceBindingBehavior.prototype.bind = function (binding, source, delay) {\r\n        if (delay === void 0) { delay = 200; }\r\n        var isCallSource = binding.callSource !== undefined;\r\n        var methodToDebounce = isCallSource ? 'callSource' : 'call';\r\n        var debouncer = isCallSource ? debounceCallSource : debounceCall;\r\n        var mode = binding.mode;\r\n        var callContextToDebounce = mode === aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay || mode === aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].fromView ? aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"targetContext\"] : aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"sourceContext\"];\r\n        binding.debouncedMethod = binding[methodToDebounce];\r\n        binding.debouncedMethod.originalName = methodToDebounce;\r\n        binding[methodToDebounce] = debouncer;\r\n        binding.debounceState = {\r\n            callContextToDebounce: callContextToDebounce,\r\n            delay: delay,\r\n            timeoutId: 0,\r\n            oldValue: unset\r\n        };\r\n    };\r\n    DebounceBindingBehavior.prototype.unbind = function (binding, source) {\r\n        var methodToRestore = binding.debouncedMethod.originalName;\r\n        binding[methodToRestore] = binding.debouncedMethod;\r\n        binding.debouncedMethod = null;\r\n        clearTimeout(binding.debounceState.timeoutId);\r\n        binding.debounceState = null;\r\n    };\r\n    DebounceBindingBehavior = __decorate([\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('debounce')\r\n    ], DebounceBindingBehavior);\r\n    return DebounceBindingBehavior;\r\n}());\n\nfunction findOriginalEventTarget(event) {\r\n    return (event.path && event.path[0]) || (event.deepPath && event.deepPath[0]) || event.target;\r\n}\r\nfunction handleSelfEvent(event) {\r\n    var target = findOriginalEventTarget(event);\r\n    if (this.target !== target) {\r\n        return;\r\n    }\r\n    this.selfEventCallSource(event);\r\n}\r\nvar SelfBindingBehavior = (function () {\r\n    function SelfBindingBehavior() {\r\n    }\r\n    SelfBindingBehavior.prototype.bind = function (binding, source) {\r\n        if (!binding.callSource || !binding.targetEvent) {\r\n            throw new Error('Self binding behavior only supports event.');\r\n        }\r\n        binding.selfEventCallSource = binding.callSource;\r\n        binding.callSource = handleSelfEvent;\r\n    };\r\n    SelfBindingBehavior.prototype.unbind = function (binding, source) {\r\n        binding.callSource = binding.selfEventCallSource;\r\n        binding.selfEventCallSource = null;\r\n    };\r\n    SelfBindingBehavior = __decorate([\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('self')\r\n    ], SelfBindingBehavior);\r\n    return SelfBindingBehavior;\r\n}());\n\nvar BindingSignaler = (function () {\r\n    function BindingSignaler() {\r\n        this.signals = {};\r\n    }\r\n    BindingSignaler.prototype.signal = function (name) {\r\n        var bindings = this.signals[name];\r\n        if (!bindings) {\r\n            return;\r\n        }\r\n        var i = bindings.length;\r\n        while (i--) {\r\n            bindings[i].call(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"sourceContext\"]);\r\n        }\r\n    };\r\n    return BindingSignaler;\r\n}());\n\nvar SignalBindingBehavior = (function () {\r\n    function SignalBindingBehavior(bindingSignaler) {\r\n        this.signals = bindingSignaler.signals;\r\n    }\r\n    SignalBindingBehavior.inject = function () { return [BindingSignaler]; };\r\n    SignalBindingBehavior.prototype.bind = function (binding, source) {\r\n        var names = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            names[_i - 2] = arguments[_i];\r\n        }\r\n        if (!binding.updateTarget) {\r\n            throw new Error('Only property bindings and string interpolation bindings can be signaled.  Trigger, delegate and call bindings cannot be signaled.');\r\n        }\r\n        var signals = this.signals;\r\n        if (names.length === 1) {\r\n            var name_1 = names[0];\r\n            var bindings = signals[name_1] || (signals[name_1] = []);\r\n            bindings.push(binding);\r\n            binding.signalName = name_1;\r\n        }\r\n        else if (names.length > 1) {\r\n            var i = names.length;\r\n            while (i--) {\r\n                var name_2 = names[i];\r\n                var bindings = signals[name_2] || (signals[name_2] = []);\r\n                bindings.push(binding);\r\n            }\r\n            binding.signalName = names;\r\n        }\r\n        else {\r\n            throw new Error('Signal name is required.');\r\n        }\r\n    };\r\n    SignalBindingBehavior.prototype.unbind = function (binding, source) {\r\n        var signals = this.signals;\r\n        var name = binding.signalName;\r\n        binding.signalName = null;\r\n        if (Array.isArray(name)) {\r\n            var names = name;\r\n            var i = names.length;\r\n            while (i--) {\r\n                var n = names[i];\r\n                var bindings = signals[n];\r\n                bindings.splice(bindings.indexOf(binding), 1);\r\n            }\r\n        }\r\n        else {\r\n            var bindings = signals[name];\r\n            bindings.splice(bindings.indexOf(binding), 1);\r\n        }\r\n    };\r\n    SignalBindingBehavior = __decorate([\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('signal')\r\n    ], SignalBindingBehavior);\r\n    return SignalBindingBehavior;\r\n}());\n\nvar eventNamesRequired = 'The updateTrigger binding behavior requires at least one event name argument: eg <input value.bind=\"firstName & updateTrigger:\\'blur\\'\">';\r\nvar notApplicableMessage = 'The updateTrigger binding behavior can only be applied to two-way/ from-view bindings on input/select elements.';\r\nvar UpdateTriggerBindingBehavior = (function () {\r\n    function UpdateTriggerBindingBehavior() {\r\n    }\r\n    UpdateTriggerBindingBehavior.prototype.bind = function (binding, source) {\r\n        var events = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            events[_i - 2] = arguments[_i];\r\n        }\r\n        if (events.length === 0) {\r\n            throw new Error(eventNamesRequired);\r\n        }\r\n        if (binding.mode !== aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].twoWay && binding.mode !== aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingMode\"].fromView) {\r\n            throw new Error(notApplicableMessage);\r\n        }\r\n        var targetObserver = binding.observerLocator.getObserver(binding.target, binding.targetProperty);\r\n        if (!targetObserver.handler) {\r\n            throw new Error(notApplicableMessage);\r\n        }\r\n        binding.targetObserver = targetObserver;\r\n        targetObserver.originalHandler = binding.targetObserver.handler;\r\n        var handler = new aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"EventSubscriber\"](events);\r\n        targetObserver.handler = handler;\r\n    };\r\n    UpdateTriggerBindingBehavior.prototype.unbind = function (binding, source) {\r\n        var targetObserver = binding.targetObserver;\r\n        targetObserver.handler.dispose();\r\n        targetObserver.handler = targetObserver.originalHandler;\r\n        targetObserver.originalHandler = null;\r\n    };\r\n    UpdateTriggerBindingBehavior = __decorate([\r\n        Object(aurelia_binding__WEBPACK_IMPORTED_MODULE_4__[\"bindingBehavior\"])('updateTrigger')\r\n    ], UpdateTriggerBindingBehavior);\r\n    return UpdateTriggerBindingBehavior;\r\n}());\n\nfunction _createDynamicElement(_a) {\r\n    var name = _a.name, viewUrl = _a.viewUrl, bindableNames = _a.bindableNames, useShadowDOMmode = _a.useShadowDOMmode;\r\n    var DynamicElement = (function () {\r\n        function DynamicElement() {\r\n        }\r\n        DynamicElement.prototype.bind = function (bindingContext) {\r\n            this.$parent = bindingContext;\r\n        };\r\n        DynamicElement = __decorate([\r\n            Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"customElement\"])(name),\r\n            Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useView\"])(viewUrl)\r\n        ], DynamicElement);\r\n        return DynamicElement;\r\n    }());\r\n    for (var i = 0, ii = bindableNames.length; i < ii; ++i) {\r\n        Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"bindable\"])(bindableNames[i])(DynamicElement);\r\n    }\r\n    switch (useShadowDOMmode) {\r\n        case 'open':\r\n            Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useShadowDOM\"])({ mode: 'open' })(DynamicElement);\r\n            break;\r\n        case 'closed':\r\n            Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useShadowDOM\"])({ mode: 'closed' })(DynamicElement);\r\n            break;\r\n        case '':\r\n            Object(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"useShadowDOM\"])(DynamicElement);\r\n            break;\r\n        case null:\r\n            break;\r\n        default:\r\n            Object(aurelia_logging__WEBPACK_IMPORTED_MODULE_5__[\"getLogger\"])('aurelia-html-only-element')\r\n                .warn(\"Expected 'use-shadow-dom' value to be \\\"close\\\", \\\"open\\\" or \\\"\\\", received \" + useShadowDOMmode);\r\n            break;\r\n    }\r\n    return DynamicElement;\r\n}\n\nfunction getElementName(address) {\r\n    return /([^\\/^\\?]+)\\.html/i.exec(address)[1].toLowerCase();\r\n}\r\nfunction configure(config) {\r\n    var viewEngine = config.container.get(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewEngine\"]);\r\n    var loader = config.aurelia.loader;\r\n    viewEngine.addResourcePlugin('.html', {\r\n        'fetch': function (viewUrl) {\r\n            return loader.loadTemplate(viewUrl).then(function (registryEntry) {\r\n                var _a;\r\n                var bindableNames = registryEntry.template.getAttribute('bindable');\r\n                var useShadowDOMmode = registryEntry.template.getAttribute('use-shadow-dom');\r\n                var name = getElementName(viewUrl);\r\n                if (bindableNames) {\r\n                    bindableNames = bindableNames.split(',').map(function (x) { return x.trim(); });\r\n                    registryEntry.template.removeAttribute('bindable');\r\n                }\r\n                else {\r\n                    bindableNames = [];\r\n                }\r\n                return _a = {}, _a[name] = _createDynamicElement({ name: name, viewUrl: viewUrl, bindableNames: bindableNames, useShadowDOMmode: useShadowDOMmode }), _a;\r\n            });\r\n        }\r\n    });\r\n}\n\nfunction configure$1(config) {\r\n    injectAureliaHideStyleAtHead();\r\n    config.globalResources(Compose, If, Else, With, Repeat, Show, Hide, Replaceable, Focus, SanitizeHTMLValueConverter, OneTimeBindingBehavior, OneWayBindingBehavior, ToViewBindingBehavior, FromViewBindingBehavior, TwoWayBindingBehavior, ThrottleBindingBehavior, DebounceBindingBehavior, SelfBindingBehavior, SignalBindingBehavior, UpdateTriggerBindingBehavior, AttrBindingBehavior);\r\n    configure(config);\r\n    var viewEngine = config.container.get(aurelia_templating__WEBPACK_IMPORTED_MODULE_3__[\"ViewEngine\"]);\r\n    var styleResourcePlugin = {\r\n        fetch: function (address) {\r\n            var _a;\r\n            return _a = {}, _a[address] = _createCSSResource(address), _a;\r\n        }\r\n    };\r\n    ['.css', '.less', '.sass', '.scss', '.styl'].forEach(function (ext) { return viewEngine.addResourcePlugin(ext, styleResourcePlugin); });\r\n}\n\n\n//# sourceMappingURL=aurelia-templating-resources.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9hdXJlbGlhLXRlbXBsYXRpbmctcmVzb3VyY2VzL2Rpc3QvbmF0aXZlLW1vZHVsZXMvYXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy5qcz9mY2YyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbnRhaW5lciwgaW5qZWN0LCBPcHRpb25hbCB9IGZyb20gJ2F1cmVsaWEtZGVwZW5kZW5jeS1pbmplY3Rpb24nO1xuaW1wb3J0IHsgRE9NLCBGRUFUVVJFIH0gZnJvbSAnYXVyZWxpYS1wYWwnO1xuaW1wb3J0IHsgVGFza1F1ZXVlIH0gZnJvbSAnYXVyZWxpYS10YXNrLXF1ZXVlJztcbmltcG9ydCB7IENvbXBvc2l0aW9uRW5naW5lLCBWaWV3U2xvdCwgVmlld1Jlc291cmNlcywgYmluZGFibGUsIG5vVmlldywgY3VzdG9tRWxlbWVudCwgY3VzdG9tQXR0cmlidXRlLCB0ZW1wbGF0ZUNvbnRyb2xsZXIsIEJvdW5kVmlld0ZhY3RvcnksIFRhcmdldEluc3RydWN0aW9uLCBBbmltYXRvciwgcmVzb3VyY2UsIHVzZVZpZXcsIHVzZVNoYWRvd0RPTSwgVmlld0VuZ2luZSB9IGZyb20gJ2F1cmVsaWEtdGVtcGxhdGluZyc7XG5pbXBvcnQgeyBjcmVhdGVPdmVycmlkZUNvbnRleHQsIGJpbmRpbmdNb2RlLCBCaW5kaW5nQmVoYXZpb3IsIFZhbHVlQ29udmVydGVyLCBzb3VyY2VDb250ZXh0LCBtZXJnZVNwbGljZSwgT2JzZXJ2ZXJMb2NhdG9yLCB2YWx1ZUNvbnZlcnRlciwgRGF0YUF0dHJpYnV0ZU9ic2VydmVyLCBiaW5kaW5nQmVoYXZpb3IsIHRhcmdldENvbnRleHQsIEV2ZW50U3Vic2NyaWJlciB9IGZyb20gJ2F1cmVsaWEtYmluZGluZyc7XG5pbXBvcnQgeyBnZXRMb2dnZXIgfSBmcm9tICdhdXJlbGlhLWxvZ2dpbmcnO1xuaW1wb3J0IHsgTG9hZGVyIH0gZnJvbSAnYXVyZWxpYS1sb2FkZXInO1xuaW1wb3J0IHsgcmVsYXRpdmVUb0ZpbGUgfSBmcm9tICdhdXJlbGlhLXBhdGgnO1xuaW1wb3J0IHsgbWl4aW4gfSBmcm9tICdhdXJlbGlhLW1ldGFkYXRhJztcblxuLyohICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXHJcbkNvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG5MaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpOyB5b3UgbWF5IG5vdCB1c2VcclxudGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGVcclxuTGljZW5zZSBhdCBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuXHJcblRISVMgQ09ERSBJUyBQUk9WSURFRCBPTiBBTiAqQVMgSVMqIEJBU0lTLCBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTllcclxuS0lORCwgRUlUSEVSIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIFdJVEhPVVQgTElNSVRBVElPTiBBTlkgSU1QTElFRFxyXG5XQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgVElUTEUsIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLFxyXG5NRVJDSEFOVEFCTElUWSBPUiBOT04tSU5GUklOR0VNRU5ULlxyXG5cclxuU2VlIHRoZSBBcGFjaGUgVmVyc2lvbiAyLjAgTGljZW5zZSBmb3Igc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zXHJcbmFuZCBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cclxuLyogZ2xvYmFsIFJlZmxlY3QsIFByb21pc2UgKi9cclxuXHJcbnZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24oZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxyXG4gICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcclxuICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxuXG52YXIgQWN0aXZhdGlvblN0cmF0ZWd5O1xyXG4oZnVuY3Rpb24gKEFjdGl2YXRpb25TdHJhdGVneSkge1xyXG4gICAgQWN0aXZhdGlvblN0cmF0ZWd5W1wiSW52b2tlTGlmZWN5Y2xlXCJdID0gXCJpbnZva2UtbGlmZWN5Y2xlXCI7XHJcbiAgICBBY3RpdmF0aW9uU3RyYXRlZ3lbXCJSZXBsYWNlXCJdID0gXCJyZXBsYWNlXCI7XHJcbn0pKEFjdGl2YXRpb25TdHJhdGVneSB8fCAoQWN0aXZhdGlvblN0cmF0ZWd5ID0ge30pKTtcclxudmFyIENvbXBvc2UgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQ29tcG9zZShlbGVtZW50LCBjb250YWluZXIsIGNvbXBvc2l0aW9uRW5naW5lLCB2aWV3U2xvdCwgdmlld1Jlc291cmNlcywgdGFza1F1ZXVlKSB7XHJcbiAgICAgICAgdGhpcy5hY3RpdmF0aW9uU3RyYXRlZ3kgPSBBY3RpdmF0aW9uU3RyYXRlZ3kuSW52b2tlTGlmZWN5Y2xlO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XHJcbiAgICAgICAgdGhpcy5jb21wb3NpdGlvbkVuZ2luZSA9IGNvbXBvc2l0aW9uRW5naW5lO1xyXG4gICAgICAgIHRoaXMudmlld1Nsb3QgPSB2aWV3U2xvdDtcclxuICAgICAgICB0aGlzLnZpZXdSZXNvdXJjZXMgPSB2aWV3UmVzb3VyY2VzO1xyXG4gICAgICAgIHRoaXMudGFza1F1ZXVlID0gdGFza1F1ZXVlO1xyXG4gICAgICAgIHRoaXMuY3VycmVudENvbnRyb2xsZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFZpZXdNb2RlbCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcclxuICAgIH1cclxuICAgIENvbXBvc2UuaW5qZWN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBbRE9NLkVsZW1lbnQsIENvbnRhaW5lciwgQ29tcG9zaXRpb25FbmdpbmUsIFZpZXdTbG90LCBWaWV3UmVzb3VyY2VzLCBUYXNrUXVldWVdO1xyXG4gICAgfTtcclxuICAgIENvbXBvc2UucHJvdG90eXBlLmNyZWF0ZWQgPSBmdW5jdGlvbiAob3duaW5nVmlldykge1xyXG4gICAgICAgIHRoaXMub3duaW5nVmlldyA9IG93bmluZ1ZpZXc7XHJcbiAgICB9O1xyXG4gICAgQ29tcG9zZS5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgdGhpcy5iaW5kaW5nQ29udGV4dCA9IGJpbmRpbmdDb250ZXh0O1xyXG4gICAgICAgIHRoaXMub3ZlcnJpZGVDb250ZXh0ID0gb3ZlcnJpZGVDb250ZXh0O1xyXG4gICAgICAgIHZhciBjaGFuZ2VzID0gdGhpcy5jaGFuZ2VzO1xyXG4gICAgICAgIGNoYW5nZXMudmlldyA9IHRoaXMudmlldztcclxuICAgICAgICBjaGFuZ2VzLnZpZXdNb2RlbCA9IHRoaXMudmlld01vZGVsO1xyXG4gICAgICAgIGNoYW5nZXMubW9kZWwgPSB0aGlzLm1vZGVsO1xyXG4gICAgICAgIGlmICghdGhpcy5wZW5kaW5nVGFzaykge1xyXG4gICAgICAgICAgICBwcm9jZXNzQ2hhbmdlcyh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgQ29tcG9zZS5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuY2hhbmdlcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XHJcbiAgICAgICAgdGhpcy5iaW5kaW5nQ29udGV4dCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5vdmVycmlkZUNvbnRleHQgPSBudWxsO1xyXG4gICAgICAgIHZhciByZXR1cm5Ub0NhY2hlID0gdHJ1ZTtcclxuICAgICAgICB2YXIgc2tpcEFuaW1hdGlvbiA9IHRydWU7XHJcbiAgICAgICAgdGhpcy52aWV3U2xvdC5yZW1vdmVBbGwocmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbik7XHJcbiAgICB9O1xyXG4gICAgQ29tcG9zZS5wcm90b3R5cGUubW9kZWxDaGFuZ2VkID0gZnVuY3Rpb24gKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xyXG4gICAgICAgIHRoaXMuY2hhbmdlcy5tb2RlbCA9IG5ld1ZhbHVlO1xyXG4gICAgICAgIHJlcXVlc3RVcGRhdGUodGhpcyk7XHJcbiAgICB9O1xyXG4gICAgQ29tcG9zZS5wcm90b3R5cGUudmlld0NoYW5nZWQgPSBmdW5jdGlvbiAobmV3VmFsdWUsIG9sZFZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VzLnZpZXcgPSBuZXdWYWx1ZTtcclxuICAgICAgICByZXF1ZXN0VXBkYXRlKHRoaXMpO1xyXG4gICAgfTtcclxuICAgIENvbXBvc2UucHJvdG90eXBlLnZpZXdNb2RlbENoYW5nZWQgPSBmdW5jdGlvbiAobmV3VmFsdWUsIG9sZFZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5jaGFuZ2VzLnZpZXdNb2RlbCA9IG5ld1ZhbHVlO1xyXG4gICAgICAgIHJlcXVlc3RVcGRhdGUodGhpcyk7XHJcbiAgICB9O1xyXG4gICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgYmluZGFibGVcclxuICAgIF0sIENvbXBvc2UucHJvdG90eXBlLCBcIm1vZGVsXCIsIHZvaWQgMCk7XHJcbiAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICBiaW5kYWJsZVxyXG4gICAgXSwgQ29tcG9zZS5wcm90b3R5cGUsIFwidmlld1wiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgYmluZGFibGVcclxuICAgIF0sIENvbXBvc2UucHJvdG90eXBlLCBcInZpZXdNb2RlbFwiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgYmluZGFibGVcclxuICAgIF0sIENvbXBvc2UucHJvdG90eXBlLCBcImFjdGl2YXRpb25TdHJhdGVneVwiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgYmluZGFibGVcclxuICAgIF0sIENvbXBvc2UucHJvdG90eXBlLCBcInN3YXBPcmRlclwiLCB2b2lkIDApO1xyXG4gICAgQ29tcG9zZSA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIG5vVmlldyxcclxuICAgICAgICBjdXN0b21FbGVtZW50KCdjb21wb3NlJylcclxuICAgIF0sIENvbXBvc2UpO1xyXG4gICAgcmV0dXJuIENvbXBvc2U7XHJcbn0oKSk7XHJcbmZ1bmN0aW9uIGlzRW1wdHkob2JqKSB7XHJcbiAgICBmb3IgKHZhciBfIGluIG9iaikge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG59XHJcbmZ1bmN0aW9uIHRyeUFjdGl2YXRlVmlld01vZGVsKHZtLCBtb2RlbCkge1xyXG4gICAgaWYgKHZtICYmIHR5cGVvZiB2bS5hY3RpdmF0ZSA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodm0uYWN0aXZhdGUobW9kZWwpKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBjcmVhdGVJbnN0cnVjdGlvbihjb21wb3NlciwgaW5zdHJ1Y3Rpb24pIHtcclxuICAgIHJldHVybiBPYmplY3QuYXNzaWduKGluc3RydWN0aW9uLCB7XHJcbiAgICAgICAgYmluZGluZ0NvbnRleHQ6IGNvbXBvc2VyLmJpbmRpbmdDb250ZXh0LFxyXG4gICAgICAgIG92ZXJyaWRlQ29udGV4dDogY29tcG9zZXIub3ZlcnJpZGVDb250ZXh0LFxyXG4gICAgICAgIG93bmluZ1ZpZXc6IGNvbXBvc2VyLm93bmluZ1ZpZXcsXHJcbiAgICAgICAgY29udGFpbmVyOiBjb21wb3Nlci5jb250YWluZXIsXHJcbiAgICAgICAgdmlld1Nsb3Q6IGNvbXBvc2VyLnZpZXdTbG90LFxyXG4gICAgICAgIHZpZXdSZXNvdXJjZXM6IGNvbXBvc2VyLnZpZXdSZXNvdXJjZXMsXHJcbiAgICAgICAgY3VycmVudENvbnRyb2xsZXI6IGNvbXBvc2VyLmN1cnJlbnRDb250cm9sbGVyLFxyXG4gICAgICAgIGhvc3Q6IGNvbXBvc2VyLmVsZW1lbnQsXHJcbiAgICAgICAgc3dhcE9yZGVyOiBjb21wb3Nlci5zd2FwT3JkZXJcclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIHByb2Nlc3NDaGFuZ2VzKGNvbXBvc2VyKSB7XHJcbiAgICB2YXIgY2hhbmdlcyA9IGNvbXBvc2VyLmNoYW5nZXM7XHJcbiAgICBjb21wb3Nlci5jaGFuZ2VzID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcclxuICAgIGlmIChuZWVkc1JlSW5pdGlhbGl6YXRpb24oY29tcG9zZXIsIGNoYW5nZXMpKSB7XHJcbiAgICAgICAgdmFyIGluc3RydWN0aW9uID0ge1xyXG4gICAgICAgICAgICB2aWV3OiBjb21wb3Nlci52aWV3LFxyXG4gICAgICAgICAgICB2aWV3TW9kZWw6IGNvbXBvc2VyLmN1cnJlbnRWaWV3TW9kZWwgfHwgY29tcG9zZXIudmlld01vZGVsLFxyXG4gICAgICAgICAgICBtb2RlbDogY29tcG9zZXIubW9kZWxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGluc3RydWN0aW9uID0gT2JqZWN0LmFzc2lnbihpbnN0cnVjdGlvbiwgY2hhbmdlcyk7XHJcbiAgICAgICAgaW5zdHJ1Y3Rpb24gPSBjcmVhdGVJbnN0cnVjdGlvbihjb21wb3NlciwgaW5zdHJ1Y3Rpb24pO1xyXG4gICAgICAgIGNvbXBvc2VyLnBlbmRpbmdUYXNrID0gY29tcG9zZXIuY29tcG9zaXRpb25FbmdpbmUuY29tcG9zZShpbnN0cnVjdGlvbikudGhlbihmdW5jdGlvbiAoY29udHJvbGxlcikge1xyXG4gICAgICAgICAgICBjb21wb3Nlci5jdXJyZW50Q29udHJvbGxlciA9IGNvbnRyb2xsZXI7XHJcbiAgICAgICAgICAgIGNvbXBvc2VyLmN1cnJlbnRWaWV3TW9kZWwgPSBjb250cm9sbGVyID8gY29udHJvbGxlci52aWV3TW9kZWwgOiBudWxsO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgY29tcG9zZXIucGVuZGluZ1Rhc2sgPSB0cnlBY3RpdmF0ZVZpZXdNb2RlbChjb21wb3Nlci5jdXJyZW50Vmlld01vZGVsLCBjaGFuZ2VzLm1vZGVsKTtcclxuICAgICAgICBpZiAoIWNvbXBvc2VyLnBlbmRpbmdUYXNrKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjb21wb3Nlci5wZW5kaW5nVGFzayA9IGNvbXBvc2VyLnBlbmRpbmdUYXNrXHJcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbXBsZXRlQ29tcG9zaXRpb25UYXNrKGNvbXBvc2VyKTtcclxuICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICBjb21wbGV0ZUNvbXBvc2l0aW9uVGFzayhjb21wb3Nlcik7XHJcbiAgICAgICAgdGhyb3cgcmVhc29uO1xyXG4gICAgfSk7XHJcbn1cclxuZnVuY3Rpb24gY29tcGxldGVDb21wb3NpdGlvblRhc2soY29tcG9zZXIpIHtcclxuICAgIGNvbXBvc2VyLnBlbmRpbmdUYXNrID0gbnVsbDtcclxuICAgIGlmICghaXNFbXB0eShjb21wb3Nlci5jaGFuZ2VzKSkge1xyXG4gICAgICAgIHByb2Nlc3NDaGFuZ2VzKGNvbXBvc2VyKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiByZXF1ZXN0VXBkYXRlKGNvbXBvc2VyKSB7XHJcbiAgICBpZiAoY29tcG9zZXIucGVuZGluZ1Rhc2sgfHwgY29tcG9zZXIudXBkYXRlUmVxdWVzdGVkKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29tcG9zZXIudXBkYXRlUmVxdWVzdGVkID0gdHJ1ZTtcclxuICAgIGNvbXBvc2VyLnRhc2tRdWV1ZS5xdWV1ZU1pY3JvVGFzayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29tcG9zZXIudXBkYXRlUmVxdWVzdGVkID0gZmFsc2U7XHJcbiAgICAgICAgcHJvY2Vzc0NoYW5nZXMoY29tcG9zZXIpO1xyXG4gICAgfSk7XHJcbn1cclxuZnVuY3Rpb24gbmVlZHNSZUluaXRpYWxpemF0aW9uKGNvbXBvc2VyLCBjaGFuZ2VzKSB7XHJcbiAgICB2YXIgYWN0aXZhdGlvblN0cmF0ZWd5ID0gY29tcG9zZXIuYWN0aXZhdGlvblN0cmF0ZWd5O1xyXG4gICAgdmFyIHZtID0gY29tcG9zZXIuY3VycmVudFZpZXdNb2RlbDtcclxuICAgIGlmICh2bSAmJiB0eXBlb2Ygdm0uZGV0ZXJtaW5lQWN0aXZhdGlvblN0cmF0ZWd5ID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgYWN0aXZhdGlvblN0cmF0ZWd5ID0gdm0uZGV0ZXJtaW5lQWN0aXZhdGlvblN0cmF0ZWd5KCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gJ3ZpZXcnIGluIGNoYW5nZXNcclxuICAgICAgICB8fCAndmlld01vZGVsJyBpbiBjaGFuZ2VzXHJcbiAgICAgICAgfHwgYWN0aXZhdGlvblN0cmF0ZWd5ID09PSBBY3RpdmF0aW9uU3RyYXRlZ3kuUmVwbGFjZTtcclxufVxuXG52YXIgSWZDb3JlID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIElmQ29yZSh2aWV3RmFjdG9yeSwgdmlld1Nsb3QpIHtcclxuICAgICAgICB0aGlzLnZpZXdGYWN0b3J5ID0gdmlld0ZhY3Rvcnk7XHJcbiAgICAgICAgdGhpcy52aWV3U2xvdCA9IHZpZXdTbG90O1xyXG4gICAgICAgIHRoaXMudmlldyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5iaW5kaW5nQ29udGV4dCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5vdmVycmlkZUNvbnRleHQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuc2hvd2luZyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuY2FjaGUgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgSWZDb3JlLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcclxuICAgICAgICB0aGlzLmJpbmRpbmdDb250ZXh0ID0gYmluZGluZ0NvbnRleHQ7XHJcbiAgICAgICAgdGhpcy5vdmVycmlkZUNvbnRleHQgPSBvdmVycmlkZUNvbnRleHQ7XHJcbiAgICB9O1xyXG4gICAgSWZDb3JlLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudmlldyA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudmlldy51bmJpbmQoKTtcclxuICAgICAgICBpZiAoIXRoaXMudmlld0ZhY3RvcnkuaXNDYWNoaW5nKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuc2hvd2luZykge1xyXG4gICAgICAgICAgICB0aGlzLnNob3dpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy52aWV3U2xvdC5yZW1vdmUodGhpcy52aWV3LCB0cnVlLCB0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudmlldy5yZXR1cm5Ub0NhY2hlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudmlldyA9IG51bGw7XHJcbiAgICB9O1xyXG4gICAgSWZDb3JlLnByb3RvdHlwZS5fc2hvdyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5zaG93aW5nKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy52aWV3LmlzQm91bmQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudmlldy5iaW5kKHRoaXMuYmluZGluZ0NvbnRleHQsIHRoaXMub3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnZpZXcgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy52aWV3ID0gdGhpcy52aWV3RmFjdG9yeS5jcmVhdGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLnZpZXcuaXNCb3VuZCkge1xyXG4gICAgICAgICAgICB0aGlzLnZpZXcuYmluZCh0aGlzLmJpbmRpbmdDb250ZXh0LCB0aGlzLm92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2hvd2luZyA9IHRydWU7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudmlld1Nsb3QuYWRkKHRoaXMudmlldyk7XHJcbiAgICB9O1xyXG4gICAgSWZDb3JlLnByb3RvdHlwZS5faGlkZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICghdGhpcy5zaG93aW5nKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zaG93aW5nID0gZmFsc2U7XHJcbiAgICAgICAgdmFyIHJlbW92ZWQgPSB0aGlzLnZpZXdTbG90LnJlbW92ZSh0aGlzLnZpZXcpO1xyXG4gICAgICAgIGlmIChyZW1vdmVkIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVtb3ZlZC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLl91bmJpbmRWaWV3KCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl91bmJpbmRWaWV3KCk7XHJcbiAgICB9O1xyXG4gICAgSWZDb3JlLnByb3RvdHlwZS5fdW5iaW5kVmlldyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgY2FjaGUgPSB0aGlzLmNhY2hlID09PSAnZmFsc2UnID8gZmFsc2UgOiAhIXRoaXMuY2FjaGU7XHJcbiAgICAgICAgdGhpcy52aWV3LnVuYmluZCgpO1xyXG4gICAgICAgIGlmICghY2FjaGUpIHtcclxuICAgICAgICAgICAgdGhpcy52aWV3ID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIElmQ29yZTtcclxufSgpKTtcblxudmFyIElmID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIF9fZXh0ZW5kcyhJZiwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIElmKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmNhY2hlID0gdHJ1ZTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBJZi5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5iaW5kLmNhbGwodGhpcywgYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgaWYgKHRoaXMuY29uZGl0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3Nob3coKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hpZGUoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSWYucHJvdG90eXBlLmNvbmRpdGlvbkNoYW5nZWQgPSBmdW5jdGlvbiAobmV3VmFsdWUpIHtcclxuICAgICAgICB0aGlzLl91cGRhdGUobmV3VmFsdWUpO1xyXG4gICAgfTtcclxuICAgIElmLnByb3RvdHlwZS5fdXBkYXRlID0gZnVuY3Rpb24gKHNob3cpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICh0aGlzLmFuaW1hdGluZykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBwcm9taXNlO1xyXG4gICAgICAgIGlmICh0aGlzLmVsc2VWbSkge1xyXG4gICAgICAgICAgICBwcm9taXNlID0gc2hvdyA/IHRoaXMuX3N3YXAodGhpcy5lbHNlVm0sIHRoaXMpIDogdGhpcy5fc3dhcCh0aGlzLCB0aGlzLmVsc2VWbSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwcm9taXNlID0gc2hvdyA/IHRoaXMuX3Nob3coKSA6IHRoaXMuX2hpZGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHByb21pc2UpIHtcclxuICAgICAgICAgICAgdGhpcy5hbmltYXRpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICBwcm9taXNlLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgX3RoaXMuYW5pbWF0aW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuY29uZGl0aW9uICE9PSBfdGhpcy5zaG93aW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX3VwZGF0ZShfdGhpcy5jb25kaXRpb24pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgSWYucHJvdG90eXBlLl9zd2FwID0gZnVuY3Rpb24gKHJlbW92ZSwgYWRkKSB7XHJcbiAgICAgICAgc3dpdGNoICh0aGlzLnN3YXBPcmRlcikge1xyXG4gICAgICAgICAgICBjYXNlICdiZWZvcmUnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShhZGQuX3Nob3coKSkudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiByZW1vdmUuX2hpZGUoKTsgfSk7XHJcbiAgICAgICAgICAgIGNhc2UgJ3dpdGgnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKFtyZW1vdmUuX2hpZGUoKSwgYWRkLl9zaG93KCldKTtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHZhciBwcm9taXNlID0gcmVtb3ZlLl9oaWRlKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZSA/IHByb21pc2UudGhlbihmdW5jdGlvbiAoKSB7IHJldHVybiBhZGQuX3Nob3coKTsgfSkgOiBhZGQuX3Nob3coKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgYmluZGFibGUoeyBwcmltYXJ5UHJvcGVydHk6IHRydWUgfSlcclxuICAgIF0sIElmLnByb3RvdHlwZSwgXCJjb25kaXRpb25cIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIGJpbmRhYmxlXHJcbiAgICBdLCBJZi5wcm90b3R5cGUsIFwic3dhcE9yZGVyXCIsIHZvaWQgMCk7XHJcbiAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICBiaW5kYWJsZVxyXG4gICAgXSwgSWYucHJvdG90eXBlLCBcImNhY2hlXCIsIHZvaWQgMCk7XHJcbiAgICBJZiA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIGN1c3RvbUF0dHJpYnV0ZSgnaWYnKSxcclxuICAgICAgICB0ZW1wbGF0ZUNvbnRyb2xsZXIsXHJcbiAgICAgICAgaW5qZWN0KEJvdW5kVmlld0ZhY3RvcnksIFZpZXdTbG90KVxyXG4gICAgXSwgSWYpO1xyXG4gICAgcmV0dXJuIElmO1xyXG59KElmQ29yZSkpO1xuXG52YXIgRWxzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoRWxzZSwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEVsc2Uodmlld0ZhY3RvcnksIHZpZXdTbG90KSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgdmlld0ZhY3RvcnksIHZpZXdTbG90KSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLl9yZWdpc3RlckluSWYoKTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBFbHNlLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcclxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmJpbmQuY2FsbCh0aGlzLCBiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICBpZiAodGhpcy5pZlZtLmNvbmRpdGlvbikge1xyXG4gICAgICAgICAgICB0aGlzLl9oaWRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9zaG93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEVsc2UucHJvdG90eXBlLl9yZWdpc3RlckluSWYgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIHByZXZpb3VzID0gdGhpcy52aWV3U2xvdC5hbmNob3IucHJldmlvdXNTaWJsaW5nO1xyXG4gICAgICAgIHdoaWxlIChwcmV2aW91cyAmJiAhcHJldmlvdXMuYXUpIHtcclxuICAgICAgICAgICAgcHJldmlvdXMgPSBwcmV2aW91cy5wcmV2aW91c1NpYmxpbmc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghcHJldmlvdXMgfHwgIXByZXZpb3VzLmF1LmlmKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbid0IGZpbmQgbWF0Y2hpbmcgSWYgZm9yIEVsc2UgY3VzdG9tIGF0dHJpYnV0ZS5cIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaWZWbSA9IHByZXZpb3VzLmF1LmlmLnZpZXdNb2RlbDtcclxuICAgICAgICB0aGlzLmlmVm0uZWxzZVZtID0gdGhpcztcclxuICAgIH07XHJcbiAgICBFbHNlID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgY3VzdG9tQXR0cmlidXRlKCdlbHNlJyksXHJcbiAgICAgICAgdGVtcGxhdGVDb250cm9sbGVyLFxyXG4gICAgICAgIGluamVjdChCb3VuZFZpZXdGYWN0b3J5LCBWaWV3U2xvdClcclxuICAgIF0sIEVsc2UpO1xyXG4gICAgcmV0dXJuIEVsc2U7XHJcbn0oSWZDb3JlKSk7XG5cbnZhciBXaXRoID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFdpdGgodmlld0ZhY3RvcnksIHZpZXdTbG90KSB7XHJcbiAgICAgICAgdGhpcy52aWV3RmFjdG9yeSA9IHZpZXdGYWN0b3J5O1xyXG4gICAgICAgIHRoaXMudmlld1Nsb3QgPSB2aWV3U2xvdDtcclxuICAgICAgICB0aGlzLnBhcmVudE92ZXJyaWRlQ29udGV4dCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy52aWV3ID0gbnVsbDtcclxuICAgIH1cclxuICAgIFdpdGgucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAoYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCkge1xyXG4gICAgICAgIHRoaXMucGFyZW50T3ZlcnJpZGVDb250ZXh0ID0gb3ZlcnJpZGVDb250ZXh0O1xyXG4gICAgICAgIHRoaXMudmFsdWVDaGFuZ2VkKHRoaXMudmFsdWUpO1xyXG4gICAgfTtcclxuICAgIFdpdGgucHJvdG90eXBlLnZhbHVlQ2hhbmdlZCA9IGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xyXG4gICAgICAgIHZhciBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVPdmVycmlkZUNvbnRleHQobmV3VmFsdWUsIHRoaXMucGFyZW50T3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlldztcclxuICAgICAgICBpZiAoIXZpZXcpIHtcclxuICAgICAgICAgICAgdmlldyA9IHRoaXMudmlldyA9IHRoaXMudmlld0ZhY3RvcnkuY3JlYXRlKCk7XHJcbiAgICAgICAgICAgIHZpZXcuYmluZChuZXdWYWx1ZSwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICAgICAgdGhpcy52aWV3U2xvdC5hZGQodmlldyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2aWV3LmJpbmQobmV3VmFsdWUsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFdpdGgucHJvdG90eXBlLnVuYmluZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlldztcclxuICAgICAgICB0aGlzLnBhcmVudE92ZXJyaWRlQ29udGV4dCA9IG51bGw7XHJcbiAgICAgICAgaWYgKHZpZXcpIHtcclxuICAgICAgICAgICAgdmlldy51bmJpbmQoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgV2l0aCA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIGN1c3RvbUF0dHJpYnV0ZSgnd2l0aCcpLFxyXG4gICAgICAgIHRlbXBsYXRlQ29udHJvbGxlcixcclxuICAgICAgICBpbmplY3QoQm91bmRWaWV3RmFjdG9yeSwgVmlld1Nsb3QpXHJcbiAgICBdLCBXaXRoKTtcclxuICAgIHJldHVybiBXaXRoO1xyXG59KCkpO1xuXG52YXIgb25lVGltZSA9IGJpbmRpbmdNb2RlLm9uZVRpbWU7XHJcbmZ1bmN0aW9uIHVwZGF0ZU92ZXJyaWRlQ29udGV4dHModmlld3MsIHN0YXJ0SW5kZXgpIHtcclxuICAgIHZhciBsZW5ndGggPSB2aWV3cy5sZW5ndGg7XHJcbiAgICBpZiAoc3RhcnRJbmRleCA+IDApIHtcclxuICAgICAgICBzdGFydEluZGV4ID0gc3RhcnRJbmRleCAtIDE7XHJcbiAgICB9XHJcbiAgICBmb3IgKDsgc3RhcnRJbmRleCA8IGxlbmd0aDsgKytzdGFydEluZGV4KSB7XHJcbiAgICAgICAgdXBkYXRlT3ZlcnJpZGVDb250ZXh0KHZpZXdzW3N0YXJ0SW5kZXhdLm92ZXJyaWRlQ29udGV4dCwgc3RhcnRJbmRleCwgbGVuZ3RoKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBjcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KHJlcGVhdCwgZGF0YSwgaW5kZXgsIGxlbmd0aCwga2V5KSB7XHJcbiAgICB2YXIgYmluZGluZ0NvbnRleHQgPSB7fTtcclxuICAgIHZhciBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVPdmVycmlkZUNvbnRleHQoYmluZGluZ0NvbnRleHQsIHJlcGVhdC5zY29wZS5vdmVycmlkZUNvbnRleHQpO1xyXG4gICAgaWYgKHR5cGVvZiBrZXkgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgYmluZGluZ0NvbnRleHRbcmVwZWF0LmtleV0gPSBrZXk7XHJcbiAgICAgICAgYmluZGluZ0NvbnRleHRbcmVwZWF0LnZhbHVlXSA9IGRhdGE7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBiaW5kaW5nQ29udGV4dFtyZXBlYXQubG9jYWxdID0gZGF0YTtcclxuICAgIH1cclxuICAgIHVwZGF0ZU92ZXJyaWRlQ29udGV4dChvdmVycmlkZUNvbnRleHQsIGluZGV4LCBsZW5ndGgpO1xyXG4gICAgcmV0dXJuIG92ZXJyaWRlQ29udGV4dDtcclxufVxyXG5mdW5jdGlvbiB1cGRhdGVPdmVycmlkZUNvbnRleHQob3ZlcnJpZGVDb250ZXh0LCBpbmRleCwgbGVuZ3RoKSB7XHJcbiAgICB2YXIgZmlyc3QgPSAoaW5kZXggPT09IDApO1xyXG4gICAgdmFyIGxhc3QgPSAoaW5kZXggPT09IGxlbmd0aCAtIDEpO1xyXG4gICAgdmFyIGV2ZW4gPSBpbmRleCAlIDIgPT09IDA7XHJcbiAgICBvdmVycmlkZUNvbnRleHQuJGluZGV4ID0gaW5kZXg7XHJcbiAgICBvdmVycmlkZUNvbnRleHQuJGZpcnN0ID0gZmlyc3Q7XHJcbiAgICBvdmVycmlkZUNvbnRleHQuJGxhc3QgPSBsYXN0O1xyXG4gICAgb3ZlcnJpZGVDb250ZXh0LiRtaWRkbGUgPSAhKGZpcnN0IHx8IGxhc3QpO1xyXG4gICAgb3ZlcnJpZGVDb250ZXh0LiRvZGQgPSAhZXZlbjtcclxuICAgIG92ZXJyaWRlQ29udGV4dC4kZXZlbiA9IGV2ZW47XHJcbn1cclxuZnVuY3Rpb24gZ2V0SXRlbXNTb3VyY2VFeHByZXNzaW9uKGluc3RydWN0aW9uLCBhdHRyTmFtZSkge1xyXG4gICAgcmV0dXJuIGluc3RydWN0aW9uLmJlaGF2aW9ySW5zdHJ1Y3Rpb25zXHJcbiAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoYmkpIHsgcmV0dXJuIGJpLm9yaWdpbmFsQXR0ck5hbWUgPT09IGF0dHJOYW1lOyB9KVswXVxyXG4gICAgICAgIC5hdHRyaWJ1dGVzXHJcbiAgICAgICAgLml0ZW1zXHJcbiAgICAgICAgLnNvdXJjZUV4cHJlc3Npb247XHJcbn1cclxuZnVuY3Rpb24gdW53cmFwRXhwcmVzc2lvbihleHByZXNzaW9uKSB7XHJcbiAgICB2YXIgdW53cmFwcGVkID0gZmFsc2U7XHJcbiAgICB3aGlsZSAoZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEJpbmRpbmdCZWhhdmlvcikge1xyXG4gICAgICAgIGV4cHJlc3Npb24gPSBleHByZXNzaW9uLmV4cHJlc3Npb247XHJcbiAgICB9XHJcbiAgICB3aGlsZSAoZXhwcmVzc2lvbiBpbnN0YW5jZW9mIFZhbHVlQ29udmVydGVyKSB7XHJcbiAgICAgICAgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb24uZXhwcmVzc2lvbjtcclxuICAgICAgICB1bndyYXBwZWQgPSB0cnVlO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHVud3JhcHBlZCA/IGV4cHJlc3Npb24gOiBudWxsO1xyXG59XHJcbmZ1bmN0aW9uIGlzT25lVGltZShleHByZXNzaW9uKSB7XHJcbiAgICB3aGlsZSAoZXhwcmVzc2lvbiBpbnN0YW5jZW9mIEJpbmRpbmdCZWhhdmlvcikge1xyXG4gICAgICAgIGlmIChleHByZXNzaW9uLm5hbWUgPT09ICdvbmVUaW1lJykge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb24uZXhwcmVzc2lvbjtcclxuICAgIH1cclxuICAgIHJldHVybiBmYWxzZTtcclxufVxyXG5mdW5jdGlvbiB1cGRhdGVPbmVUaW1lQmluZGluZyhiaW5kaW5nKSB7XHJcbiAgICBpZiAoYmluZGluZy5jYWxsICYmIGJpbmRpbmcubW9kZSA9PT0gb25lVGltZSkge1xyXG4gICAgICAgIGJpbmRpbmcuY2FsbChzb3VyY2VDb250ZXh0KTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGJpbmRpbmcudXBkYXRlT25lVGltZUJpbmRpbmdzKSB7XHJcbiAgICAgICAgYmluZGluZy51cGRhdGVPbmVUaW1lQmluZGluZ3MoKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBpbmRleE9mKGFycmF5LCBpdGVtLCBtYXRjaGVyLCBzdGFydEluZGV4KSB7XHJcbiAgICBpZiAoIW1hdGNoZXIpIHtcclxuICAgICAgICByZXR1cm4gYXJyYXkuaW5kZXhPZihpdGVtKTtcclxuICAgIH1cclxuICAgIHZhciBsZW5ndGggPSBhcnJheS5sZW5ndGg7XHJcbiAgICBmb3IgKHZhciBpbmRleCA9IHN0YXJ0SW5kZXggfHwgMDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KyspIHtcclxuICAgICAgICBpZiAobWF0Y2hlcihhcnJheVtpbmRleF0sIGl0ZW0pKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbmRleDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gLTE7XHJcbn1cblxudmFyIEFycmF5UmVwZWF0U3RyYXRlZ3kgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQXJyYXlSZXBlYXRTdHJhdGVneSgpIHtcclxuICAgIH1cclxuICAgIEFycmF5UmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmdldENvbGxlY3Rpb25PYnNlcnZlciA9IGZ1bmN0aW9uIChvYnNlcnZlckxvY2F0b3IsIGl0ZW1zKSB7XHJcbiAgICAgICAgcmV0dXJuIG9ic2VydmVyTG9jYXRvci5nZXRBcnJheU9ic2VydmVyKGl0ZW1zKTtcclxuICAgIH07XHJcbiAgICBBcnJheVJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5pbnN0YW5jZUNoYW5nZWQgPSBmdW5jdGlvbiAocmVwZWF0LCBpdGVtcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyICRyZXBlYXQgPSByZXBlYXQ7XHJcbiAgICAgICAgdmFyIGl0ZW1zTGVuZ3RoID0gaXRlbXMubGVuZ3RoO1xyXG4gICAgICAgIGlmICghaXRlbXMgfHwgaXRlbXNMZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgJHJlcGVhdC5yZW1vdmVBbGxWaWV3cyh0cnVlLCAhJHJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBjaGlsZHJlbiA9ICRyZXBlYXQudmlld3MoKTtcclxuICAgICAgICB2YXIgdmlld3NMZW5ndGggPSBjaGlsZHJlbi5sZW5ndGg7XHJcbiAgICAgICAgaWYgKHZpZXdzTGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3N0YW5kYXJkUHJvY2Vzc0luc3RhbmNlQ2hhbmdlZCgkcmVwZWF0LCBpdGVtcyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCRyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKSB7XHJcbiAgICAgICAgICAgIHZhciBjaGlsZHJlblNuYXBzaG90ID0gY2hpbGRyZW4uc2xpY2UoMCk7XHJcbiAgICAgICAgICAgIHZhciBpdGVtTmFtZUluQmluZGluZ0NvbnRleHQgPSAkcmVwZWF0LmxvY2FsO1xyXG4gICAgICAgICAgICB2YXIgbWF0Y2hlcl8xID0gJHJlcGVhdC5tYXRjaGVyKCk7XHJcbiAgICAgICAgICAgIHZhciBpdGVtc1ByZXZpb3VzbHlJblZpZXdzXzEgPSBbXTtcclxuICAgICAgICAgICAgdmFyIHZpZXdzVG9SZW1vdmUgPSBbXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IHZpZXdzTGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmlldyA9IGNoaWxkcmVuU25hcHNob3RbaW5kZXhdO1xyXG4gICAgICAgICAgICAgICAgdmFyIG9sZEl0ZW0gPSB2aWV3LmJpbmRpbmdDb250ZXh0W2l0ZW1OYW1lSW5CaW5kaW5nQ29udGV4dF07XHJcbiAgICAgICAgICAgICAgICBpZiAoaW5kZXhPZihpdGVtcywgb2xkSXRlbSwgbWF0Y2hlcl8xKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICB2aWV3c1RvUmVtb3ZlLnB1c2godmlldyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpdGVtc1ByZXZpb3VzbHlJblZpZXdzXzEucHVzaChvbGRJdGVtKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgdXBkYXRlVmlld3MgPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHZhciByZW1vdmVQcm9taXNlID0gdm9pZCAwO1xyXG4gICAgICAgICAgICBpZiAoaXRlbXNQcmV2aW91c2x5SW5WaWV3c18xLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHJlbW92ZVByb21pc2UgPSAkcmVwZWF0LnJlbW92ZVZpZXdzKHZpZXdzVG9SZW1vdmUsIHRydWUsICEkcmVwZWF0LnZpZXdzUmVxdWlyZUxpZmVjeWNsZSk7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVWaWV3cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgaXRlbXNMZW5ndGg7IGluZGV4KyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBpdGVtc1tpbmRleF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRleE9mVmlldyA9IGluZGV4T2YoaXRlbXNQcmV2aW91c2x5SW5WaWV3c18xLCBpdGVtLCBtYXRjaGVyXzEsIGluZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZpZXcgPSB2b2lkIDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmRleE9mVmlldyA9PT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KCRyZXBlYXQsIGl0ZW1zW2luZGV4XSwgaW5kZXgsIGl0ZW1zTGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZXBlYXQuaW5zZXJ0VmlldyhpbmRleCwgb3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNQcmV2aW91c2x5SW5WaWV3c18xLnNwbGljZShpbmRleCwgMCwgdW5kZWZpbmVkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpbmRleE9mVmlldyA9PT0gaW5kZXgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXcgPSBjaGlsZHJlbltpbmRleE9mVmlld107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtc1ByZXZpb3VzbHlJblZpZXdzXzFbaW5kZXhPZlZpZXddID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlldyA9IGNoaWxkcmVuW2luZGV4T2ZWaWV3XTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyZXBlYXQubW92ZVZpZXcoaW5kZXhPZlZpZXcsIGluZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zUHJldmlvdXNseUluVmlld3NfMS5zcGxpY2UoaW5kZXhPZlZpZXcsIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXNQcmV2aW91c2x5SW5WaWV3c18xLnNwbGljZShpbmRleCwgMCwgdW5kZWZpbmVkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlldykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlT3ZlcnJpZGVDb250ZXh0KHZpZXcub3ZlcnJpZGVDb250ZXh0LCBpbmRleCwgaXRlbXNMZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9pblBsYWNlUHJvY2Vzc0l0ZW1zKCRyZXBlYXQsIGl0ZW1zKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVQcm9taXNlID0gJHJlcGVhdC5yZW1vdmVBbGxWaWV3cyh0cnVlLCAhJHJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlVmlld3MgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5fc3RhbmRhcmRQcm9jZXNzSW5zdGFuY2VDaGFuZ2VkKCRyZXBlYXQsIGl0ZW1zKTsgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocmVtb3ZlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgICAgIHJlbW92ZVByb21pc2UudGhlbih1cGRhdGVWaWV3cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVWaWV3cygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9pblBsYWNlUHJvY2Vzc0l0ZW1zKCRyZXBlYXQsIGl0ZW1zKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgQXJyYXlSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuX3N0YW5kYXJkUHJvY2Vzc0luc3RhbmNlQ2hhbmdlZCA9IGZ1bmN0aW9uIChyZXBlYXQsIGl0ZW1zKSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gaXRlbXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgb3ZlcnJpZGVDb250ZXh0ID0gY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dChyZXBlYXQsIGl0ZW1zW2ldLCBpLCBpaSk7XHJcbiAgICAgICAgICAgIHJlcGVhdC5hZGRWaWV3KG92ZXJyaWRlQ29udGV4dC5iaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgQXJyYXlSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuX2luUGxhY2VQcm9jZXNzSXRlbXMgPSBmdW5jdGlvbiAocmVwZWF0LCBpdGVtcykge1xyXG4gICAgICAgIHZhciBpdGVtc0xlbmd0aCA9IGl0ZW1zLmxlbmd0aDtcclxuICAgICAgICB2YXIgdmlld3NMZW5ndGggPSByZXBlYXQudmlld0NvdW50KCk7XHJcbiAgICAgICAgd2hpbGUgKHZpZXdzTGVuZ3RoID4gaXRlbXNMZW5ndGgpIHtcclxuICAgICAgICAgICAgdmlld3NMZW5ndGgtLTtcclxuICAgICAgICAgICAgcmVwZWF0LnJlbW92ZVZpZXcodmlld3NMZW5ndGgsIHRydWUsICFyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGxvY2FsID0gcmVwZWF0LmxvY2FsO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdmlld3NMZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgdmlldyA9IHJlcGVhdC52aWV3KGkpO1xyXG4gICAgICAgICAgICB2YXIgbGFzdCA9IGkgPT09IGl0ZW1zTGVuZ3RoIC0gMTtcclxuICAgICAgICAgICAgdmFyIG1pZGRsZSA9IGkgIT09IDAgJiYgIWxhc3Q7XHJcbiAgICAgICAgICAgIHZhciBiaW5kaW5nQ29udGV4dCA9IHZpZXcuYmluZGluZ0NvbnRleHQ7XHJcbiAgICAgICAgICAgIHZhciBvdmVycmlkZUNvbnRleHQgPSB2aWV3Lm92ZXJyaWRlQ29udGV4dDtcclxuICAgICAgICAgICAgaWYgKGJpbmRpbmdDb250ZXh0W2xvY2FsXSA9PT0gaXRlbXNbaV1cclxuICAgICAgICAgICAgICAgICYmIG92ZXJyaWRlQ29udGV4dC4kbWlkZGxlID09PSBtaWRkbGVcclxuICAgICAgICAgICAgICAgICYmIG92ZXJyaWRlQ29udGV4dC4kbGFzdCA9PT0gbGFzdCkge1xyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYmluZGluZ0NvbnRleHRbbG9jYWxdID0gaXRlbXNbaV07XHJcbiAgICAgICAgICAgIG92ZXJyaWRlQ29udGV4dC4kbWlkZGxlID0gbWlkZGxlO1xyXG4gICAgICAgICAgICBvdmVycmlkZUNvbnRleHQuJGxhc3QgPSBsYXN0O1xyXG4gICAgICAgICAgICByZXBlYXQudXBkYXRlQmluZGluZ3Modmlldyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAodmFyIGkgPSB2aWV3c0xlbmd0aDsgaSA8IGl0ZW1zTGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIG92ZXJyaWRlQ29udGV4dCA9IGNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQocmVwZWF0LCBpdGVtc1tpXSwgaSwgaXRlbXNMZW5ndGgpO1xyXG4gICAgICAgICAgICByZXBlYXQuYWRkVmlldyhvdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEFycmF5UmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmluc3RhbmNlTXV0YXRlZCA9IGZ1bmN0aW9uIChyZXBlYXQsIGFycmF5LCBzcGxpY2VzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAocmVwZWF0Ll9fcXVldWVkU3BsaWNlcykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBzcGxpY2VzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHZhciBfYSA9IHNwbGljZXNbaV0sIGluZGV4ID0gX2EuaW5kZXgsIHJlbW92ZWQgPSBfYS5yZW1vdmVkLCBhZGRlZENvdW50ID0gX2EuYWRkZWRDb3VudDtcclxuICAgICAgICAgICAgICAgIG1lcmdlU3BsaWNlKHJlcGVhdC5fX3F1ZXVlZFNwbGljZXMsIGluZGV4LCByZW1vdmVkLCBhZGRlZENvdW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXBlYXQuX19hcnJheSA9IGFycmF5LnNsaWNlKDApO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBtYXliZVByb21pc2UgPSB0aGlzLl9ydW5TcGxpY2VzKHJlcGVhdCwgYXJyYXkuc2xpY2UoMCksIHNwbGljZXMpO1xyXG4gICAgICAgIGlmIChtYXliZVByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcbiAgICAgICAgICAgIHZhciBxdWV1ZWRTcGxpY2VzXzEgPSByZXBlYXQuX19xdWV1ZWRTcGxpY2VzID0gW107XHJcbiAgICAgICAgICAgIHZhciBydW5RdWV1ZWRTcGxpY2VzXzEgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXF1ZXVlZFNwbGljZXNfMS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXBlYXQuX19xdWV1ZWRTcGxpY2VzID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcGVhdC5fX2FycmF5ID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBuZXh0UHJvbWlzZSA9IF90aGlzLl9ydW5TcGxpY2VzKHJlcGVhdCwgcmVwZWF0Ll9fYXJyYXksIHF1ZXVlZFNwbGljZXNfMSkgfHwgUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICBxdWV1ZWRTcGxpY2VzXzEgPSByZXBlYXQuX19xdWV1ZWRTcGxpY2VzID0gW107XHJcbiAgICAgICAgICAgICAgICBuZXh0UHJvbWlzZS50aGVuKHJ1blF1ZXVlZFNwbGljZXNfMSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIG1heWJlUHJvbWlzZS50aGVuKHJ1blF1ZXVlZFNwbGljZXNfMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEFycmF5UmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLl9ydW5TcGxpY2VzID0gZnVuY3Rpb24gKHJlcGVhdCwgYXJyYXksIHNwbGljZXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciByZW1vdmVEZWx0YSA9IDA7XHJcbiAgICAgICAgdmFyIHJtUHJvbWlzZXMgPSBbXTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBzcGxpY2VzLmxlbmd0aDsgaSA8IGlpOyArK2kpIHtcclxuICAgICAgICAgICAgdmFyIHNwbGljZSA9IHNwbGljZXNbaV07XHJcbiAgICAgICAgICAgIHZhciByZW1vdmVkID0gc3BsaWNlLnJlbW92ZWQ7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwLCBqaiA9IHJlbW92ZWQubGVuZ3RoOyBqIDwgamo7ICsraikge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZpZXdPclByb21pc2UgPSByZXBlYXQucmVtb3ZlVmlldyhzcGxpY2UuaW5kZXggKyByZW1vdmVEZWx0YSArIHJtUHJvbWlzZXMubGVuZ3RoLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIGlmICh2aWV3T3JQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJtUHJvbWlzZXMucHVzaCh2aWV3T3JQcm9taXNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZW1vdmVEZWx0YSAtPSBzcGxpY2UuYWRkZWRDb3VudDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHJtUHJvbWlzZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwocm1Qcm9taXNlcykudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3BsaWNlSW5kZXhMb3cgPSBfdGhpcy5faGFuZGxlQWRkZWRTcGxpY2VzKHJlcGVhdCwgYXJyYXksIHNwbGljZXMpO1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlT3ZlcnJpZGVDb250ZXh0cyhyZXBlYXQudmlld3MoKSwgc3BsaWNlSW5kZXhMb3cpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHNwbGljZUluZGV4TG93ID0gdGhpcy5faGFuZGxlQWRkZWRTcGxpY2VzKHJlcGVhdCwgYXJyYXksIHNwbGljZXMpO1xyXG4gICAgICAgIHVwZGF0ZU92ZXJyaWRlQ29udGV4dHMocmVwZWF0LnZpZXdzKCksIHNwbGljZUluZGV4TG93KTtcclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfTtcclxuICAgIEFycmF5UmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLl9oYW5kbGVBZGRlZFNwbGljZXMgPSBmdW5jdGlvbiAocmVwZWF0LCBhcnJheSwgc3BsaWNlcykge1xyXG4gICAgICAgIHZhciBzcGxpY2VJbmRleDtcclxuICAgICAgICB2YXIgc3BsaWNlSW5kZXhMb3c7XHJcbiAgICAgICAgdmFyIGFycmF5TGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBpaSA9IHNwbGljZXMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xyXG4gICAgICAgICAgICB2YXIgc3BsaWNlID0gc3BsaWNlc1tpXTtcclxuICAgICAgICAgICAgdmFyIGFkZEluZGV4ID0gc3BsaWNlSW5kZXggPSBzcGxpY2UuaW5kZXg7XHJcbiAgICAgICAgICAgIHZhciBlbmQgPSBzcGxpY2UuaW5kZXggKyBzcGxpY2UuYWRkZWRDb3VudDtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBzcGxpY2VJbmRleExvdyA9PT0gJ3VuZGVmaW5lZCcgfHwgc3BsaWNlSW5kZXhMb3cgPT09IG51bGwgfHwgc3BsaWNlSW5kZXhMb3cgPiBzcGxpY2UuaW5kZXgpIHtcclxuICAgICAgICAgICAgICAgIHNwbGljZUluZGV4TG93ID0gc3BsaWNlSW5kZXg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yICg7IGFkZEluZGV4IDwgZW5kOyArK2FkZEluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgb3ZlcnJpZGVDb250ZXh0ID0gY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dChyZXBlYXQsIGFycmF5W2FkZEluZGV4XSwgYWRkSW5kZXgsIGFycmF5TGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgIHJlcGVhdC5pbnNlcnRWaWV3KGFkZEluZGV4LCBvdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHNwbGljZUluZGV4TG93O1xyXG4gICAgfTtcclxuICAgIHJldHVybiBBcnJheVJlcGVhdFN0cmF0ZWd5O1xyXG59KCkpO1xuXG52YXIgTWFwUmVwZWF0U3RyYXRlZ3kgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTWFwUmVwZWF0U3RyYXRlZ3koKSB7XHJcbiAgICB9XHJcbiAgICBNYXBSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuZ2V0Q29sbGVjdGlvbk9ic2VydmVyID0gZnVuY3Rpb24gKG9ic2VydmVyTG9jYXRvciwgaXRlbXMpIHtcclxuICAgICAgICByZXR1cm4gb2JzZXJ2ZXJMb2NhdG9yLmdldE1hcE9ic2VydmVyKGl0ZW1zKTtcclxuICAgIH07XHJcbiAgICBNYXBSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuaW5zdGFuY2VDaGFuZ2VkID0gZnVuY3Rpb24gKHJlcGVhdCwgaXRlbXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciByZW1vdmVQcm9taXNlID0gcmVwZWF0LnJlbW92ZUFsbFZpZXdzKHRydWUsICFyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICBpZiAocmVtb3ZlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgcmVtb3ZlUHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLl9zdGFuZGFyZFByb2Nlc3NJdGVtcyhyZXBlYXQsIGl0ZW1zKTsgfSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fc3RhbmRhcmRQcm9jZXNzSXRlbXMocmVwZWF0LCBpdGVtcyk7XHJcbiAgICB9O1xyXG4gICAgTWFwUmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLl9zdGFuZGFyZFByb2Nlc3NJdGVtcyA9IGZ1bmN0aW9uIChyZXBlYXQsIGl0ZW1zKSB7XHJcbiAgICAgICAgdmFyIGluZGV4ID0gMDtcclxuICAgICAgICB2YXIgb3ZlcnJpZGVDb250ZXh0O1xyXG4gICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcclxuICAgICAgICAgICAgb3ZlcnJpZGVDb250ZXh0ID0gY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dChyZXBlYXQsIHZhbHVlLCBpbmRleCwgaXRlbXMuc2l6ZSwga2V5KTtcclxuICAgICAgICAgICAgcmVwZWF0LmFkZFZpZXcob3ZlcnJpZGVDb250ZXh0LmJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgICAgICArK2luZGV4O1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIE1hcFJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5pbnN0YW5jZU11dGF0ZWQgPSBmdW5jdGlvbiAocmVwZWF0LCBtYXAsIHJlY29yZHMpIHtcclxuICAgICAgICB2YXIga2V5O1xyXG4gICAgICAgIHZhciBpO1xyXG4gICAgICAgIHZhciBpaTtcclxuICAgICAgICB2YXIgb3ZlcnJpZGVDb250ZXh0O1xyXG4gICAgICAgIHZhciByZW1vdmVJbmRleDtcclxuICAgICAgICB2YXIgYWRkSW5kZXg7XHJcbiAgICAgICAgdmFyIHJlY29yZDtcclxuICAgICAgICB2YXIgcm1Qcm9taXNlcyA9IFtdO1xyXG4gICAgICAgIHZhciB2aWV3T3JQcm9taXNlO1xyXG4gICAgICAgIGZvciAoaSA9IDAsIGlpID0gcmVjb3Jkcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XHJcbiAgICAgICAgICAgIHJlY29yZCA9IHJlY29yZHNbaV07XHJcbiAgICAgICAgICAgIGtleSA9IHJlY29yZC5rZXk7XHJcbiAgICAgICAgICAgIHN3aXRjaCAocmVjb3JkLnR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ3VwZGF0ZSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlSW5kZXggPSB0aGlzLl9nZXRWaWV3SW5kZXhCeUtleShyZXBlYXQsIGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmlld09yUHJvbWlzZSA9IHJlcGVhdC5yZW1vdmVWaWV3KHJlbW92ZUluZGV4LCB0cnVlLCAhcmVwZWF0LnZpZXdzUmVxdWlyZUxpZmVjeWNsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdPclByb21pc2UgaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJtUHJvbWlzZXMucHVzaCh2aWV3T3JQcm9taXNlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgb3ZlcnJpZGVDb250ZXh0ID0gY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dChyZXBlYXQsIG1hcC5nZXQoa2V5KSwgcmVtb3ZlSW5kZXgsIG1hcC5zaXplLCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcGVhdC5pbnNlcnRWaWV3KHJlbW92ZUluZGV4LCBvdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdhZGQnOlxyXG4gICAgICAgICAgICAgICAgICAgIGFkZEluZGV4ID0gcmVwZWF0LnZpZXdDb3VudCgpIDw9IG1hcC5zaXplIC0gMSA/IHJlcGVhdC52aWV3Q291bnQoKSA6IG1hcC5zaXplIC0gMTtcclxuICAgICAgICAgICAgICAgICAgICBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KHJlcGVhdCwgbWFwLmdldChrZXkpLCBhZGRJbmRleCwgbWFwLnNpemUsIGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVwZWF0Lmluc2VydFZpZXcobWFwLnNpemUgLSAxLCBvdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdkZWxldGUnOlxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZWNvcmQub2xkVmFsdWUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUluZGV4ID0gdGhpcy5fZ2V0Vmlld0luZGV4QnlLZXkocmVwZWF0LCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZpZXdPclByb21pc2UgPSByZXBlYXQucmVtb3ZlVmlldyhyZW1vdmVJbmRleCwgdHJ1ZSwgIXJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWV3T3JQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBybVByb21pc2VzLnB1c2godmlld09yUHJvbWlzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnY2xlYXInOlxyXG4gICAgICAgICAgICAgICAgICAgIHJlcGVhdC5yZW1vdmVBbGxWaWV3cyh0cnVlLCAhcmVwZWF0LnZpZXdzUmVxdWlyZUxpZmVjeWNsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChybVByb21pc2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgUHJvbWlzZS5hbGwocm1Qcm9taXNlcykudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVPdmVycmlkZUNvbnRleHRzKHJlcGVhdC52aWV3cygpLCAwKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB1cGRhdGVPdmVycmlkZUNvbnRleHRzKHJlcGVhdC52aWV3cygpLCAwKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgTWFwUmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLl9nZXRWaWV3SW5kZXhCeUtleSA9IGZ1bmN0aW9uIChyZXBlYXQsIGtleSkge1xyXG4gICAgICAgIHZhciBpO1xyXG4gICAgICAgIHZhciBpaTtcclxuICAgICAgICB2YXIgY2hpbGQ7XHJcbiAgICAgICAgZm9yIChpID0gMCwgaWkgPSByZXBlYXQudmlld0NvdW50KCk7IGkgPCBpaTsgKytpKSB7XHJcbiAgICAgICAgICAgIGNoaWxkID0gcmVwZWF0LnZpZXcoaSk7XHJcbiAgICAgICAgICAgIGlmIChjaGlsZC5iaW5kaW5nQ29udGV4dFtyZXBlYXQua2V5XSA9PT0ga2V5KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBNYXBSZXBlYXRTdHJhdGVneTtcclxufSgpKTtcblxudmFyIE51bGxSZXBlYXRTdHJhdGVneSA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBOdWxsUmVwZWF0U3RyYXRlZ3koKSB7XHJcbiAgICB9XHJcbiAgICBOdWxsUmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmluc3RhbmNlQ2hhbmdlZCA9IGZ1bmN0aW9uIChyZXBlYXQsIGl0ZW1zKSB7XHJcbiAgICAgICAgcmVwZWF0LnJlbW92ZUFsbFZpZXdzKHRydWUpO1xyXG4gICAgfTtcclxuICAgIE51bGxSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuZ2V0Q29sbGVjdGlvbk9ic2VydmVyID0gZnVuY3Rpb24gKG9ic2VydmVyTG9jYXRvciwgaXRlbXMpIHtcclxuICAgIH07XHJcbiAgICByZXR1cm4gTnVsbFJlcGVhdFN0cmF0ZWd5O1xyXG59KCkpO1xuXG52YXIgTnVtYmVyUmVwZWF0U3RyYXRlZ3kgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gTnVtYmVyUmVwZWF0U3RyYXRlZ3koKSB7XHJcbiAgICB9XHJcbiAgICBOdW1iZXJSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuZ2V0Q29sbGVjdGlvbk9ic2VydmVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuICAgIE51bWJlclJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5pbnN0YW5jZUNoYW5nZWQgPSBmdW5jdGlvbiAocmVwZWF0LCB2YWx1ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHJlbW92ZVByb21pc2UgPSByZXBlYXQucmVtb3ZlQWxsVmlld3ModHJ1ZSwgIXJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgIGlmIChyZW1vdmVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG4gICAgICAgICAgICByZW1vdmVQcm9taXNlLnRoZW4oZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuX3N0YW5kYXJkUHJvY2Vzc0l0ZW1zKHJlcGVhdCwgdmFsdWUpOyB9KTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9zdGFuZGFyZFByb2Nlc3NJdGVtcyhyZXBlYXQsIHZhbHVlKTtcclxuICAgIH07XHJcbiAgICBOdW1iZXJSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuX3N0YW5kYXJkUHJvY2Vzc0l0ZW1zID0gZnVuY3Rpb24gKHJlcGVhdCwgdmFsdWUpIHtcclxuICAgICAgICB2YXIgY2hpbGRyZW5MZW5ndGggPSByZXBlYXQudmlld0NvdW50KCk7XHJcbiAgICAgICAgdmFyIGk7XHJcbiAgICAgICAgdmFyIGlpO1xyXG4gICAgICAgIHZhciBvdmVycmlkZUNvbnRleHQ7XHJcbiAgICAgICAgdmFyIHZpZXdzVG9SZW1vdmU7XHJcbiAgICAgICAgdmFsdWUgPSBNYXRoLmZsb29yKHZhbHVlKTtcclxuICAgICAgICB2aWV3c1RvUmVtb3ZlID0gY2hpbGRyZW5MZW5ndGggLSB2YWx1ZTtcclxuICAgICAgICBpZiAodmlld3NUb1JlbW92ZSA+IDApIHtcclxuICAgICAgICAgICAgaWYgKHZpZXdzVG9SZW1vdmUgPiBjaGlsZHJlbkxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgdmlld3NUb1JlbW92ZSA9IGNoaWxkcmVuTGVuZ3RoO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZvciAoaSA9IDAsIGlpID0gdmlld3NUb1JlbW92ZTsgaSA8IGlpOyArK2kpIHtcclxuICAgICAgICAgICAgICAgIHJlcGVhdC5yZW1vdmVWaWV3KGNoaWxkcmVuTGVuZ3RoIC0gKGkgKyAxKSwgdHJ1ZSwgIXJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChpID0gY2hpbGRyZW5MZW5ndGgsIGlpID0gdmFsdWU7IGkgPCBpaTsgKytpKSB7XHJcbiAgICAgICAgICAgIG92ZXJyaWRlQ29udGV4dCA9IGNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQocmVwZWF0LCBpLCBpLCBpaSk7XHJcbiAgICAgICAgICAgIHJlcGVhdC5hZGRWaWV3KG92ZXJyaWRlQ29udGV4dC5iaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdXBkYXRlT3ZlcnJpZGVDb250ZXh0cyhyZXBlYXQudmlld3MoKSwgMCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE51bWJlclJlcGVhdFN0cmF0ZWd5O1xyXG59KCkpO1xuXG52YXIgU2V0UmVwZWF0U3RyYXRlZ3kgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU2V0UmVwZWF0U3RyYXRlZ3koKSB7XHJcbiAgICB9XHJcbiAgICBTZXRSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuZ2V0Q29sbGVjdGlvbk9ic2VydmVyID0gZnVuY3Rpb24gKG9ic2VydmVyTG9jYXRvciwgaXRlbXMpIHtcclxuICAgICAgICByZXR1cm4gb2JzZXJ2ZXJMb2NhdG9yLmdldFNldE9ic2VydmVyKGl0ZW1zKTtcclxuICAgIH07XHJcbiAgICBTZXRSZXBlYXRTdHJhdGVneS5wcm90b3R5cGUuaW5zdGFuY2VDaGFuZ2VkID0gZnVuY3Rpb24gKHJlcGVhdCwgaXRlbXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHZhciByZW1vdmVQcm9taXNlID0gcmVwZWF0LnJlbW92ZUFsbFZpZXdzKHRydWUsICFyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICBpZiAocmVtb3ZlUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgcmVtb3ZlUHJvbWlzZS50aGVuKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLl9zdGFuZGFyZFByb2Nlc3NJdGVtcyhyZXBlYXQsIGl0ZW1zKTsgfSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fc3RhbmRhcmRQcm9jZXNzSXRlbXMocmVwZWF0LCBpdGVtcyk7XHJcbiAgICB9O1xyXG4gICAgU2V0UmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLl9zdGFuZGFyZFByb2Nlc3NJdGVtcyA9IGZ1bmN0aW9uIChyZXBlYXQsIGl0ZW1zKSB7XHJcbiAgICAgICAgdmFyIGluZGV4ID0gMDtcclxuICAgICAgICB2YXIgb3ZlcnJpZGVDb250ZXh0O1xyXG4gICAgICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIG92ZXJyaWRlQ29udGV4dCA9IGNyZWF0ZUZ1bGxPdmVycmlkZUNvbnRleHQocmVwZWF0LCB2YWx1ZSwgaW5kZXgsIGl0ZW1zLnNpemUpO1xyXG4gICAgICAgICAgICByZXBlYXQuYWRkVmlldyhvdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgICAgICsraW5kZXg7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgU2V0UmVwZWF0U3RyYXRlZ3kucHJvdG90eXBlLmluc3RhbmNlTXV0YXRlZCA9IGZ1bmN0aW9uIChyZXBlYXQsIHNldCwgcmVjb3Jkcykge1xyXG4gICAgICAgIHZhciB2YWx1ZTtcclxuICAgICAgICB2YXIgaTtcclxuICAgICAgICB2YXIgaWk7XHJcbiAgICAgICAgdmFyIG92ZXJyaWRlQ29udGV4dDtcclxuICAgICAgICB2YXIgcmVtb3ZlSW5kZXg7XHJcbiAgICAgICAgdmFyIHJlY29yZDtcclxuICAgICAgICB2YXIgcm1Qcm9taXNlcyA9IFtdO1xyXG4gICAgICAgIHZhciB2aWV3T3JQcm9taXNlO1xyXG4gICAgICAgIGZvciAoaSA9IDAsIGlpID0gcmVjb3Jkcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XHJcbiAgICAgICAgICAgIHJlY29yZCA9IHJlY29yZHNbaV07XHJcbiAgICAgICAgICAgIHZhbHVlID0gcmVjb3JkLnZhbHVlO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHJlY29yZC50eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdhZGQnOlxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzaXplID0gTWF0aC5tYXgoc2V0LnNpemUgLSAxLCAwKTtcclxuICAgICAgICAgICAgICAgICAgICBvdmVycmlkZUNvbnRleHQgPSBjcmVhdGVGdWxsT3ZlcnJpZGVDb250ZXh0KHJlcGVhdCwgdmFsdWUsIHNpemUsIHNldC5zaXplKTtcclxuICAgICAgICAgICAgICAgICAgICByZXBlYXQuaW5zZXJ0VmlldyhzaXplLCBvdmVycmlkZUNvbnRleHQuYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdkZWxldGUnOlxyXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZUluZGV4ID0gdGhpcy5fZ2V0Vmlld0luZGV4QnlWYWx1ZShyZXBlYXQsIHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB2aWV3T3JQcm9taXNlID0gcmVwZWF0LnJlbW92ZVZpZXcocmVtb3ZlSW5kZXgsIHRydWUsICFyZXBlYXQudmlld3NSZXF1aXJlTGlmZWN5Y2xlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodmlld09yUHJvbWlzZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm1Qcm9taXNlcy5wdXNoKHZpZXdPclByb21pc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2NsZWFyJzpcclxuICAgICAgICAgICAgICAgICAgICByZXBlYXQucmVtb3ZlQWxsVmlld3ModHJ1ZSwgIXJlcGVhdC52aWV3c1JlcXVpcmVMaWZlY3ljbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocm1Qcm9taXNlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIFByb21pc2UuYWxsKHJtUHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlT3ZlcnJpZGVDb250ZXh0cyhyZXBlYXQudmlld3MoKSwgMCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdXBkYXRlT3ZlcnJpZGVDb250ZXh0cyhyZXBlYXQudmlld3MoKSwgMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFNldFJlcGVhdFN0cmF0ZWd5LnByb3RvdHlwZS5fZ2V0Vmlld0luZGV4QnlWYWx1ZSA9IGZ1bmN0aW9uIChyZXBlYXQsIHZhbHVlKSB7XHJcbiAgICAgICAgdmFyIGk7XHJcbiAgICAgICAgdmFyIGlpO1xyXG4gICAgICAgIHZhciBjaGlsZDtcclxuICAgICAgICBmb3IgKGkgPSAwLCBpaSA9IHJlcGVhdC52aWV3Q291bnQoKTsgaSA8IGlpOyArK2kpIHtcclxuICAgICAgICAgICAgY2hpbGQgPSByZXBlYXQudmlldyhpKTtcclxuICAgICAgICAgICAgaWYgKGNoaWxkLmJpbmRpbmdDb250ZXh0W3JlcGVhdC5sb2NhbF0gPT09IHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBTZXRSZXBlYXRTdHJhdGVneTtcclxufSgpKTtcblxudmFyIFJlcGVhdFN0cmF0ZWd5TG9jYXRvciA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBSZXBlYXRTdHJhdGVneUxvY2F0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5tYXRjaGVycyA9IFtdO1xyXG4gICAgICAgIHRoaXMuc3RyYXRlZ2llcyA9IFtdO1xyXG4gICAgICAgIHRoaXMuYWRkU3RyYXRlZ3koZnVuY3Rpb24gKGl0ZW1zKSB7IHJldHVybiBpdGVtcyA9PT0gbnVsbCB8fCBpdGVtcyA9PT0gdW5kZWZpbmVkOyB9LCBuZXcgTnVsbFJlcGVhdFN0cmF0ZWd5KCkpO1xyXG4gICAgICAgIHRoaXMuYWRkU3RyYXRlZ3koZnVuY3Rpb24gKGl0ZW1zKSB7IHJldHVybiBpdGVtcyBpbnN0YW5jZW9mIEFycmF5OyB9LCBuZXcgQXJyYXlSZXBlYXRTdHJhdGVneSgpKTtcclxuICAgICAgICB0aGlzLmFkZFN0cmF0ZWd5KGZ1bmN0aW9uIChpdGVtcykgeyByZXR1cm4gaXRlbXMgaW5zdGFuY2VvZiBNYXA7IH0sIG5ldyBNYXBSZXBlYXRTdHJhdGVneSgpKTtcclxuICAgICAgICB0aGlzLmFkZFN0cmF0ZWd5KGZ1bmN0aW9uIChpdGVtcykgeyByZXR1cm4gaXRlbXMgaW5zdGFuY2VvZiBTZXQ7IH0sIG5ldyBTZXRSZXBlYXRTdHJhdGVneSgpKTtcclxuICAgICAgICB0aGlzLmFkZFN0cmF0ZWd5KGZ1bmN0aW9uIChpdGVtcykgeyByZXR1cm4gdHlwZW9mIGl0ZW1zID09PSAnbnVtYmVyJzsgfSwgbmV3IE51bWJlclJlcGVhdFN0cmF0ZWd5KCkpO1xyXG4gICAgfVxyXG4gICAgUmVwZWF0U3RyYXRlZ3lMb2NhdG9yLnByb3RvdHlwZS5hZGRTdHJhdGVneSA9IGZ1bmN0aW9uIChtYXRjaGVyLCBzdHJhdGVneSkge1xyXG4gICAgICAgIHRoaXMubWF0Y2hlcnMucHVzaChtYXRjaGVyKTtcclxuICAgICAgICB0aGlzLnN0cmF0ZWdpZXMucHVzaChzdHJhdGVneSk7XHJcbiAgICB9O1xyXG4gICAgUmVwZWF0U3RyYXRlZ3lMb2NhdG9yLnByb3RvdHlwZS5nZXRTdHJhdGVneSA9IGZ1bmN0aW9uIChpdGVtcykge1xyXG4gICAgICAgIHZhciBtYXRjaGVycyA9IHRoaXMubWF0Y2hlcnM7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlpID0gbWF0Y2hlcnMubGVuZ3RoOyBpIDwgaWk7ICsraSkge1xyXG4gICAgICAgICAgICBpZiAobWF0Y2hlcnNbaV0oaXRlbXMpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zdHJhdGVnaWVzW2ldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBSZXBlYXRTdHJhdGVneUxvY2F0b3I7XHJcbn0oKSk7XG5cbnZhciBsaWZlY3ljbGVPcHRpb25hbEJlaGF2aW9ycyA9IFsnZm9jdXMnLCAnaWYnLCAnZWxzZScsICdyZXBlYXQnLCAnc2hvdycsICdoaWRlJywgJ3dpdGgnXTtcclxuZnVuY3Rpb24gYmVoYXZpb3JSZXF1aXJlc0xpZmVjeWNsZShpbnN0cnVjdGlvbikge1xyXG4gICAgdmFyIHQgPSBpbnN0cnVjdGlvbi50eXBlO1xyXG4gICAgdmFyIG5hbWUgPSB0LmVsZW1lbnROYW1lICE9PSBudWxsID8gdC5lbGVtZW50TmFtZSA6IHQuYXR0cmlidXRlTmFtZTtcclxuICAgIHJldHVybiBsaWZlY3ljbGVPcHRpb25hbEJlaGF2aW9ycy5pbmRleE9mKG5hbWUpID09PSAtMSAmJiAodC5oYW5kbGVzQXR0YWNoZWQgfHwgdC5oYW5kbGVzQmluZCB8fCB0LmhhbmRsZXNDcmVhdGVkIHx8IHQuaGFuZGxlc0RldGFjaGVkIHx8IHQuaGFuZGxlc1VuYmluZClcclxuICAgICAgICB8fCB0LnZpZXdGYWN0b3J5ICYmIHZpZXdzUmVxdWlyZUxpZmVjeWNsZSh0LnZpZXdGYWN0b3J5KVxyXG4gICAgICAgIHx8IGluc3RydWN0aW9uLnZpZXdGYWN0b3J5ICYmIHZpZXdzUmVxdWlyZUxpZmVjeWNsZShpbnN0cnVjdGlvbi52aWV3RmFjdG9yeSk7XHJcbn1cclxuZnVuY3Rpb24gdGFyZ2V0UmVxdWlyZXNMaWZlY3ljbGUoaW5zdHJ1Y3Rpb24pIHtcclxuICAgIHZhciBiZWhhdmlvcnMgPSBpbnN0cnVjdGlvbi5iZWhhdmlvckluc3RydWN0aW9ucztcclxuICAgIGlmIChiZWhhdmlvcnMpIHtcclxuICAgICAgICB2YXIgaSA9IGJlaGF2aW9ycy5sZW5ndGg7XHJcbiAgICAgICAgd2hpbGUgKGktLSkge1xyXG4gICAgICAgICAgICBpZiAoYmVoYXZpb3JSZXF1aXJlc0xpZmVjeWNsZShiZWhhdmlvcnNbaV0pKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBpbnN0cnVjdGlvbi52aWV3RmFjdG9yeSAmJiB2aWV3c1JlcXVpcmVMaWZlY3ljbGUoaW5zdHJ1Y3Rpb24udmlld0ZhY3RvcnkpO1xyXG59XHJcbmZ1bmN0aW9uIHZpZXdzUmVxdWlyZUxpZmVjeWNsZSh2aWV3RmFjdG9yeSkge1xyXG4gICAgaWYgKCdfdmlld3NSZXF1aXJlTGlmZWN5Y2xlJyBpbiB2aWV3RmFjdG9yeSkge1xyXG4gICAgICAgIHJldHVybiB2aWV3RmFjdG9yeS5fdmlld3NSZXF1aXJlTGlmZWN5Y2xlO1xyXG4gICAgfVxyXG4gICAgdmlld0ZhY3RvcnkuX3ZpZXdzUmVxdWlyZUxpZmVjeWNsZSA9IGZhbHNlO1xyXG4gICAgaWYgKHZpZXdGYWN0b3J5LnZpZXdGYWN0b3J5KSB7XHJcbiAgICAgICAgdmlld0ZhY3RvcnkuX3ZpZXdzUmVxdWlyZUxpZmVjeWNsZSA9IHZpZXdzUmVxdWlyZUxpZmVjeWNsZSh2aWV3RmFjdG9yeS52aWV3RmFjdG9yeSk7XHJcbiAgICAgICAgcmV0dXJuIHZpZXdGYWN0b3J5Ll92aWV3c1JlcXVpcmVMaWZlY3ljbGU7XHJcbiAgICB9XHJcbiAgICBpZiAodmlld0ZhY3RvcnkudGVtcGxhdGUucXVlcnlTZWxlY3RvcignLmF1LWFuaW1hdGUnKSkge1xyXG4gICAgICAgIHZpZXdGYWN0b3J5Ll92aWV3c1JlcXVpcmVMaWZlY3ljbGUgPSB0cnVlO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgZm9yICh2YXIgaWQgaW4gdmlld0ZhY3RvcnkuaW5zdHJ1Y3Rpb25zKSB7XHJcbiAgICAgICAgaWYgKHRhcmdldFJlcXVpcmVzTGlmZWN5Y2xlKHZpZXdGYWN0b3J5Lmluc3RydWN0aW9uc1tpZF0pKSB7XHJcbiAgICAgICAgICAgIHZpZXdGYWN0b3J5Ll92aWV3c1JlcXVpcmVMaWZlY3ljbGUgPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICB2aWV3RmFjdG9yeS5fdmlld3NSZXF1aXJlTGlmZWN5Y2xlID0gZmFsc2U7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn1cblxudmFyIEFic3RyYWN0UmVwZWF0ZXIgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQWJzdHJhY3RSZXBlYXRlcihvcHRpb25zKSB7XHJcbiAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLCB7XHJcbiAgICAgICAgICAgIGxvY2FsOiAnaXRlbXMnLFxyXG4gICAgICAgICAgICB2aWV3c1JlcXVpcmVMaWZlY3ljbGU6IHRydWVcclxuICAgICAgICB9LCBvcHRpb25zKTtcclxuICAgIH1cclxuICAgIEFic3RyYWN0UmVwZWF0ZXIucHJvdG90eXBlLnZpZXdDb3VudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3N1YmNsYXNzIG11c3QgaW1wbGVtZW50IGB2aWV3Q291bnRgJyk7XHJcbiAgICB9O1xyXG4gICAgQWJzdHJhY3RSZXBlYXRlci5wcm90b3R5cGUudmlld3MgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzdWJjbGFzcyBtdXN0IGltcGxlbWVudCBgdmlld3NgJyk7XHJcbiAgICB9O1xyXG4gICAgQWJzdHJhY3RSZXBlYXRlci5wcm90b3R5cGUudmlldyA9IGZ1bmN0aW9uIChpbmRleCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignc3ViY2xhc3MgbXVzdCBpbXBsZW1lbnQgYHZpZXdgJyk7XHJcbiAgICB9O1xyXG4gICAgQWJzdHJhY3RSZXBlYXRlci5wcm90b3R5cGUubWF0Y2hlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3N1YmNsYXNzIG11c3QgaW1wbGVtZW50IGBtYXRjaGVyYCcpO1xyXG4gICAgfTtcclxuICAgIEFic3RyYWN0UmVwZWF0ZXIucHJvdG90eXBlLmFkZFZpZXcgPSBmdW5jdGlvbiAoYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignc3ViY2xhc3MgbXVzdCBpbXBsZW1lbnQgYGFkZFZpZXdgJyk7XHJcbiAgICB9O1xyXG4gICAgQWJzdHJhY3RSZXBlYXRlci5wcm90b3R5cGUuaW5zZXJ0VmlldyA9IGZ1bmN0aW9uIChpbmRleCwgYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignc3ViY2xhc3MgbXVzdCBpbXBsZW1lbnQgYGluc2VydFZpZXdgJyk7XHJcbiAgICB9O1xyXG4gICAgQWJzdHJhY3RSZXBlYXRlci5wcm90b3R5cGUubW92ZVZpZXcgPSBmdW5jdGlvbiAoc291cmNlSW5kZXgsIHRhcmdldEluZGV4KSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdzdWJjbGFzcyBtdXN0IGltcGxlbWVudCBgbW92ZVZpZXdgJyk7XHJcbiAgICB9O1xyXG4gICAgQWJzdHJhY3RSZXBlYXRlci5wcm90b3R5cGUucmVtb3ZlQWxsVmlld3MgPSBmdW5jdGlvbiAocmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbikge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignc3ViY2xhc3MgbXVzdCBpbXBsZW1lbnQgYHJlbW92ZUFsbFZpZXdzYCcpO1xyXG4gICAgfTtcclxuICAgIEFic3RyYWN0UmVwZWF0ZXIucHJvdG90eXBlLnJlbW92ZVZpZXdzID0gZnVuY3Rpb24gKHZpZXdzVG9SZW1vdmUsIHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3N1YmNsYXNzIG11c3QgaW1wbGVtZW50IGByZW1vdmVWaWV3YCcpO1xyXG4gICAgfTtcclxuICAgIEFic3RyYWN0UmVwZWF0ZXIucHJvdG90eXBlLnJlbW92ZVZpZXcgPSBmdW5jdGlvbiAoaW5kZXgsIHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3N1YmNsYXNzIG11c3QgaW1wbGVtZW50IGByZW1vdmVWaWV3YCcpO1xyXG4gICAgfTtcclxuICAgIEFic3RyYWN0UmVwZWF0ZXIucHJvdG90eXBlLnVwZGF0ZUJpbmRpbmdzID0gZnVuY3Rpb24gKHZpZXcpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3N1YmNsYXNzIG11c3QgaW1wbGVtZW50IGB1cGRhdGVCaW5kaW5nc2AnKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gQWJzdHJhY3RSZXBlYXRlcjtcclxufSgpKTtcblxudmFyIG1hdGNoZXJFeHRyYWN0aW9uTWFya2VyID0gJ19fbWFya2VyX2V4dHJhY3RlZF9fJztcclxudmFyIFJlcGVhdCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoUmVwZWF0LCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gUmVwZWF0KHZpZXdGYWN0b3J5LCBpbnN0cnVjdGlvbiwgdmlld1Nsb3QsIHZpZXdSZXNvdXJjZXMsIG9ic2VydmVyTG9jYXRvciwgc3RyYXRlZ3lMb2NhdG9yKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywge1xyXG4gICAgICAgICAgICBsb2NhbDogJ2l0ZW0nLFxyXG4gICAgICAgICAgICB2aWV3c1JlcXVpcmVMaWZlY3ljbGU6IHZpZXdzUmVxdWlyZUxpZmVjeWNsZSh2aWV3RmFjdG9yeSlcclxuICAgICAgICB9KSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLnZpZXdGYWN0b3J5ID0gdmlld0ZhY3Rvcnk7XHJcbiAgICAgICAgX3RoaXMuaW5zdHJ1Y3Rpb24gPSBpbnN0cnVjdGlvbjtcclxuICAgICAgICBfdGhpcy52aWV3U2xvdCA9IHZpZXdTbG90O1xyXG4gICAgICAgIF90aGlzLmxvb2t1cEZ1bmN0aW9ucyA9IHZpZXdSZXNvdXJjZXMubG9va3VwRnVuY3Rpb25zO1xyXG4gICAgICAgIF90aGlzLm9ic2VydmVyTG9jYXRvciA9IG9ic2VydmVyTG9jYXRvcjtcclxuICAgICAgICBfdGhpcy5rZXkgPSAna2V5JztcclxuICAgICAgICBfdGhpcy52YWx1ZSA9ICd2YWx1ZSc7XHJcbiAgICAgICAgX3RoaXMuc3RyYXRlZ3lMb2NhdG9yID0gc3RyYXRlZ3lMb2NhdG9yO1xyXG4gICAgICAgIF90aGlzLmlnbm9yZU11dGF0aW9uID0gZmFsc2U7XHJcbiAgICAgICAgX3RoaXMuc291cmNlRXhwcmVzc2lvbiA9IGdldEl0ZW1zU291cmNlRXhwcmVzc2lvbihfdGhpcy5pbnN0cnVjdGlvbiwgJ3JlcGVhdC5mb3InKTtcclxuICAgICAgICBfdGhpcy5pc09uZVRpbWUgPSBpc09uZVRpbWUoX3RoaXMuc291cmNlRXhwcmVzc2lvbik7XHJcbiAgICAgICAgX3RoaXMudmlld3NSZXF1aXJlTGlmZWN5Y2xlID0gdmlld3NSZXF1aXJlTGlmZWN5Y2xlKHZpZXdGYWN0b3J5KTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBSZXBlYXRfMSA9IFJlcGVhdDtcclxuICAgIFJlcGVhdC5wcm90b3R5cGUuY2FsbCA9IGZ1bmN0aW9uIChjb250ZXh0LCBjaGFuZ2VzKSB7XHJcbiAgICAgICAgdGhpc1tjb250ZXh0XSh0aGlzLml0ZW1zLCBjaGFuZ2VzKTtcclxuICAgIH07XHJcbiAgICBSZXBlYXQucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAoYmluZGluZ0NvbnRleHQsIG92ZXJyaWRlQ29udGV4dCkge1xyXG4gICAgICAgIHRoaXMuc2NvcGUgPSB7IGJpbmRpbmdDb250ZXh0OiBiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0OiBvdmVycmlkZUNvbnRleHQgfTtcclxuICAgICAgICB2YXIgaW5zdHJ1Y3Rpb24gPSB0aGlzLmluc3RydWN0aW9uO1xyXG4gICAgICAgIGlmICghKG1hdGNoZXJFeHRyYWN0aW9uTWFya2VyIGluIGluc3RydWN0aW9uKSkge1xyXG4gICAgICAgICAgICBpbnN0cnVjdGlvblttYXRjaGVyRXh0cmFjdGlvbk1hcmtlcl0gPSB0aGlzLl9jYXB0dXJlQW5kUmVtb3ZlTWF0Y2hlckJpbmRpbmcoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5tYXRjaGVyQmluZGluZyA9IGluc3RydWN0aW9uW21hdGNoZXJFeHRyYWN0aW9uTWFya2VyXTtcclxuICAgICAgICB0aGlzLml0ZW1zQ2hhbmdlZCgpO1xyXG4gICAgfTtcclxuICAgIFJlcGVhdC5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuc2NvcGUgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaXRlbXMgPSBudWxsO1xyXG4gICAgICAgIHRoaXMubWF0Y2hlckJpbmRpbmcgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudmlld1Nsb3QucmVtb3ZlQWxsKHRydWUsIHRydWUpO1xyXG4gICAgICAgIHRoaXMuX3Vuc3Vic2NyaWJlQ29sbGVjdGlvbigpO1xyXG4gICAgfTtcclxuICAgIFJlcGVhdC5wcm90b3R5cGUuX3Vuc3Vic2NyaWJlQ29sbGVjdGlvbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAodGhpcy5jb2xsZWN0aW9uT2JzZXJ2ZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5jb2xsZWN0aW9uT2JzZXJ2ZXIudW5zdWJzY3JpYmUodGhpcy5jYWxsQ29udGV4dCwgdGhpcyk7XHJcbiAgICAgICAgICAgIHRoaXMuY29sbGVjdGlvbk9ic2VydmVyID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5jYWxsQ29udGV4dCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFJlcGVhdC5wcm90b3R5cGUuaXRlbXNDaGFuZ2VkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5fdW5zdWJzY3JpYmVDb2xsZWN0aW9uKCk7XHJcbiAgICAgICAgaWYgKCF0aGlzLnNjb3BlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcclxuICAgICAgICB0aGlzLnN0cmF0ZWd5ID0gdGhpcy5zdHJhdGVneUxvY2F0b3IuZ2V0U3RyYXRlZ3koaXRlbXMpO1xyXG4gICAgICAgIGlmICghdGhpcy5zdHJhdGVneSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWYWx1ZSBmb3IgJ1wiICsgdGhpcy5zb3VyY2VFeHByZXNzaW9uICsgXCInIGlzIG5vbi1yZXBlYXRhYmxlXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMuaXNPbmVUaW1lICYmICF0aGlzLl9vYnNlcnZlSW5uZXJDb2xsZWN0aW9uKCkpIHtcclxuICAgICAgICAgICAgdGhpcy5fb2JzZXJ2ZUNvbGxlY3Rpb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pZ25vcmVNdXRhdGlvbiA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5zdHJhdGVneS5pbnN0YW5jZUNoYW5nZWQodGhpcywgaXRlbXMpO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJMb2NhdG9yLnRhc2tRdWV1ZS5xdWV1ZU1pY3JvVGFzayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmlnbm9yZU11dGF0aW9uID0gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgUmVwZWF0LnByb3RvdHlwZS5fZ2V0SW5uZXJDb2xsZWN0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBleHByZXNzaW9uID0gdW53cmFwRXhwcmVzc2lvbih0aGlzLnNvdXJjZUV4cHJlc3Npb24pO1xyXG4gICAgICAgIGlmICghZXhwcmVzc2lvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb24uZXZhbHVhdGUodGhpcy5zY29wZSwgbnVsbCk7XHJcbiAgICB9O1xyXG4gICAgUmVwZWF0LnByb3RvdHlwZS5oYW5kbGVDb2xsZWN0aW9uTXV0YXRlZCA9IGZ1bmN0aW9uIChjb2xsZWN0aW9uLCBjaGFuZ2VzKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmNvbGxlY3Rpb25PYnNlcnZlcikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmlnbm9yZU11dGF0aW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zdHJhdGVneS5pbnN0YW5jZU11dGF0ZWQodGhpcywgY29sbGVjdGlvbiwgY2hhbmdlcyk7XHJcbiAgICB9O1xyXG4gICAgUmVwZWF0LnByb3RvdHlwZS5oYW5kbGVJbm5lckNvbGxlY3Rpb25NdXRhdGVkID0gZnVuY3Rpb24gKGNvbGxlY3Rpb24sIGNoYW5nZXMpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGlmICghdGhpcy5jb2xsZWN0aW9uT2JzZXJ2ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5pZ25vcmVNdXRhdGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaWdub3JlTXV0YXRpb24gPSB0cnVlO1xyXG4gICAgICAgIHZhciBuZXdJdGVtcyA9IHRoaXMuc291cmNlRXhwcmVzc2lvbi5ldmFsdWF0ZSh0aGlzLnNjb3BlLCB0aGlzLmxvb2t1cEZ1bmN0aW9ucyk7XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlckxvY2F0b3IudGFza1F1ZXVlLnF1ZXVlTWljcm9UYXNrKGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmlnbm9yZU11dGF0aW9uID0gZmFsc2U7IH0pO1xyXG4gICAgICAgIGlmIChuZXdJdGVtcyA9PT0gdGhpcy5pdGVtcykge1xyXG4gICAgICAgICAgICB0aGlzLml0ZW1zQ2hhbmdlZCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5pdGVtcyA9IG5ld0l0ZW1zO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBSZXBlYXQucHJvdG90eXBlLl9vYnNlcnZlSW5uZXJDb2xsZWN0aW9uID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMuX2dldElubmVyQ29sbGVjdGlvbigpO1xyXG4gICAgICAgIHZhciBzdHJhdGVneSA9IHRoaXMuc3RyYXRlZ3lMb2NhdG9yLmdldFN0cmF0ZWd5KGl0ZW1zKTtcclxuICAgICAgICBpZiAoIXN0cmF0ZWd5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uT2JzZXJ2ZXIgPSBzdHJhdGVneS5nZXRDb2xsZWN0aW9uT2JzZXJ2ZXIodGhpcy5vYnNlcnZlckxvY2F0b3IsIGl0ZW1zKTtcclxuICAgICAgICBpZiAoIXRoaXMuY29sbGVjdGlvbk9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jYWxsQ29udGV4dCA9ICdoYW5kbGVJbm5lckNvbGxlY3Rpb25NdXRhdGVkJztcclxuICAgICAgICB0aGlzLmNvbGxlY3Rpb25PYnNlcnZlci5zdWJzY3JpYmUodGhpcy5jYWxsQ29udGV4dCwgdGhpcyk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgUmVwZWF0LnByb3RvdHlwZS5fb2JzZXJ2ZUNvbGxlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5pdGVtcztcclxuICAgICAgICB0aGlzLmNvbGxlY3Rpb25PYnNlcnZlciA9IHRoaXMuc3RyYXRlZ3kuZ2V0Q29sbGVjdGlvbk9ic2VydmVyKHRoaXMub2JzZXJ2ZXJMb2NhdG9yLCBpdGVtcyk7XHJcbiAgICAgICAgaWYgKHRoaXMuY29sbGVjdGlvbk9ic2VydmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbENvbnRleHQgPSAnaGFuZGxlQ29sbGVjdGlvbk11dGF0ZWQnO1xyXG4gICAgICAgICAgICB0aGlzLmNvbGxlY3Rpb25PYnNlcnZlci5zdWJzY3JpYmUodGhpcy5jYWxsQ29udGV4dCwgdGhpcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFJlcGVhdC5wcm90b3R5cGUuX2NhcHR1cmVBbmRSZW1vdmVNYXRjaGVyQmluZGluZyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgdmlld0ZhY3RvcnkgPSB0aGlzLnZpZXdGYWN0b3J5LnZpZXdGYWN0b3J5O1xyXG4gICAgICAgIGlmICh2aWV3RmFjdG9yeSkge1xyXG4gICAgICAgICAgICB2YXIgdGVtcGxhdGUgPSB2aWV3RmFjdG9yeS50ZW1wbGF0ZTtcclxuICAgICAgICAgICAgdmFyIGluc3RydWN0aW9ucyA9IHZpZXdGYWN0b3J5Lmluc3RydWN0aW9ucztcclxuICAgICAgICAgICAgaWYgKFJlcGVhdF8xLnVzZUlubmVyTWF0Y2hlcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGV4dHJhY3RNYXRjaGVyQmluZGluZ0V4cHJlc3Npb24oaW5zdHJ1Y3Rpb25zKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZ2V0Q2hpbGRyZW5Db3VudCh0ZW1wbGF0ZSkgPiAxKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciByZXBlYXRlZEVsZW1lbnQgPSBnZXRGaXJzdEVsZW1lbnRDaGlsZCh0ZW1wbGF0ZSk7XHJcbiAgICAgICAgICAgIGlmICghcmVwZWF0ZWRFbGVtZW50Lmhhc0F0dHJpYnV0ZSgnYXUtdGFyZ2V0LWlkJykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIHJlcGVhdGVkRWxlbWVudFRhcmdldElkID0gcmVwZWF0ZWRFbGVtZW50LmdldEF0dHJpYnV0ZSgnYXUtdGFyZ2V0LWlkJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBleHRyYWN0TWF0Y2hlckJpbmRpbmdFeHByZXNzaW9uKGluc3RydWN0aW9ucywgcmVwZWF0ZWRFbGVtZW50VGFyZ2V0SWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfTtcclxuICAgIFJlcGVhdC5wcm90b3R5cGUudmlld0NvdW50ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy52aWV3U2xvdC5jaGlsZHJlbi5sZW5ndGg7IH07XHJcbiAgICBSZXBlYXQucHJvdG90eXBlLnZpZXdzID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy52aWV3U2xvdC5jaGlsZHJlbjsgfTtcclxuICAgIFJlcGVhdC5wcm90b3R5cGUudmlldyA9IGZ1bmN0aW9uIChpbmRleCkgeyByZXR1cm4gdGhpcy52aWV3U2xvdC5jaGlsZHJlbltpbmRleF07IH07XHJcbiAgICBSZXBlYXQucHJvdG90eXBlLm1hdGNoZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIG1hdGNoZXJCaW5kaW5nID0gdGhpcy5tYXRjaGVyQmluZGluZztcclxuICAgICAgICByZXR1cm4gbWF0Y2hlckJpbmRpbmdcclxuICAgICAgICAgICAgPyBtYXRjaGVyQmluZGluZy5zb3VyY2VFeHByZXNzaW9uLmV2YWx1YXRlKHRoaXMuc2NvcGUsIG1hdGNoZXJCaW5kaW5nLmxvb2t1cEZ1bmN0aW9ucylcclxuICAgICAgICAgICAgOiBudWxsO1xyXG4gICAgfTtcclxuICAgIFJlcGVhdC5wcm90b3R5cGUuYWRkVmlldyA9IGZ1bmN0aW9uIChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KSB7XHJcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdGYWN0b3J5LmNyZWF0ZSgpO1xyXG4gICAgICAgIHZpZXcuYmluZChiaW5kaW5nQ29udGV4dCwgb3ZlcnJpZGVDb250ZXh0KTtcclxuICAgICAgICB0aGlzLnZpZXdTbG90LmFkZCh2aWV3KTtcclxuICAgIH07XHJcbiAgICBSZXBlYXQucHJvdG90eXBlLmluc2VydFZpZXcgPSBmdW5jdGlvbiAoaW5kZXgsIGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcclxuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld0ZhY3RvcnkuY3JlYXRlKCk7XHJcbiAgICAgICAgdmlldy5iaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgICAgIHRoaXMudmlld1Nsb3QuaW5zZXJ0KGluZGV4LCB2aWV3KTtcclxuICAgIH07XHJcbiAgICBSZXBlYXQucHJvdG90eXBlLm1vdmVWaWV3ID0gZnVuY3Rpb24gKHNvdXJjZUluZGV4LCB0YXJnZXRJbmRleCkge1xyXG4gICAgICAgIHRoaXMudmlld1Nsb3QubW92ZShzb3VyY2VJbmRleCwgdGFyZ2V0SW5kZXgpO1xyXG4gICAgfTtcclxuICAgIFJlcGVhdC5wcm90b3R5cGUucmVtb3ZlQWxsVmlld3MgPSBmdW5jdGlvbiAocmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnZpZXdTbG90LnJlbW92ZUFsbChyZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKTtcclxuICAgIH07XHJcbiAgICBSZXBlYXQucHJvdG90eXBlLnJlbW92ZVZpZXdzID0gZnVuY3Rpb24gKHZpZXdzVG9SZW1vdmUsIHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy52aWV3U2xvdC5yZW1vdmVNYW55KHZpZXdzVG9SZW1vdmUsIHJldHVyblRvQ2FjaGUsIHNraXBBbmltYXRpb24pO1xyXG4gICAgfTtcclxuICAgIFJlcGVhdC5wcm90b3R5cGUucmVtb3ZlVmlldyA9IGZ1bmN0aW9uIChpbmRleCwgcmV0dXJuVG9DYWNoZSwgc2tpcEFuaW1hdGlvbikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnZpZXdTbG90LnJlbW92ZUF0KGluZGV4LCByZXR1cm5Ub0NhY2hlLCBza2lwQW5pbWF0aW9uKTtcclxuICAgIH07XHJcbiAgICBSZXBlYXQucHJvdG90eXBlLnVwZGF0ZUJpbmRpbmdzID0gZnVuY3Rpb24gKHZpZXcpIHtcclxuICAgICAgICB2YXIgJHZpZXcgPSB2aWV3O1xyXG4gICAgICAgIHZhciBqID0gJHZpZXcuYmluZGluZ3MubGVuZ3RoO1xyXG4gICAgICAgIHdoaWxlIChqLS0pIHtcclxuICAgICAgICAgICAgdXBkYXRlT25lVGltZUJpbmRpbmcoJHZpZXcuYmluZGluZ3Nbal0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBqID0gJHZpZXcuY29udHJvbGxlcnMubGVuZ3RoO1xyXG4gICAgICAgIHdoaWxlIChqLS0pIHtcclxuICAgICAgICAgICAgdmFyIGsgPSAkdmlldy5jb250cm9sbGVyc1tqXS5ib3VuZFByb3BlcnRpZXMubGVuZ3RoO1xyXG4gICAgICAgICAgICB3aGlsZSAoay0tKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYmluZGluZyA9ICR2aWV3LmNvbnRyb2xsZXJzW2pdLmJvdW5kUHJvcGVydGllc1trXS5iaW5kaW5nO1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlT25lVGltZUJpbmRpbmcoYmluZGluZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgdmFyIFJlcGVhdF8xO1xyXG4gICAgUmVwZWF0LnVzZUlubmVyTWF0Y2hlciA9IHRydWU7XHJcbiAgICBfX2RlY29yYXRlKFtcclxuICAgICAgICBiaW5kYWJsZVxyXG4gICAgXSwgUmVwZWF0LnByb3RvdHlwZSwgXCJpdGVtc1wiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgYmluZGFibGVcclxuICAgIF0sIFJlcGVhdC5wcm90b3R5cGUsIFwibG9jYWxcIiwgdm9pZCAwKTtcclxuICAgIF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIGJpbmRhYmxlXHJcbiAgICBdLCBSZXBlYXQucHJvdG90eXBlLCBcImtleVwiLCB2b2lkIDApO1xyXG4gICAgX19kZWNvcmF0ZShbXHJcbiAgICAgICAgYmluZGFibGVcclxuICAgIF0sIFJlcGVhdC5wcm90b3R5cGUsIFwidmFsdWVcIiwgdm9pZCAwKTtcclxuICAgIFJlcGVhdCA9IFJlcGVhdF8xID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgY3VzdG9tQXR0cmlidXRlKCdyZXBlYXQnKSxcclxuICAgICAgICB0ZW1wbGF0ZUNvbnRyb2xsZXIsXHJcbiAgICAgICAgaW5qZWN0KEJvdW5kVmlld0ZhY3RvcnksIFRhcmdldEluc3RydWN0aW9uLCBWaWV3U2xvdCwgVmlld1Jlc291cmNlcywgT2JzZXJ2ZXJMb2NhdG9yLCBSZXBlYXRTdHJhdGVneUxvY2F0b3IpXHJcbiAgICBdLCBSZXBlYXQpO1xyXG4gICAgcmV0dXJuIFJlcGVhdDtcclxufShBYnN0cmFjdFJlcGVhdGVyKSk7XHJcbnZhciBleHRyYWN0TWF0Y2hlckJpbmRpbmdFeHByZXNzaW9uID0gZnVuY3Rpb24gKGluc3RydWN0aW9ucywgdGFyZ2V0ZWRFbGVtZW50SWQpIHtcclxuICAgIHZhciBpbnN0cnVjdGlvbklkcyA9IE9iamVjdC5rZXlzKGluc3RydWN0aW9ucyk7XHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGluc3RydWN0aW9uSWRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdmFyIGluc3RydWN0aW9uSWQgPSBpbnN0cnVjdGlvbklkc1tpXTtcclxuICAgICAgICBpZiAodGFyZ2V0ZWRFbGVtZW50SWQgIT09IHVuZGVmaW5lZCAmJiBpbnN0cnVjdGlvbklkICE9PSB0YXJnZXRlZEVsZW1lbnRJZCkge1xyXG4gICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGV4cHJlc3Npb25zID0gaW5zdHJ1Y3Rpb25zW2luc3RydWN0aW9uSWRdLmV4cHJlc3Npb25zO1xyXG4gICAgICAgIGlmIChleHByZXNzaW9ucykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpaSA9IDA7IGlpIDwgZXhwcmVzc2lvbnMubGVuZ3RoOyBpaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXhwcmVzc2lvbnNbaWldLnRhcmdldFByb3BlcnR5ID09PSAnbWF0Y2hlcicpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWF0Y2hlckJpbmRpbmdFeHByZXNzaW9uID0gZXhwcmVzc2lvbnNbaWldO1xyXG4gICAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb25zLnNwbGljZShpaSwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXJCaW5kaW5nRXhwcmVzc2lvbjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufTtcclxudmFyIGdldENoaWxkcmVuQ291bnQgPSBmdW5jdGlvbiAoZWwpIHtcclxuICAgIHZhciBjaGlsZE5vZGVzID0gZWwuY2hpbGROb2RlcztcclxuICAgIHZhciBjb3VudCA9IDA7XHJcbiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBjaGlsZE5vZGVzLmxlbmd0aDsgaWkgPiBpOyArK2kpIHtcclxuICAgICAgICBpZiAoY2hpbGROb2Rlc1tpXS5ub2RlVHlwZSA9PT0gMSkge1xyXG4gICAgICAgICAgICArK2NvdW50O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBjb3VudDtcclxufTtcclxudmFyIGdldEZpcnN0RWxlbWVudENoaWxkID0gZnVuY3Rpb24gKGVsKSB7XHJcbiAgICB2YXIgZmlyc3RDaGlsZCA9IGVsLmZpcnN0Q2hpbGQ7XHJcbiAgICB3aGlsZSAoZmlyc3RDaGlsZCAhPT0gbnVsbCkge1xyXG4gICAgICAgIGlmIChmaXJzdENoaWxkLm5vZGVUeXBlID09PSAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmaXJzdENoaWxkO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaXJzdENoaWxkID0gZmlyc3RDaGlsZC5uZXh0U2libGluZztcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59O1xuXG52YXIgYXVyZWxpYUhpZGVDbGFzc05hbWUgPSAnYXVyZWxpYS1oaWRlJztcclxudmFyIGF1cmVsaWFIaWRlQ2xhc3MgPSBcIi5cIiArIGF1cmVsaWFIaWRlQ2xhc3NOYW1lICsgXCIgeyBkaXNwbGF5Om5vbmUgIWltcG9ydGFudDsgfVwiO1xyXG5mdW5jdGlvbiBpbmplY3RBdXJlbGlhSGlkZVN0eWxlQXRIZWFkKCkge1xyXG4gICAgRE9NLmluamVjdFN0eWxlcyhhdXJlbGlhSGlkZUNsYXNzKTtcclxufVxyXG5mdW5jdGlvbiBpbmplY3RBdXJlbGlhSGlkZVN0eWxlQXRCb3VuZGFyeShkb21Cb3VuZGFyeSkge1xyXG4gICAgaWYgKEZFQVRVUkUuc2hhZG93RE9NICYmIGRvbUJvdW5kYXJ5ICYmICFkb21Cb3VuZGFyeS5oYXNBdXJlbGlhSGlkZVN0eWxlKSB7XHJcbiAgICAgICAgZG9tQm91bmRhcnkuaGFzQXVyZWxpYUhpZGVTdHlsZSA9IHRydWU7XHJcbiAgICAgICAgRE9NLmluamVjdFN0eWxlcyhhdXJlbGlhSGlkZUNsYXNzLCBkb21Cb3VuZGFyeSk7XHJcbiAgICB9XHJcbn1cblxudmFyIFNob3cgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU2hvdyhlbGVtZW50LCBhbmltYXRvciwgZG9tQm91bmRhcnkpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG4gICAgICAgIHRoaXMuYW5pbWF0b3IgPSBhbmltYXRvcjtcclxuICAgICAgICB0aGlzLmRvbUJvdW5kYXJ5ID0gZG9tQm91bmRhcnk7XHJcbiAgICB9XHJcbiAgICBTaG93LmluamVjdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gW0RPTS5FbGVtZW50LCBBbmltYXRvciwgT3B0aW9uYWwub2YoRE9NLmJvdW5kYXJ5LCB0cnVlKV07XHJcbiAgICB9O1xyXG4gICAgU2hvdy5wcm90b3R5cGUuY3JlYXRlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpbmplY3RBdXJlbGlhSGlkZVN0eWxlQXRCb3VuZGFyeSh0aGlzLmRvbUJvdW5kYXJ5KTtcclxuICAgIH07XHJcbiAgICBTaG93LnByb3RvdHlwZS52YWx1ZUNoYW5nZWQgPSBmdW5jdGlvbiAobmV3VmFsdWUpIHtcclxuICAgICAgICB2YXIgZWxlbWVudCA9IHRoaXMuZWxlbWVudDtcclxuICAgICAgICB2YXIgYW5pbWF0b3IgPSB0aGlzLmFuaW1hdG9yO1xyXG4gICAgICAgIGlmIChuZXdWYWx1ZSkge1xyXG4gICAgICAgICAgICBhbmltYXRvci5yZW1vdmVDbGFzcyhlbGVtZW50LCBhdXJlbGlhSGlkZUNsYXNzTmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBhbmltYXRvci5hZGRDbGFzcyhlbGVtZW50LCBhdXJlbGlhSGlkZUNsYXNzTmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFNob3cucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAoYmluZGluZ0NvbnRleHQpIHtcclxuICAgICAgICB0aGlzLnZhbHVlQ2hhbmdlZCh0aGlzLnZhbHVlKTtcclxuICAgIH07XHJcbiAgICBTaG93ID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgY3VzdG9tQXR0cmlidXRlKCdzaG93JylcclxuICAgIF0sIFNob3cpO1xyXG4gICAgcmV0dXJuIFNob3c7XHJcbn0oKSk7XG5cbnZhciBIaWRlID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEhpZGUoZWxlbWVudCwgYW5pbWF0b3IsIGRvbUJvdW5kYXJ5KSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcclxuICAgICAgICB0aGlzLmFuaW1hdG9yID0gYW5pbWF0b3I7XHJcbiAgICAgICAgdGhpcy5kb21Cb3VuZGFyeSA9IGRvbUJvdW5kYXJ5O1xyXG4gICAgfVxyXG4gICAgSGlkZS5pbmplY3QgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIFtET00uRWxlbWVudCwgQW5pbWF0b3IsIE9wdGlvbmFsLm9mKERPTS5ib3VuZGFyeSwgdHJ1ZSldO1xyXG4gICAgfTtcclxuICAgIEhpZGUucHJvdG90eXBlLmNyZWF0ZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaW5qZWN0QXVyZWxpYUhpZGVTdHlsZUF0Qm91bmRhcnkodGhpcy5kb21Cb3VuZGFyeSk7XHJcbiAgICB9O1xyXG4gICAgSGlkZS5wcm90b3R5cGUudmFsdWVDaGFuZ2VkID0gZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XHJcbiAgICAgICAgaWYgKG5ld1ZhbHVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYW5pbWF0b3IuYWRkQ2xhc3ModGhpcy5lbGVtZW50LCBhdXJlbGlhSGlkZUNsYXNzTmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmFuaW1hdG9yLnJlbW92ZUNsYXNzKHRoaXMuZWxlbWVudCwgYXVyZWxpYUhpZGVDbGFzc05hbWUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBIaWRlLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKGJpbmRpbmdDb250ZXh0KSB7XHJcbiAgICAgICAgdGhpcy52YWx1ZUNoYW5nZWQodGhpcy52YWx1ZSk7XHJcbiAgICB9O1xyXG4gICAgSGlkZS5wcm90b3R5cGUudmFsdWUgPSBmdW5jdGlvbiAodmFsdWUpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01ldGhvZCBub3QgaW1wbGVtZW50ZWQuJyk7XHJcbiAgICB9O1xyXG4gICAgSGlkZSA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIGN1c3RvbUF0dHJpYnV0ZSgnaGlkZScpXHJcbiAgICBdLCBIaWRlKTtcclxuICAgIHJldHVybiBIaWRlO1xyXG59KCkpO1xuXG52YXIgU0NSSVBUX1JFR0VYID0gLzxzY3JpcHRcXGJbXjxdKig/Oig/ITxcXC9zY3JpcHQ+KTxbXjxdKikqPFxcL3NjcmlwdD4vZ2k7XHJcbnZhciBuZWVkc1RvV2FybiA9IHRydWU7XHJcbnZhciBIVE1MU2FuaXRpemVyID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEhUTUxTYW5pdGl6ZXIoKSB7XHJcbiAgICB9XHJcbiAgICBIVE1MU2FuaXRpemVyLnByb3RvdHlwZS5zYW5pdGl6ZSA9IGZ1bmN0aW9uIChpbnB1dCkge1xyXG4gICAgICAgIGlmIChuZWVkc1RvV2Fybikge1xyXG4gICAgICAgICAgICBuZWVkc1RvV2FybiA9IGZhbHNlO1xyXG4gICAgICAgICAgICBnZXRMb2dnZXIoJ2h0bWwtc2FuaXRpemVyJylcclxuICAgICAgICAgICAgICAgIC53YXJuKFwiQ0FVVElPTjogVGhlIGRlZmF1bHQgSFRNTFNhbml0aXplciBkb2VzIE5PVCBwcm92aWRlIHNlY3VyaXR5IGFnYWluc3QgYSB3aWRlIHZhcmlldHkgb2Ygc29waGlzdGljYXRlZCBYU1MgYXR0YWNrcyxcXG5hbmQgc2hvdWxkIG5vdCBiZSByZWxpZWQgb24gZm9yIHNhbml0aXppbmcgaW5wdXQgZnJvbSB1bmtub3duIHNvdXJjZXMuXFxuUGxlYXNlIHNlZSBodHRwczovL2F1cmVsaWEuaW8vZG9jcy9iaW5kaW5nL2Jhc2ljcyNlbGVtZW50LWNvbnRlbnQgZm9yIGluc3RydWN0aW9ucyBvbiBob3cgdG8gdXNlIGEgc2VjdXJlIHNvbHV0aW9uIGxpa2UgRE9NUHVyaWZ5IG9yIHNhbml0aXplLWh0bWwuXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaW5wdXQucmVwbGFjZShTQ1JJUFRfUkVHRVgsICcnKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gSFRNTFNhbml0aXplcjtcclxufSgpKTtcblxudmFyIFNhbml0aXplSFRNTFZhbHVlQ29udmVydGVyID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNhbml0aXplSFRNTFZhbHVlQ29udmVydGVyKHNhbml0aXplcikge1xyXG4gICAgICAgIHRoaXMuc2FuaXRpemVyID0gc2FuaXRpemVyO1xyXG4gICAgfVxyXG4gICAgU2FuaXRpemVIVE1MVmFsdWVDb252ZXJ0ZXIucHJvdG90eXBlLnRvVmlldyA9IGZ1bmN0aW9uICh1bnRydXN0ZWRNYXJrdXApIHtcclxuICAgICAgICBpZiAodW50cnVzdGVkTWFya3VwID09PSBudWxsIHx8IHVudHJ1c3RlZE1hcmt1cCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5zYW5pdGl6ZXIuc2FuaXRpemUodW50cnVzdGVkTWFya3VwKTtcclxuICAgIH07XHJcbiAgICBTYW5pdGl6ZUhUTUxWYWx1ZUNvbnZlcnRlciA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIHZhbHVlQ29udmVydGVyKCdzYW5pdGl6ZUhUTUwnKSxcclxuICAgICAgICBpbmplY3QoSFRNTFNhbml0aXplcilcclxuICAgIF0sIFNhbml0aXplSFRNTFZhbHVlQ29udmVydGVyKTtcclxuICAgIHJldHVybiBTYW5pdGl6ZUhUTUxWYWx1ZUNvbnZlcnRlcjtcclxufSgpKTtcblxudmFyIFJlcGxhY2VhYmxlID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFJlcGxhY2VhYmxlKHZpZXdGYWN0b3J5LCB2aWV3U2xvdCkge1xyXG4gICAgICAgIHRoaXMudmlld0ZhY3RvcnkgPSB2aWV3RmFjdG9yeTtcclxuICAgICAgICB0aGlzLnZpZXdTbG90ID0gdmlld1Nsb3Q7XHJcbiAgICAgICAgdGhpcy52aWV3ID0gbnVsbDtcclxuICAgIH1cclxuICAgIFJlcGxhY2VhYmxlLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpIHtcclxuICAgICAgICBpZiAodGhpcy52aWV3ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmlldyA9IHRoaXMudmlld0ZhY3RvcnkuY3JlYXRlKCk7XHJcbiAgICAgICAgICAgIHRoaXMudmlld1Nsb3QuYWRkKHRoaXMudmlldyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudmlldy5iaW5kKGJpbmRpbmdDb250ZXh0LCBvdmVycmlkZUNvbnRleHQpO1xyXG4gICAgfTtcclxuICAgIFJlcGxhY2VhYmxlLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy52aWV3LnVuYmluZCgpO1xyXG4gICAgfTtcclxuICAgIFJlcGxhY2VhYmxlID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgY3VzdG9tQXR0cmlidXRlKCdyZXBsYWNlYWJsZScpLFxyXG4gICAgICAgIHRlbXBsYXRlQ29udHJvbGxlcixcclxuICAgICAgICBpbmplY3QoQm91bmRWaWV3RmFjdG9yeSwgVmlld1Nsb3QpXHJcbiAgICBdLCBSZXBsYWNlYWJsZSk7XHJcbiAgICByZXR1cm4gUmVwbGFjZWFibGU7XHJcbn0oKSk7XG5cbnZhciBGb2N1cyA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBGb2N1cyhlbGVtZW50LCB0YXNrUXVldWUpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG4gICAgICAgIHRoaXMudGFza1F1ZXVlID0gdGFza1F1ZXVlO1xyXG4gICAgICAgIHRoaXMuaXNBdHRhY2hlZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubmVlZHNBcHBseSA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgRm9jdXMuaW5qZWN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBbRE9NLkVsZW1lbnQsIFRhc2tRdWV1ZV07XHJcbiAgICB9O1xyXG4gICAgRm9jdXMucHJvdG90eXBlLnZhbHVlQ2hhbmdlZCA9IGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xyXG4gICAgICAgIGlmICh0aGlzLmlzQXR0YWNoZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fYXBwbHkoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubmVlZHNBcHBseSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIEZvY3VzLnByb3RvdHlwZS5fYXBwbHkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBpZiAodGhpcy52YWx1ZSkge1xyXG4gICAgICAgICAgICB0aGlzLnRhc2tRdWV1ZS5xdWV1ZU1pY3JvVGFzayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMudmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5lbGVtZW50LmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmJsdXIoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgRm9jdXMucHJvdG90eXBlLmF0dGFjaGVkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHRoaXMuaXNBdHRhY2hlZCA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMubmVlZHNBcHBseSkge1xyXG4gICAgICAgICAgICB0aGlzLm5lZWRzQXBwbHkgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5fYXBwbHkoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgdGhpcyk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzKTtcclxuICAgIH07XHJcbiAgICBGb2N1cy5wcm90b3R5cGUuZGV0YWNoZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5pc0F0dGFjaGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgdGhpcyk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzKTtcclxuICAgIH07XHJcbiAgICBGb2N1cy5wcm90b3R5cGUuaGFuZGxlRXZlbnQgPSBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIGlmIChlLnR5cGUgPT09ICdmb2N1cycpIHtcclxuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKERPTS5hY3RpdmVFbGVtZW50ICE9PSB0aGlzLmVsZW1lbnQpIHtcclxuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBGb2N1cyA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIGN1c3RvbUF0dHJpYnV0ZSgnZm9jdXMnLCBiaW5kaW5nTW9kZS50d29XYXkpXHJcbiAgICBdLCBGb2N1cyk7XHJcbiAgICByZXR1cm4gRm9jdXM7XHJcbn0oKSk7XG5cbnZhciBjc3NVcmxNYXRjaGVyID0gL3VybFxcKCg/IVsnXCJdZGF0YSkoW14pXSspXFwpL2dpO1xyXG5mdW5jdGlvbiBmaXh1cENTU1VybHMoYWRkcmVzcywgY3NzKSB7XHJcbiAgICBpZiAodHlwZW9mIGNzcyAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgbG9hZGluZyByZXF1aXJlZCBDU1MgZmlsZTogXCIgKyBhZGRyZXNzKTtcclxuICAgIH1cclxuICAgIHJldHVybiBjc3MucmVwbGFjZShjc3NVcmxNYXRjaGVyLCBmdW5jdGlvbiAobWF0Y2gsIHAxKSB7XHJcbiAgICAgICAgdmFyIHF1b3RlID0gcDEuY2hhckF0KDApO1xyXG4gICAgICAgIGlmIChxdW90ZSA9PT0gJ1xcJycgfHwgcXVvdGUgPT09ICdcIicpIHtcclxuICAgICAgICAgICAgcDEgPSBwMS5zdWJzdHIoMSwgcDEubGVuZ3RoIC0gMik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAndXJsKFxcJycgKyByZWxhdGl2ZVRvRmlsZShwMSwgYWRkcmVzcykgKyAnXFwnKSc7XHJcbiAgICB9KTtcclxufVxyXG52YXIgQ1NTUmVzb3VyY2UgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQ1NTUmVzb3VyY2UoYWRkcmVzcykge1xyXG4gICAgICAgIHRoaXMuYWRkcmVzcyA9IGFkZHJlc3M7XHJcbiAgICAgICAgdGhpcy5fc2NvcGVkID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9nbG9iYWwgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9hbHJlYWR5R2xvYmFsbHlJbmplY3RlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gICAgQ1NTUmVzb3VyY2UucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoY29udGFpbmVyLCBUYXJnZXQpIHtcclxuICAgICAgICB0aGlzLl9zY29wZWQgPSBuZXcgVGFyZ2V0KHRoaXMpO1xyXG4gICAgfTtcclxuICAgIENTU1Jlc291cmNlLnByb3RvdHlwZS5yZWdpc3RlciA9IGZ1bmN0aW9uIChyZWdpc3RyeSwgbmFtZSkge1xyXG4gICAgICAgIGlmIChuYW1lID09PSAnc2NvcGVkJykge1xyXG4gICAgICAgICAgICByZWdpc3RyeS5yZWdpc3RlclZpZXdFbmdpbmVIb29rcyh0aGlzLl9zY29wZWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fZ2xvYmFsID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgQ1NTUmVzb3VyY2UucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAoY29udGFpbmVyKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gY29udGFpbmVyLmdldChMb2FkZXIpXHJcbiAgICAgICAgICAgIC5sb2FkVGV4dCh0aGlzLmFkZHJlc3MpXHJcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoZXJyKSB7IHJldHVybiBudWxsOyB9KVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAodGV4dCkge1xyXG4gICAgICAgICAgICB0ZXh0ID0gZml4dXBDU1NVcmxzKF90aGlzLmFkZHJlc3MsIHRleHQpO1xyXG4gICAgICAgICAgICBfdGhpcy5fc2NvcGVkLmNzcyA9IHRleHQ7XHJcbiAgICAgICAgICAgIGlmIChfdGhpcy5fZ2xvYmFsKSB7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5fYWxyZWFkeUdsb2JhbGx5SW5qZWN0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgRE9NLmluamVjdFN0eWxlcyh0ZXh0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBDU1NSZXNvdXJjZTtcclxufSgpKTtcclxudmFyIENTU1ZpZXdFbmdpbmVIb29rcyA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBDU1NWaWV3RW5naW5lSG9va3Mob3duZXIpIHtcclxuICAgICAgICB0aGlzLm93bmVyID0gb3duZXI7XHJcbiAgICAgICAgdGhpcy5jc3MgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgQ1NTVmlld0VuZ2luZUhvb2tzLnByb3RvdHlwZS5iZWZvcmVDb21waWxlID0gZnVuY3Rpb24gKGNvbnRlbnQsIHJlc291cmNlcywgaW5zdHJ1Y3Rpb24pIHtcclxuICAgICAgICBpZiAoaW5zdHJ1Y3Rpb24udGFyZ2V0U2hhZG93RE9NKSB7XHJcbiAgICAgICAgICAgIERPTS5pbmplY3RTdHlsZXModGhpcy5jc3MsIGNvbnRlbnQsIHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChGRUFUVVJFLnNjb3BlZENTUykge1xyXG4gICAgICAgICAgICB2YXIgc3R5bGVOb2RlID0gRE9NLmluamVjdFN0eWxlcyh0aGlzLmNzcywgY29udGVudCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIHN0eWxlTm9kZS5zZXRBdHRyaWJ1dGUoJ3Njb3BlZCcsICdzY29wZWQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy5fZ2xvYmFsICYmICF0aGlzLm93bmVyLl9hbHJlYWR5R2xvYmFsbHlJbmplY3RlZCkge1xyXG4gICAgICAgICAgICBET00uaW5qZWN0U3R5bGVzKHRoaXMuY3NzKTtcclxuICAgICAgICAgICAgdGhpcy5vd25lci5fYWxyZWFkeUdsb2JhbGx5SW5qZWN0ZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICByZXR1cm4gQ1NTVmlld0VuZ2luZUhvb2tzO1xyXG59KCkpO1xyXG5mdW5jdGlvbiBfY3JlYXRlQ1NTUmVzb3VyY2UoYWRkcmVzcykge1xyXG4gICAgdmFyIFZpZXdDU1MgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xyXG4gICAgICAgIF9fZXh0ZW5kcyhWaWV3Q1NTLCBfc3VwZXIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIFZpZXdDU1MoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcclxuICAgICAgICB9XHJcbiAgICAgICAgVmlld0NTUyA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgICAgICByZXNvdXJjZShuZXcgQ1NTUmVzb3VyY2UoYWRkcmVzcykpXHJcbiAgICAgICAgXSwgVmlld0NTUyk7XHJcbiAgICAgICAgcmV0dXJuIFZpZXdDU1M7XHJcbiAgICB9KENTU1ZpZXdFbmdpbmVIb29rcykpO1xyXG4gICAgcmV0dXJuIFZpZXdDU1M7XHJcbn1cblxudmFyIEF0dHJCaW5kaW5nQmVoYXZpb3IgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQXR0ckJpbmRpbmdCZWhhdmlvcigpIHtcclxuICAgIH1cclxuICAgIEF0dHJCaW5kaW5nQmVoYXZpb3IucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAoYmluZGluZywgc291cmNlKSB7XHJcbiAgICAgICAgYmluZGluZy50YXJnZXRPYnNlcnZlciA9IG5ldyBEYXRhQXR0cmlidXRlT2JzZXJ2ZXIoYmluZGluZy50YXJnZXQsIGJpbmRpbmcudGFyZ2V0UHJvcGVydHkpO1xyXG4gICAgfTtcclxuICAgIEF0dHJCaW5kaW5nQmVoYXZpb3IucHJvdG90eXBlLnVuYmluZCA9IGZ1bmN0aW9uIChiaW5kaW5nLCBzb3VyY2UpIHtcclxuICAgIH07XHJcbiAgICBBdHRyQmluZGluZ0JlaGF2aW9yID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgYmluZGluZ0JlaGF2aW9yKCdhdHRyJylcclxuICAgIF0sIEF0dHJCaW5kaW5nQmVoYXZpb3IpO1xyXG4gICAgcmV0dXJuIEF0dHJCaW5kaW5nQmVoYXZpb3I7XHJcbn0oKSk7XG5cbnZhciBtb2RlQmluZGluZ0JlaGF2aW9yID0ge1xyXG4gICAgYmluZDogZnVuY3Rpb24gKGJpbmRpbmcsIHNvdXJjZSwgbG9va3VwRnVuY3Rpb25zKSB7XHJcbiAgICAgICAgYmluZGluZy5vcmlnaW5hbE1vZGUgPSBiaW5kaW5nLm1vZGU7XHJcbiAgICAgICAgYmluZGluZy5tb2RlID0gdGhpcy5tb2RlO1xyXG4gICAgfSxcclxuICAgIHVuYmluZDogZnVuY3Rpb24gKGJpbmRpbmcsIHNvdXJjZSkge1xyXG4gICAgICAgIGJpbmRpbmcubW9kZSA9IGJpbmRpbmcub3JpZ2luYWxNb2RlO1xyXG4gICAgICAgIGJpbmRpbmcub3JpZ2luYWxNb2RlID0gbnVsbDtcclxuICAgIH1cclxufTtcclxudmFyIE9uZVRpbWVCaW5kaW5nQmVoYXZpb3IgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gT25lVGltZUJpbmRpbmdCZWhhdmlvcigpIHtcclxuICAgICAgICB0aGlzLm1vZGUgPSBiaW5kaW5nTW9kZS5vbmVUaW1lO1xyXG4gICAgfVxyXG4gICAgT25lVGltZUJpbmRpbmdCZWhhdmlvciA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIG1peGluKG1vZGVCaW5kaW5nQmVoYXZpb3IpLFxyXG4gICAgICAgIGJpbmRpbmdCZWhhdmlvcignb25lVGltZScpXHJcbiAgICBdLCBPbmVUaW1lQmluZGluZ0JlaGF2aW9yKTtcclxuICAgIHJldHVybiBPbmVUaW1lQmluZGluZ0JlaGF2aW9yO1xyXG59KCkpO1xyXG52YXIgT25lV2F5QmluZGluZ0JlaGF2aW9yID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIE9uZVdheUJpbmRpbmdCZWhhdmlvcigpIHtcclxuICAgICAgICB0aGlzLm1vZGUgPSBiaW5kaW5nTW9kZS50b1ZpZXc7XHJcbiAgICB9XHJcbiAgICBPbmVXYXlCaW5kaW5nQmVoYXZpb3IgPSBfX2RlY29yYXRlKFtcclxuICAgICAgICBtaXhpbihtb2RlQmluZGluZ0JlaGF2aW9yKSxcclxuICAgICAgICBiaW5kaW5nQmVoYXZpb3IoJ29uZVdheScpXHJcbiAgICBdLCBPbmVXYXlCaW5kaW5nQmVoYXZpb3IpO1xyXG4gICAgcmV0dXJuIE9uZVdheUJpbmRpbmdCZWhhdmlvcjtcclxufSgpKTtcclxudmFyIFRvVmlld0JpbmRpbmdCZWhhdmlvciA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBUb1ZpZXdCaW5kaW5nQmVoYXZpb3IoKSB7XHJcbiAgICAgICAgdGhpcy5tb2RlID0gYmluZGluZ01vZGUudG9WaWV3O1xyXG4gICAgfVxyXG4gICAgVG9WaWV3QmluZGluZ0JlaGF2aW9yID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgbWl4aW4obW9kZUJpbmRpbmdCZWhhdmlvciksXHJcbiAgICAgICAgYmluZGluZ0JlaGF2aW9yKCd0b1ZpZXcnKVxyXG4gICAgXSwgVG9WaWV3QmluZGluZ0JlaGF2aW9yKTtcclxuICAgIHJldHVybiBUb1ZpZXdCaW5kaW5nQmVoYXZpb3I7XHJcbn0oKSk7XHJcbnZhciBGcm9tVmlld0JpbmRpbmdCZWhhdmlvciA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBGcm9tVmlld0JpbmRpbmdCZWhhdmlvcigpIHtcclxuICAgICAgICB0aGlzLm1vZGUgPSBiaW5kaW5nTW9kZS5mcm9tVmlldztcclxuICAgIH1cclxuICAgIEZyb21WaWV3QmluZGluZ0JlaGF2aW9yID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgbWl4aW4obW9kZUJpbmRpbmdCZWhhdmlvciksXHJcbiAgICAgICAgYmluZGluZ0JlaGF2aW9yKCdmcm9tVmlldycpXHJcbiAgICBdLCBGcm9tVmlld0JpbmRpbmdCZWhhdmlvcik7XHJcbiAgICByZXR1cm4gRnJvbVZpZXdCaW5kaW5nQmVoYXZpb3I7XHJcbn0oKSk7XHJcbnZhciBUd29XYXlCaW5kaW5nQmVoYXZpb3IgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gVHdvV2F5QmluZGluZ0JlaGF2aW9yKCkge1xyXG4gICAgICAgIHRoaXMubW9kZSA9IGJpbmRpbmdNb2RlLnR3b1dheTtcclxuICAgIH1cclxuICAgIFR3b1dheUJpbmRpbmdCZWhhdmlvciA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIG1peGluKG1vZGVCaW5kaW5nQmVoYXZpb3IpLFxyXG4gICAgICAgIGJpbmRpbmdCZWhhdmlvcigndHdvV2F5JylcclxuICAgIF0sIFR3b1dheUJpbmRpbmdCZWhhdmlvcik7XHJcbiAgICByZXR1cm4gVHdvV2F5QmluZGluZ0JlaGF2aW9yO1xyXG59KCkpO1xuXG5mdW5jdGlvbiB0aHJvdHRsZShuZXdWYWx1ZSkge1xyXG4gICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgIHZhciBzdGF0ZSA9IHRoaXMudGhyb3R0bGVTdGF0ZTtcclxuICAgIHZhciBlbGFwc2VkID0gK25ldyBEYXRlKCkgLSBzdGF0ZS5sYXN0O1xyXG4gICAgaWYgKGVsYXBzZWQgPj0gc3RhdGUuZGVsYXkpIHtcclxuICAgICAgICBjbGVhclRpbWVvdXQoc3RhdGUudGltZW91dElkKTtcclxuICAgICAgICBzdGF0ZS50aW1lb3V0SWQgPSBudWxsO1xyXG4gICAgICAgIHN0YXRlLmxhc3QgPSArbmV3IERhdGUoKTtcclxuICAgICAgICB0aGlzLnRocm90dGxlZE1ldGhvZChuZXdWYWx1ZSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgc3RhdGUubmV3VmFsdWUgPSBuZXdWYWx1ZTtcclxuICAgIGlmIChzdGF0ZS50aW1lb3V0SWQgPT09IG51bGwpIHtcclxuICAgICAgICBzdGF0ZS50aW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgc3RhdGUudGltZW91dElkID0gbnVsbDtcclxuICAgICAgICAgICAgc3RhdGUubGFzdCA9ICtuZXcgRGF0ZSgpO1xyXG4gICAgICAgICAgICBfdGhpcy50aHJvdHRsZWRNZXRob2Qoc3RhdGUubmV3VmFsdWUpO1xyXG4gICAgICAgIH0sIHN0YXRlLmRlbGF5IC0gZWxhcHNlZCk7XHJcbiAgICB9XHJcbn1cclxudmFyIFRocm90dGxlQmluZGluZ0JlaGF2aW9yID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFRocm90dGxlQmluZGluZ0JlaGF2aW9yKCkge1xyXG4gICAgfVxyXG4gICAgVGhyb3R0bGVCaW5kaW5nQmVoYXZpb3IucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAoYmluZGluZywgc291cmNlLCBkZWxheSkge1xyXG4gICAgICAgIGlmIChkZWxheSA9PT0gdm9pZCAwKSB7IGRlbGF5ID0gMjAwOyB9XHJcbiAgICAgICAgdmFyIG1ldGhvZFRvVGhyb3R0bGUgPSAndXBkYXRlVGFyZ2V0JztcclxuICAgICAgICBpZiAoYmluZGluZy5jYWxsU291cmNlKSB7XHJcbiAgICAgICAgICAgIG1ldGhvZFRvVGhyb3R0bGUgPSAnY2FsbFNvdXJjZSc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGJpbmRpbmcudXBkYXRlU291cmNlICYmIGJpbmRpbmcubW9kZSA9PT0gYmluZGluZ01vZGUudHdvV2F5KSB7XHJcbiAgICAgICAgICAgIG1ldGhvZFRvVGhyb3R0bGUgPSAndXBkYXRlU291cmNlJztcclxuICAgICAgICB9XHJcbiAgICAgICAgYmluZGluZy50aHJvdHRsZWRNZXRob2QgPSBiaW5kaW5nW21ldGhvZFRvVGhyb3R0bGVdO1xyXG4gICAgICAgIGJpbmRpbmcudGhyb3R0bGVkTWV0aG9kLm9yaWdpbmFsTmFtZSA9IG1ldGhvZFRvVGhyb3R0bGU7XHJcbiAgICAgICAgYmluZGluZ1ttZXRob2RUb1Rocm90dGxlXSA9IHRocm90dGxlO1xyXG4gICAgICAgIGJpbmRpbmcudGhyb3R0bGVTdGF0ZSA9IHtcclxuICAgICAgICAgICAgZGVsYXk6IGRlbGF5LFxyXG4gICAgICAgICAgICBsYXN0OiAwLFxyXG4gICAgICAgICAgICB0aW1lb3V0SWQ6IG51bGxcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIFRocm90dGxlQmluZGluZ0JlaGF2aW9yLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiAoYmluZGluZywgc291cmNlKSB7XHJcbiAgICAgICAgdmFyIG1ldGhvZFRvUmVzdG9yZSA9IGJpbmRpbmcudGhyb3R0bGVkTWV0aG9kLm9yaWdpbmFsTmFtZTtcclxuICAgICAgICBiaW5kaW5nW21ldGhvZFRvUmVzdG9yZV0gPSBiaW5kaW5nLnRocm90dGxlZE1ldGhvZDtcclxuICAgICAgICBiaW5kaW5nLnRocm90dGxlZE1ldGhvZCA9IG51bGw7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KGJpbmRpbmcudGhyb3R0bGVTdGF0ZS50aW1lb3V0SWQpO1xyXG4gICAgICAgIGJpbmRpbmcudGhyb3R0bGVTdGF0ZSA9IG51bGw7XHJcbiAgICB9O1xyXG4gICAgVGhyb3R0bGVCaW5kaW5nQmVoYXZpb3IgPSBfX2RlY29yYXRlKFtcclxuICAgICAgICBiaW5kaW5nQmVoYXZpb3IoJ3Rocm90dGxlJylcclxuICAgIF0sIFRocm90dGxlQmluZGluZ0JlaGF2aW9yKTtcclxuICAgIHJldHVybiBUaHJvdHRsZUJpbmRpbmdCZWhhdmlvcjtcclxufSgpKTtcblxudmFyIHVuc2V0ID0ge307XHJcbmZ1bmN0aW9uIGRlYm91bmNlQ2FsbFNvdXJjZShldmVudCkge1xyXG4gICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgIHZhciBzdGF0ZSA9IHRoaXMuZGVib3VuY2VTdGF0ZTtcclxuICAgIGNsZWFyVGltZW91dChzdGF0ZS50aW1lb3V0SWQpO1xyXG4gICAgc3RhdGUudGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5kZWJvdW5jZWRNZXRob2QoZXZlbnQpOyB9LCBzdGF0ZS5kZWxheSk7XHJcbn1cclxuZnVuY3Rpb24gZGVib3VuY2VDYWxsKGNvbnRleHQsIG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xyXG4gICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgIHZhciBzdGF0ZSA9IHRoaXMuZGVib3VuY2VTdGF0ZTtcclxuICAgIGNsZWFyVGltZW91dChzdGF0ZS50aW1lb3V0SWQpO1xyXG4gICAgaWYgKGNvbnRleHQgIT09IHN0YXRlLmNhbGxDb250ZXh0VG9EZWJvdW5jZSkge1xyXG4gICAgICAgIHN0YXRlLm9sZFZhbHVlID0gdW5zZXQ7XHJcbiAgICAgICAgdGhpcy5kZWJvdW5jZWRNZXRob2QoY29udGV4dCwgbmV3VmFsdWUsIG9sZFZhbHVlKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAoc3RhdGUub2xkVmFsdWUgPT09IHVuc2V0KSB7XHJcbiAgICAgICAgc3RhdGUub2xkVmFsdWUgPSBvbGRWYWx1ZTtcclxuICAgIH1cclxuICAgIHN0YXRlLnRpbWVvdXRJZCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfb2xkVmFsdWUgPSBzdGF0ZS5vbGRWYWx1ZTtcclxuICAgICAgICBzdGF0ZS5vbGRWYWx1ZSA9IHVuc2V0O1xyXG4gICAgICAgIF90aGlzLmRlYm91bmNlZE1ldGhvZChjb250ZXh0LCBuZXdWYWx1ZSwgX29sZFZhbHVlKTtcclxuICAgIH0sIHN0YXRlLmRlbGF5KTtcclxufVxyXG52YXIgRGVib3VuY2VCaW5kaW5nQmVoYXZpb3IgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gRGVib3VuY2VCaW5kaW5nQmVoYXZpb3IoKSB7XHJcbiAgICB9XHJcbiAgICBEZWJvdW5jZUJpbmRpbmdCZWhhdmlvci5wcm90b3R5cGUuYmluZCA9IGZ1bmN0aW9uIChiaW5kaW5nLCBzb3VyY2UsIGRlbGF5KSB7XHJcbiAgICAgICAgaWYgKGRlbGF5ID09PSB2b2lkIDApIHsgZGVsYXkgPSAyMDA7IH1cclxuICAgICAgICB2YXIgaXNDYWxsU291cmNlID0gYmluZGluZy5jYWxsU291cmNlICE9PSB1bmRlZmluZWQ7XHJcbiAgICAgICAgdmFyIG1ldGhvZFRvRGVib3VuY2UgPSBpc0NhbGxTb3VyY2UgPyAnY2FsbFNvdXJjZScgOiAnY2FsbCc7XHJcbiAgICAgICAgdmFyIGRlYm91bmNlciA9IGlzQ2FsbFNvdXJjZSA/IGRlYm91bmNlQ2FsbFNvdXJjZSA6IGRlYm91bmNlQ2FsbDtcclxuICAgICAgICB2YXIgbW9kZSA9IGJpbmRpbmcubW9kZTtcclxuICAgICAgICB2YXIgY2FsbENvbnRleHRUb0RlYm91bmNlID0gbW9kZSA9PT0gYmluZGluZ01vZGUudHdvV2F5IHx8IG1vZGUgPT09IGJpbmRpbmdNb2RlLmZyb21WaWV3ID8gdGFyZ2V0Q29udGV4dCA6IHNvdXJjZUNvbnRleHQ7XHJcbiAgICAgICAgYmluZGluZy5kZWJvdW5jZWRNZXRob2QgPSBiaW5kaW5nW21ldGhvZFRvRGVib3VuY2VdO1xyXG4gICAgICAgIGJpbmRpbmcuZGVib3VuY2VkTWV0aG9kLm9yaWdpbmFsTmFtZSA9IG1ldGhvZFRvRGVib3VuY2U7XHJcbiAgICAgICAgYmluZGluZ1ttZXRob2RUb0RlYm91bmNlXSA9IGRlYm91bmNlcjtcclxuICAgICAgICBiaW5kaW5nLmRlYm91bmNlU3RhdGUgPSB7XHJcbiAgICAgICAgICAgIGNhbGxDb250ZXh0VG9EZWJvdW5jZTogY2FsbENvbnRleHRUb0RlYm91bmNlLFxyXG4gICAgICAgICAgICBkZWxheTogZGVsYXksXHJcbiAgICAgICAgICAgIHRpbWVvdXRJZDogMCxcclxuICAgICAgICAgICAgb2xkVmFsdWU6IHVuc2V0XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICBEZWJvdW5jZUJpbmRpbmdCZWhhdmlvci5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gKGJpbmRpbmcsIHNvdXJjZSkge1xyXG4gICAgICAgIHZhciBtZXRob2RUb1Jlc3RvcmUgPSBiaW5kaW5nLmRlYm91bmNlZE1ldGhvZC5vcmlnaW5hbE5hbWU7XHJcbiAgICAgICAgYmluZGluZ1ttZXRob2RUb1Jlc3RvcmVdID0gYmluZGluZy5kZWJvdW5jZWRNZXRob2Q7XHJcbiAgICAgICAgYmluZGluZy5kZWJvdW5jZWRNZXRob2QgPSBudWxsO1xyXG4gICAgICAgIGNsZWFyVGltZW91dChiaW5kaW5nLmRlYm91bmNlU3RhdGUudGltZW91dElkKTtcclxuICAgICAgICBiaW5kaW5nLmRlYm91bmNlU3RhdGUgPSBudWxsO1xyXG4gICAgfTtcclxuICAgIERlYm91bmNlQmluZGluZ0JlaGF2aW9yID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgYmluZGluZ0JlaGF2aW9yKCdkZWJvdW5jZScpXHJcbiAgICBdLCBEZWJvdW5jZUJpbmRpbmdCZWhhdmlvcik7XHJcbiAgICByZXR1cm4gRGVib3VuY2VCaW5kaW5nQmVoYXZpb3I7XHJcbn0oKSk7XG5cbmZ1bmN0aW9uIGZpbmRPcmlnaW5hbEV2ZW50VGFyZ2V0KGV2ZW50KSB7XHJcbiAgICByZXR1cm4gKGV2ZW50LnBhdGggJiYgZXZlbnQucGF0aFswXSkgfHwgKGV2ZW50LmRlZXBQYXRoICYmIGV2ZW50LmRlZXBQYXRoWzBdKSB8fCBldmVudC50YXJnZXQ7XHJcbn1cclxuZnVuY3Rpb24gaGFuZGxlU2VsZkV2ZW50KGV2ZW50KSB7XHJcbiAgICB2YXIgdGFyZ2V0ID0gZmluZE9yaWdpbmFsRXZlbnRUYXJnZXQoZXZlbnQpO1xyXG4gICAgaWYgKHRoaXMudGFyZ2V0ICE9PSB0YXJnZXQpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLnNlbGZFdmVudENhbGxTb3VyY2UoZXZlbnQpO1xyXG59XHJcbnZhciBTZWxmQmluZGluZ0JlaGF2aW9yID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIFNlbGZCaW5kaW5nQmVoYXZpb3IoKSB7XHJcbiAgICB9XHJcbiAgICBTZWxmQmluZGluZ0JlaGF2aW9yLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKGJpbmRpbmcsIHNvdXJjZSkge1xyXG4gICAgICAgIGlmICghYmluZGluZy5jYWxsU291cmNlIHx8ICFiaW5kaW5nLnRhcmdldEV2ZW50KSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignU2VsZiBiaW5kaW5nIGJlaGF2aW9yIG9ubHkgc3VwcG9ydHMgZXZlbnQuJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJpbmRpbmcuc2VsZkV2ZW50Q2FsbFNvdXJjZSA9IGJpbmRpbmcuY2FsbFNvdXJjZTtcclxuICAgICAgICBiaW5kaW5nLmNhbGxTb3VyY2UgPSBoYW5kbGVTZWxmRXZlbnQ7XHJcbiAgICB9O1xyXG4gICAgU2VsZkJpbmRpbmdCZWhhdmlvci5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gKGJpbmRpbmcsIHNvdXJjZSkge1xyXG4gICAgICAgIGJpbmRpbmcuY2FsbFNvdXJjZSA9IGJpbmRpbmcuc2VsZkV2ZW50Q2FsbFNvdXJjZTtcclxuICAgICAgICBiaW5kaW5nLnNlbGZFdmVudENhbGxTb3VyY2UgPSBudWxsO1xyXG4gICAgfTtcclxuICAgIFNlbGZCaW5kaW5nQmVoYXZpb3IgPSBfX2RlY29yYXRlKFtcclxuICAgICAgICBiaW5kaW5nQmVoYXZpb3IoJ3NlbGYnKVxyXG4gICAgXSwgU2VsZkJpbmRpbmdCZWhhdmlvcik7XHJcbiAgICByZXR1cm4gU2VsZkJpbmRpbmdCZWhhdmlvcjtcclxufSgpKTtcblxudmFyIEJpbmRpbmdTaWduYWxlciA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBCaW5kaW5nU2lnbmFsZXIoKSB7XHJcbiAgICAgICAgdGhpcy5zaWduYWxzID0ge307XHJcbiAgICB9XHJcbiAgICBCaW5kaW5nU2lnbmFsZXIucHJvdG90eXBlLnNpZ25hbCA9IGZ1bmN0aW9uIChuYW1lKSB7XHJcbiAgICAgICAgdmFyIGJpbmRpbmdzID0gdGhpcy5zaWduYWxzW25hbWVdO1xyXG4gICAgICAgIGlmICghYmluZGluZ3MpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgaSA9IGJpbmRpbmdzLmxlbmd0aDtcclxuICAgICAgICB3aGlsZSAoaS0tKSB7XHJcbiAgICAgICAgICAgIGJpbmRpbmdzW2ldLmNhbGwoc291cmNlQ29udGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIHJldHVybiBCaW5kaW5nU2lnbmFsZXI7XHJcbn0oKSk7XG5cbnZhciBTaWduYWxCaW5kaW5nQmVoYXZpb3IgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gU2lnbmFsQmluZGluZ0JlaGF2aW9yKGJpbmRpbmdTaWduYWxlcikge1xyXG4gICAgICAgIHRoaXMuc2lnbmFscyA9IGJpbmRpbmdTaWduYWxlci5zaWduYWxzO1xyXG4gICAgfVxyXG4gICAgU2lnbmFsQmluZGluZ0JlaGF2aW9yLmluamVjdCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFtCaW5kaW5nU2lnbmFsZXJdOyB9O1xyXG4gICAgU2lnbmFsQmluZGluZ0JlaGF2aW9yLnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKGJpbmRpbmcsIHNvdXJjZSkge1xyXG4gICAgICAgIHZhciBuYW1lcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIG5hbWVzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWJpbmRpbmcudXBkYXRlVGFyZ2V0KSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignT25seSBwcm9wZXJ0eSBiaW5kaW5ncyBhbmQgc3RyaW5nIGludGVycG9sYXRpb24gYmluZGluZ3MgY2FuIGJlIHNpZ25hbGVkLiAgVHJpZ2dlciwgZGVsZWdhdGUgYW5kIGNhbGwgYmluZGluZ3MgY2Fubm90IGJlIHNpZ25hbGVkLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgc2lnbmFscyA9IHRoaXMuc2lnbmFscztcclxuICAgICAgICBpZiAobmFtZXMubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgICAgIHZhciBuYW1lXzEgPSBuYW1lc1swXTtcclxuICAgICAgICAgICAgdmFyIGJpbmRpbmdzID0gc2lnbmFsc1tuYW1lXzFdIHx8IChzaWduYWxzW25hbWVfMV0gPSBbXSk7XHJcbiAgICAgICAgICAgIGJpbmRpbmdzLnB1c2goYmluZGluZyk7XHJcbiAgICAgICAgICAgIGJpbmRpbmcuc2lnbmFsTmFtZSA9IG5hbWVfMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAobmFtZXMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICB2YXIgaSA9IG5hbWVzLmxlbmd0aDtcclxuICAgICAgICAgICAgd2hpbGUgKGktLSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG5hbWVfMiA9IG5hbWVzW2ldO1xyXG4gICAgICAgICAgICAgICAgdmFyIGJpbmRpbmdzID0gc2lnbmFsc1tuYW1lXzJdIHx8IChzaWduYWxzW25hbWVfMl0gPSBbXSk7XHJcbiAgICAgICAgICAgICAgICBiaW5kaW5ncy5wdXNoKGJpbmRpbmcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGJpbmRpbmcuc2lnbmFsTmFtZSA9IG5hbWVzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdTaWduYWwgbmFtZSBpcyByZXF1aXJlZC4nKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgU2lnbmFsQmluZGluZ0JlaGF2aW9yLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiAoYmluZGluZywgc291cmNlKSB7XHJcbiAgICAgICAgdmFyIHNpZ25hbHMgPSB0aGlzLnNpZ25hbHM7XHJcbiAgICAgICAgdmFyIG5hbWUgPSBiaW5kaW5nLnNpZ25hbE5hbWU7XHJcbiAgICAgICAgYmluZGluZy5zaWduYWxOYW1lID0gbnVsbDtcclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShuYW1lKSkge1xyXG4gICAgICAgICAgICB2YXIgbmFtZXMgPSBuYW1lO1xyXG4gICAgICAgICAgICB2YXIgaSA9IG5hbWVzLmxlbmd0aDtcclxuICAgICAgICAgICAgd2hpbGUgKGktLSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG4gPSBuYW1lc1tpXTtcclxuICAgICAgICAgICAgICAgIHZhciBiaW5kaW5ncyA9IHNpZ25hbHNbbl07XHJcbiAgICAgICAgICAgICAgICBiaW5kaW5ncy5zcGxpY2UoYmluZGluZ3MuaW5kZXhPZihiaW5kaW5nKSwgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBiaW5kaW5ncyA9IHNpZ25hbHNbbmFtZV07XHJcbiAgICAgICAgICAgIGJpbmRpbmdzLnNwbGljZShiaW5kaW5ncy5pbmRleE9mKGJpbmRpbmcpLCAxKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgU2lnbmFsQmluZGluZ0JlaGF2aW9yID0gX19kZWNvcmF0ZShbXHJcbiAgICAgICAgYmluZGluZ0JlaGF2aW9yKCdzaWduYWwnKVxyXG4gICAgXSwgU2lnbmFsQmluZGluZ0JlaGF2aW9yKTtcclxuICAgIHJldHVybiBTaWduYWxCaW5kaW5nQmVoYXZpb3I7XHJcbn0oKSk7XG5cbnZhciBldmVudE5hbWVzUmVxdWlyZWQgPSAnVGhlIHVwZGF0ZVRyaWdnZXIgYmluZGluZyBiZWhhdmlvciByZXF1aXJlcyBhdCBsZWFzdCBvbmUgZXZlbnQgbmFtZSBhcmd1bWVudDogZWcgPGlucHV0IHZhbHVlLmJpbmQ9XCJmaXJzdE5hbWUgJiB1cGRhdGVUcmlnZ2VyOlxcJ2JsdXJcXCdcIj4nO1xyXG52YXIgbm90QXBwbGljYWJsZU1lc3NhZ2UgPSAnVGhlIHVwZGF0ZVRyaWdnZXIgYmluZGluZyBiZWhhdmlvciBjYW4gb25seSBiZSBhcHBsaWVkIHRvIHR3by13YXkvIGZyb20tdmlldyBiaW5kaW5ncyBvbiBpbnB1dC9zZWxlY3QgZWxlbWVudHMuJztcclxudmFyIFVwZGF0ZVRyaWdnZXJCaW5kaW5nQmVoYXZpb3IgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gVXBkYXRlVHJpZ2dlckJpbmRpbmdCZWhhdmlvcigpIHtcclxuICAgIH1cclxuICAgIFVwZGF0ZVRyaWdnZXJCaW5kaW5nQmVoYXZpb3IucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAoYmluZGluZywgc291cmNlKSB7XHJcbiAgICAgICAgdmFyIGV2ZW50cyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XHJcbiAgICAgICAgICAgIGV2ZW50c1tfaSAtIDJdID0gYXJndW1lbnRzW19pXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGV2ZW50cy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGV2ZW50TmFtZXNSZXF1aXJlZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChiaW5kaW5nLm1vZGUgIT09IGJpbmRpbmdNb2RlLnR3b1dheSAmJiBiaW5kaW5nLm1vZGUgIT09IGJpbmRpbmdNb2RlLmZyb21WaWV3KSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihub3RBcHBsaWNhYmxlTWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB0YXJnZXRPYnNlcnZlciA9IGJpbmRpbmcub2JzZXJ2ZXJMb2NhdG9yLmdldE9ic2VydmVyKGJpbmRpbmcudGFyZ2V0LCBiaW5kaW5nLnRhcmdldFByb3BlcnR5KTtcclxuICAgICAgICBpZiAoIXRhcmdldE9ic2VydmVyLmhhbmRsZXIpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKG5vdEFwcGxpY2FibGVNZXNzYWdlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgYmluZGluZy50YXJnZXRPYnNlcnZlciA9IHRhcmdldE9ic2VydmVyO1xyXG4gICAgICAgIHRhcmdldE9ic2VydmVyLm9yaWdpbmFsSGFuZGxlciA9IGJpbmRpbmcudGFyZ2V0T2JzZXJ2ZXIuaGFuZGxlcjtcclxuICAgICAgICB2YXIgaGFuZGxlciA9IG5ldyBFdmVudFN1YnNjcmliZXIoZXZlbnRzKTtcclxuICAgICAgICB0YXJnZXRPYnNlcnZlci5oYW5kbGVyID0gaGFuZGxlcjtcclxuICAgIH07XHJcbiAgICBVcGRhdGVUcmlnZ2VyQmluZGluZ0JlaGF2aW9yLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiAoYmluZGluZywgc291cmNlKSB7XHJcbiAgICAgICAgdmFyIHRhcmdldE9ic2VydmVyID0gYmluZGluZy50YXJnZXRPYnNlcnZlcjtcclxuICAgICAgICB0YXJnZXRPYnNlcnZlci5oYW5kbGVyLmRpc3Bvc2UoKTtcclxuICAgICAgICB0YXJnZXRPYnNlcnZlci5oYW5kbGVyID0gdGFyZ2V0T2JzZXJ2ZXIub3JpZ2luYWxIYW5kbGVyO1xyXG4gICAgICAgIHRhcmdldE9ic2VydmVyLm9yaWdpbmFsSGFuZGxlciA9IG51bGw7XHJcbiAgICB9O1xyXG4gICAgVXBkYXRlVHJpZ2dlckJpbmRpbmdCZWhhdmlvciA9IF9fZGVjb3JhdGUoW1xyXG4gICAgICAgIGJpbmRpbmdCZWhhdmlvcigndXBkYXRlVHJpZ2dlcicpXHJcbiAgICBdLCBVcGRhdGVUcmlnZ2VyQmluZGluZ0JlaGF2aW9yKTtcclxuICAgIHJldHVybiBVcGRhdGVUcmlnZ2VyQmluZGluZ0JlaGF2aW9yO1xyXG59KCkpO1xuXG5mdW5jdGlvbiBfY3JlYXRlRHluYW1pY0VsZW1lbnQoX2EpIHtcclxuICAgIHZhciBuYW1lID0gX2EubmFtZSwgdmlld1VybCA9IF9hLnZpZXdVcmwsIGJpbmRhYmxlTmFtZXMgPSBfYS5iaW5kYWJsZU5hbWVzLCB1c2VTaGFkb3dET01tb2RlID0gX2EudXNlU2hhZG93RE9NbW9kZTtcclxuICAgIHZhciBEeW5hbWljRWxlbWVudCA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gRHluYW1pY0VsZW1lbnQoKSB7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIER5bmFtaWNFbGVtZW50LnByb3RvdHlwZS5iaW5kID0gZnVuY3Rpb24gKGJpbmRpbmdDb250ZXh0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuJHBhcmVudCA9IGJpbmRpbmdDb250ZXh0O1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgRHluYW1pY0VsZW1lbnQgPSBfX2RlY29yYXRlKFtcclxuICAgICAgICAgICAgY3VzdG9tRWxlbWVudChuYW1lKSxcclxuICAgICAgICAgICAgdXNlVmlldyh2aWV3VXJsKVxyXG4gICAgICAgIF0sIER5bmFtaWNFbGVtZW50KTtcclxuICAgICAgICByZXR1cm4gRHluYW1pY0VsZW1lbnQ7XHJcbiAgICB9KCkpO1xyXG4gICAgZm9yICh2YXIgaSA9IDAsIGlpID0gYmluZGFibGVOYW1lcy5sZW5ndGg7IGkgPCBpaTsgKytpKSB7XHJcbiAgICAgICAgYmluZGFibGUoYmluZGFibGVOYW1lc1tpXSkoRHluYW1pY0VsZW1lbnQpO1xyXG4gICAgfVxyXG4gICAgc3dpdGNoICh1c2VTaGFkb3dET01tb2RlKSB7XHJcbiAgICAgICAgY2FzZSAnb3Blbic6XHJcbiAgICAgICAgICAgIHVzZVNoYWRvd0RPTSh7IG1vZGU6ICdvcGVuJyB9KShEeW5hbWljRWxlbWVudCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgJ2Nsb3NlZCc6XHJcbiAgICAgICAgICAgIHVzZVNoYWRvd0RPTSh7IG1vZGU6ICdjbG9zZWQnIH0pKER5bmFtaWNFbGVtZW50KTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAnJzpcclxuICAgICAgICAgICAgdXNlU2hhZG93RE9NKER5bmFtaWNFbGVtZW50KTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSBudWxsOlxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICBnZXRMb2dnZXIoJ2F1cmVsaWEtaHRtbC1vbmx5LWVsZW1lbnQnKVxyXG4gICAgICAgICAgICAgICAgLndhcm4oXCJFeHBlY3RlZCAndXNlLXNoYWRvdy1kb20nIHZhbHVlIHRvIGJlIFxcXCJjbG9zZVxcXCIsIFxcXCJvcGVuXFxcIiBvciBcXFwiXFxcIiwgcmVjZWl2ZWQgXCIgKyB1c2VTaGFkb3dET01tb2RlKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gRHluYW1pY0VsZW1lbnQ7XHJcbn1cblxuZnVuY3Rpb24gZ2V0RWxlbWVudE5hbWUoYWRkcmVzcykge1xyXG4gICAgcmV0dXJuIC8oW15cXC9eXFw/XSspXFwuaHRtbC9pLmV4ZWMoYWRkcmVzcylbMV0udG9Mb3dlckNhc2UoKTtcclxufVxyXG5mdW5jdGlvbiBjb25maWd1cmUoY29uZmlnKSB7XHJcbiAgICB2YXIgdmlld0VuZ2luZSA9IGNvbmZpZy5jb250YWluZXIuZ2V0KFZpZXdFbmdpbmUpO1xyXG4gICAgdmFyIGxvYWRlciA9IGNvbmZpZy5hdXJlbGlhLmxvYWRlcjtcclxuICAgIHZpZXdFbmdpbmUuYWRkUmVzb3VyY2VQbHVnaW4oJy5odG1sJywge1xyXG4gICAgICAgICdmZXRjaCc6IGZ1bmN0aW9uICh2aWV3VXJsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBsb2FkZXIubG9hZFRlbXBsYXRlKHZpZXdVcmwpLnRoZW4oZnVuY3Rpb24gKHJlZ2lzdHJ5RW50cnkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBfYTtcclxuICAgICAgICAgICAgICAgIHZhciBiaW5kYWJsZU5hbWVzID0gcmVnaXN0cnlFbnRyeS50ZW1wbGF0ZS5nZXRBdHRyaWJ1dGUoJ2JpbmRhYmxlJyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdXNlU2hhZG93RE9NbW9kZSA9IHJlZ2lzdHJ5RW50cnkudGVtcGxhdGUuZ2V0QXR0cmlidXRlKCd1c2Utc2hhZG93LWRvbScpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBnZXRFbGVtZW50TmFtZSh2aWV3VXJsKTtcclxuICAgICAgICAgICAgICAgIGlmIChiaW5kYWJsZU5hbWVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmluZGFibGVOYW1lcyA9IGJpbmRhYmxlTmFtZXMuc3BsaXQoJywnKS5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHgudHJpbSgpOyB9KTtcclxuICAgICAgICAgICAgICAgICAgICByZWdpc3RyeUVudHJ5LnRlbXBsYXRlLnJlbW92ZUF0dHJpYnV0ZSgnYmluZGFibGUnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGJpbmRhYmxlTmFtZXMgPSBbXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBfYSA9IHt9LCBfYVtuYW1lXSA9IF9jcmVhdGVEeW5hbWljRWxlbWVudCh7IG5hbWU6IG5hbWUsIHZpZXdVcmw6IHZpZXdVcmwsIGJpbmRhYmxlTmFtZXM6IGJpbmRhYmxlTmFtZXMsIHVzZVNoYWRvd0RPTW1vZGU6IHVzZVNoYWRvd0RPTW1vZGUgfSksIF9hO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxuXG5mdW5jdGlvbiBjb25maWd1cmUkMShjb25maWcpIHtcclxuICAgIGluamVjdEF1cmVsaWFIaWRlU3R5bGVBdEhlYWQoKTtcclxuICAgIGNvbmZpZy5nbG9iYWxSZXNvdXJjZXMoQ29tcG9zZSwgSWYsIEVsc2UsIFdpdGgsIFJlcGVhdCwgU2hvdywgSGlkZSwgUmVwbGFjZWFibGUsIEZvY3VzLCBTYW5pdGl6ZUhUTUxWYWx1ZUNvbnZlcnRlciwgT25lVGltZUJpbmRpbmdCZWhhdmlvciwgT25lV2F5QmluZGluZ0JlaGF2aW9yLCBUb1ZpZXdCaW5kaW5nQmVoYXZpb3IsIEZyb21WaWV3QmluZGluZ0JlaGF2aW9yLCBUd29XYXlCaW5kaW5nQmVoYXZpb3IsIFRocm90dGxlQmluZGluZ0JlaGF2aW9yLCBEZWJvdW5jZUJpbmRpbmdCZWhhdmlvciwgU2VsZkJpbmRpbmdCZWhhdmlvciwgU2lnbmFsQmluZGluZ0JlaGF2aW9yLCBVcGRhdGVUcmlnZ2VyQmluZGluZ0JlaGF2aW9yLCBBdHRyQmluZGluZ0JlaGF2aW9yKTtcclxuICAgIGNvbmZpZ3VyZShjb25maWcpO1xyXG4gICAgdmFyIHZpZXdFbmdpbmUgPSBjb25maWcuY29udGFpbmVyLmdldChWaWV3RW5naW5lKTtcclxuICAgIHZhciBzdHlsZVJlc291cmNlUGx1Z2luID0ge1xyXG4gICAgICAgIGZldGNoOiBmdW5jdGlvbiAoYWRkcmVzcykge1xyXG4gICAgICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgICAgIHJldHVybiBfYSA9IHt9LCBfYVthZGRyZXNzXSA9IF9jcmVhdGVDU1NSZXNvdXJjZShhZGRyZXNzKSwgX2E7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFsnLmNzcycsICcubGVzcycsICcuc2FzcycsICcuc2NzcycsICcuc3R5bCddLmZvckVhY2goZnVuY3Rpb24gKGV4dCkgeyByZXR1cm4gdmlld0VuZ2luZS5hZGRSZXNvdXJjZVBsdWdpbihleHQsIHN0eWxlUmVzb3VyY2VQbHVnaW4pOyB9KTtcclxufVxuXG5leHBvcnQgeyBBYnN0cmFjdFJlcGVhdGVyLCBBcnJheVJlcGVhdFN0cmF0ZWd5LCBBdHRyQmluZGluZ0JlaGF2aW9yLCBCaW5kaW5nU2lnbmFsZXIsIENvbXBvc2UsIERlYm91bmNlQmluZGluZ0JlaGF2aW9yLCBFbHNlLCBGb2N1cywgRnJvbVZpZXdCaW5kaW5nQmVoYXZpb3IsIEhUTUxTYW5pdGl6ZXIsIEhpZGUsIElmLCBNYXBSZXBlYXRTdHJhdGVneSwgTnVsbFJlcGVhdFN0cmF0ZWd5LCBOdW1iZXJSZXBlYXRTdHJhdGVneSwgT25lVGltZUJpbmRpbmdCZWhhdmlvciwgT25lV2F5QmluZGluZ0JlaGF2aW9yLCBSZXBlYXQsIFJlcGVhdFN0cmF0ZWd5TG9jYXRvciwgUmVwbGFjZWFibGUsIFNhbml0aXplSFRNTFZhbHVlQ29udmVydGVyLCBTZWxmQmluZGluZ0JlaGF2aW9yLCBTZXRSZXBlYXRTdHJhdGVneSwgU2hvdywgU2lnbmFsQmluZGluZ0JlaGF2aW9yLCBUaHJvdHRsZUJpbmRpbmdCZWhhdmlvciwgVG9WaWV3QmluZGluZ0JlaGF2aW9yLCBUd29XYXlCaW5kaW5nQmVoYXZpb3IsIFVwZGF0ZVRyaWdnZXJCaW5kaW5nQmVoYXZpb3IsIFdpdGgsIGNvbmZpZ3VyZSQxIGFzIGNvbmZpZ3VyZSwgY3JlYXRlRnVsbE92ZXJyaWRlQ29udGV4dCwgZ2V0SXRlbXNTb3VyY2VFeHByZXNzaW9uLCBpc09uZVRpbWUsIHVud3JhcEV4cHJlc3Npb24sIHVwZGF0ZU9uZVRpbWVCaW5kaW5nLCB1cGRhdGVPdmVycmlkZUNvbnRleHQsIHZpZXdzUmVxdWlyZUxpZmVjeWNsZSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXVyZWxpYS10ZW1wbGF0aW5nLXJlc291cmNlcy5qcy5tYXBcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///aurelia-templating-resources\n");

/***/ })

}]);